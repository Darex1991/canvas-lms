{"version":3,"sources":["webpack:///./public/javascripts/translations/lib.text_helper.js","webpack:///./app/coffeescripts/str/TextHelper.coffee","webpack:///./public/javascripts/dummyI18nResource.js?61ff","webpack:///./public/javascripts/translations/EditorToggle.js","webpack:///./public/javascripts/dummyI18nResource.js?878d","webpack:///./public/javascripts/translations/SwitchEditorControl.js","webpack:///./public/javascripts/dummyI18nResource.js?41b1","webpack:///./app/jsx/editor/SwitchEditorControl.js","webpack:///./app/coffeescripts/editor/EditorToggle.js","webpack:///./public/javascripts/jquery.scrollToVisible.js","webpack:///./public/javascripts/translations/instructure_misc_plugins.js","webpack:///./public/javascripts/dummyI18nResource.js?9aa5","webpack:///./public/javascripts/jquery.instructure_misc_plugins.js","webpack:///./public/javascripts/translations/user_content.js","webpack:///./public/javascripts/dummyI18nResource.js?15ea","webpack:///./app/coffeescripts/str/apiUserContent.js"],"names":["mergeI18nTranslations","JSON","parse","scoped","AUTO_LINKIFY_REGEX","th","quoteClump","lines","htmlEscape","t","raw","join","formatMessage","message","links","placeholderBlocks","replace","match","i","push","link","processedLines","quoteBlock","RegExp","shift","line","length","delimit","number","isNaN","String","sign","abs","Math","result","integer","floor","mod","truncateText","string","options","max","ellipsis","wordSeparator","trim","truncateAt","pos","indexOf","substring","plainText","SwitchEditorControl","React","Component","state","mode","toggle","e","preventDefault","RichContentEditor","callOnRCE","this","props","textarea","setState","switchLink","focus","switchLinkText","I18n","linkClass","render","style","float","ref","c","href","className","onClick","displayName","preloadRemoteModule","_nextID","EditorToggle","elem","editingElement","doneText","switchViews","view","textArea","createTextArea","textAreaContainer","$","append","createSwitchViews","done","createDone","content","getContent","editing","Object","assign","prototype","Backbone","Events","display","edit","getRceOptions","opts","extend","tinyOptions","rceOptions","editorBoxLabel","aria_label","val","insertBefore","el","detach","ENV","use_rce_enhancements","infoIcon","KeyboardShortcuts","$el","insertAfter","initSidebar","loadNewEditor","freshNode","trigger","replaceTextArea","destroyRCE","remove","cancel","html","find","css","width","minHeight","addClass","attr","text","click","editButton","component","$container","ReactDOM","fn","scrollToVisible","obj","$obj","innerOffset","offset","outerWidth","height","outerHeight","top","bottom","left","right","currentTop","selector","windowScrollTop","scrollTop","currentLeft","scrollLeft","currentHeight","currentWidth","outerOffset","each","tagName","window","setOptions","prompt","forEach","opt","optHtml","ifExists","func","call","scrollbarWidth","$div","appendTo","$innerDiv","w1","innerWidth","w2","dim","speed","animate","opacity","undim","confirmDelete","defaults","$object","$dialog","noMessage","no_message","onContinue","confirmed","url","success","data","fadeOut","prepareData","authenticity_token","ajaxJSON","request","status","error","isFunction","unhandledXHRs","cancelled","skipConfirmations","dialog","dialog_options","confirmation_class","includes","modal","close","buttons","class","confirm","fragmentChange","query","location","search","split","query_hash","item","bind","$doc","found","_checkFragments","fragmentList","doc","fragment","setTimeout","triggerHandler","hash","list","idx","clickLink","eq","hasClass","showIf","bool","index","show","hide","disableIf","prop","indicate","$indicator","zIndex","container","document","createElement","position","border","backgroundColor","mouseover","stop","singleFlash","fadeIn","scroll","hasScrollbar","clientHeight","scrollHeight","log","msg","console","fillWindowWithMe","$this","$wrapper","$main","$not_right_side","$window","$toResize","add","alsoResize","fillWindowWithThisElement","spaceLeftForThis","newHeight","onResize","unbind","autoGrowInput","o","maxWidth","minWidth","comfortZone","filter","input","testSubject","fontSize","fontFamily","fontWeight","letterSpacing","whiteSpace","testerWidth","newWidth","apiUserContent","translateMathmlForScreenreaders","$equationImage","mathml","mathmlSpan","toMediaCommentLink","node","$link","nodeName","toLowerCase","convert","$dummy","replaceWith","forEditing","uuid","_","uniqueId","action","files_domain","$form","name","value","submit","equationImage","removeAttr","after"],"mappings":"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","file":"145-c-183352165f.js","sourcesContent":["// this file was auto-generated by rake i18n:generate_js.\n// you probably shouldn't edit it directly\nimport mergeI18nTranslations from 'mergeI18nTranslations';\n\n// we use JSON.parse here instead of just loading it as a javascript object literal\n// because according to https://v8.dev/blog/cost-of-javascript-2019#json that is faster\nmergeI18nTranslations(JSON.parse(\"{\\\"ar\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"إظهار النص المقتبس\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"cy\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"dangos testun wedi’i ddyfynnu\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"da\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"vis tekst i gåseøjne\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"da-x-k12\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"vis tekst i gåseøjne\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"de\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"zitierten Text zeigen\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"el\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"προβολή κειμένου που παρατίθεται\\\"}}},\\\"en-AU\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"show quoted text\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"en-CA\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"show quoted text\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"en-GB\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"show quoted text\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"es\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"mostrar texto citado\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"fa\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"نمایش متن نقل شده\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"fi\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"näytä lainattu teksti\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"fr\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"afficher le texte entre guillemets\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"fr-CA\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"afficher le texte entre guillemets\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"he\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"מציג ציטוט\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"ht\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"afiche tèks site\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"hu\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"idézett szöveg megjelenítése\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"hy\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"ցույց տալ մեջբերվող տեքստը\\\",\\\"word_separator\\\":\\\"-\\\"}}},\\\"is\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"Sýna ívitnaðan texta\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"it\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"mostra testo citato\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"ja\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"引用したテキストを表示\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"ko\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"인용된 텍스트 표시\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"mi\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"whakaatu kuputuhi faahiti\\\",\\\"word_separator\\\":\\\"-\\\"}}},\\\"nb\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"vis den merkede teksten\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"nb-x-k12\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"vis den merkede teksten\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"nl\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"geciteerde tekst tonen\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"nn\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"vis sitert tekst\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"pl\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"pokaż cytowany fragment tekstu\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"pt\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"exibir texto citado\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"pt-BR\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"exibir texto citado\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"ru\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"показать цитированный текст\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"sl\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"prikaži citirano besedilo\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"sv\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"visa citerad text\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"sv-x-k12\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"visa citerad text\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"tr\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"alıntılanan metni göster\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"uk\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"Показати цитований текст\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"zh-Hans\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"显示引用的文本\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"zh-Hant\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"顯示引用的文字\\\",\\\"word_separator\\\":\\\" \\\"}}}}\"));\n","#\n# Copyright (C) 2012 - present Instructure, Inc.\n#\n# This file is part of Canvas.\n#\n# Canvas is free software: you can redistribute it and/or modify it under\n# the terms of the GNU Affero General Public License as published by the Free\n# Software Foundation, version 3 of the License.\n#\n# Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n# A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n# details.\n#\n# You should have received a copy of the GNU Affero General Public License along\n# with this program. If not, see <http://www.gnu.org/licenses/>.\n#\n\nimport $ from 'jquery'\nimport I18n from 'i18n!lib.text_helper'\nimport htmlEscape from 'str/htmlEscape'\n\nAUTO_LINKIFY_PLACEHOLDER = \"LINK-PLACEHOLDER\"\nAUTO_LINKIFY_REGEX = ///\n  \\b\n  (                                            # Capture 1: entire matched URL\n    (?:\n      https?://                                # http or https protocol\n      |                                        # or\n      www\\d{0,3}[.]                            # \"www.\", \"www1.\", \"www2.\" … \"www999.\"\n      |                                        # or\n      [a-z0-9.\\-]+[.][a-z]{2,4}/               # looks like domain name followed by a slash\n    )\n\n    (?:\n      [^\\s()<>]+                               # Run of non-space, non-()<>\n      |                                        # or\n      \\([^\\s()<>]*\\)                           # balanced parens, single level\n    )+\n\n    (?:\n      \\([^\\s()<>]*\\)                           # balanced parens, single level\n      |                                        # or\n      [^\\s`!()\\[\\]{};:'\".,<>?«»“”‘’]           # End with: not a space or one of these punct chars\n    )\n  ) | (\n    LINK-PLACEHOLDER\n  )\n///gi\n\nexport default th =\n  quoteClump: (lines) ->\n    \"<div class='quoted_text_holder'>\n      <a href='#' class='show_quoted_text_link'>#{htmlEscape I18n.t(\"quoted_text_toggle\", \"show quoted text\")}</a>\n      <div class='quoted_text' style='display: none;'>\n        #{$.raw lines.join \"\\n\"}\n      </div>\n    </div>\"\n\n  formatMessage: (message) ->\n    # replace any links with placeholders so we don't escape them\n    links = []\n    placeholderBlocks = []\n    message = message.replace AUTO_LINKIFY_REGEX, (match, i) ->\n      placeholderBlocks.push(if match == AUTO_LINKIFY_PLACEHOLDER\n          AUTO_LINKIFY_PLACEHOLDER\n        else\n          link = match\n          link = \"http://\" + link unless link[0..6] == 'http://' or link[0..7] == 'https://'\n          links.push link\n          \"<a href='#{htmlEscape(link)}'>#{htmlEscape(match)}</a>\"\n      )\n      AUTO_LINKIFY_PLACEHOLDER\n\n    # now escape html\n    message = htmlEscape message\n\n    # now put the links back in\n    message = message.replace new RegExp(AUTO_LINKIFY_PLACEHOLDER, 'g'), (match, i) ->\n      placeholderBlocks.shift()\n\n    # replace newlines\n    message = message.replace /\\n/g, '<br />\\n'\n\n    # generate quoting clumps\n    processedLines = []\n    quoteBlock = []\n    for line in message.split(\"\\n\")\n      if line.match /^(&gt;|>)/\n        quoteBlock.push line\n      else\n        processedLines.push th.quoteClump(quoteBlock) if quoteBlock.length\n        quoteBlock = []\n        processedLines.push line\n    processedLines.push th.quoteClump(quoteBlock) if quoteBlock.length\n    message = processedLines.join \"\\n\"\n\n  delimit: (number) ->\n    # only process real numbers\n    return String(number) if isNaN number\n\n    # capture sign and then start working with the absolute value. don't\n    # process infinities.\n    sign = if number < 0 then '-' else ''\n    abs = Math.abs number\n    return String(number) if abs is Infinity\n\n    # break out the integer portion and initialize the result to just the\n    # decimal (if any)\n    integer = Math.floor abs\n    result = if abs == integer then '' else String(abs).replace(/^\\d+\\./, '.')\n\n    # for each comma'd chunk, prepend to the result and remove from integer\n    while integer >= 1000\n      mod = String(integer).replace(/\\d+(\\d\\d\\d)$/, ',$1')\n      integer = Math.floor integer / 1000\n      result = mod + result\n\n    # integer is now either in [1, 999], or equal to 0 iff number in (-1, 1).\n    # prepend it with the sign\n    sign + String(integer) + result\n\n  truncateText: (string, options = {}) ->\n    max = options.max ? 30\n    ellipsis = I18n.t('ellipsis', '...')\n    wordSeparator = I18n.t('word_separator', ' ')\n\n    string = (string ? \"\").replace(/\\s+/g, wordSeparator).trim()\n    return string if not string or string.length <= max\n\n    truncateAt = 0\n    while true\n      pos = string.indexOf(wordSeparator, truncateAt + 1)\n      break if pos < 0 || pos > max - ellipsis.length\n      truncateAt = pos\n    truncateAt or= max - ellipsis.length # first word > max, so we cut it\n\n    string.substring(0, truncateAt) + ellipsis\n\n  plainText: (message) ->\n    # remove all html tags from the message returning only the text\n    message.replace(/(<([^>]+)>)/ig, '');\n","\n    import I18n from 'i18nObj';\n    \n      import 'translations/lib.text_helper';\n      import 'translations/_core';\n    \n    import 'translations/_core_en';\n\n    export default I18n.scoped('lib.text_helper');\n  ","// this file was auto-generated by rake i18n:generate_js.\n// you probably shouldn't edit it directly\nimport mergeI18nTranslations from 'mergeI18nTranslations';\n\n// we use JSON.parse here instead of just loading it as a javascript object literal\n// because according to https://v8.dev/blog/cost-of-javascript-2019#json that is faster\nmergeI18nTranslations(JSON.parse(\"{\\\"ar\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"انقر لإنهاء تعديل منطقة النص المنسقة\\\"},\\\"done_as_in_finished\\\":\\\"تم\\\"}},\\\"cy\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Cliciwch i orffen golygu’r ardal testun cyfoethog\\\"},\\\"done_as_in_finished\\\":\\\"Wedi gorffen\\\"}},\\\"da\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Klik for at afslutte redigering af RTF-område\\\"},\\\"done_as_in_finished\\\":\\\"Udført\\\"}},\\\"da-x-k12\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Klik for at afslutte redigering af RTF-område\\\"},\\\"done_as_in_finished\\\":\\\"Udført\\\"}},\\\"de\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Klicken, um die Bearbeitung des Rich-Text-Bereichs abzuschließen\\\"},\\\"done_as_in_finished\\\":\\\"Fertig\\\"}},\\\"el\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Κάντε κλικ για να ολοκληρώσετε την επεξεργασία της περιοχής rich text.\\\"},\\\"done_as_in_finished\\\":\\\"Ολοκληρώθηκε\\\"}},\\\"en-AU\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Click to finish editing the rich text area\\\"},\\\"done_as_in_finished\\\":\\\"Done\\\"}},\\\"en-CA\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Click to finish editing the rich text area\\\"},\\\"done_as_in_finished\\\":\\\"Done\\\"}},\\\"en-GB\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Click to finish editing the rich text area\\\"},\\\"done_as_in_finished\\\":\\\"Done\\\"}},\\\"es\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Haga clic para terminar de editar el área de texto con formato\\\"},\\\"done_as_in_finished\\\":\\\"Listo\\\"}},\\\"fa\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"برای پایان دادن به ویرایش قسمت دارای متن غنی کلیک کنید\\\"},\\\"done_as_in_finished\\\":\\\"انجام شد\\\"}},\\\"fi\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Suorita muokkaus loppuun tekstialueella\\\"},\\\"done_as_in_finished\\\":\\\"Valmis\\\"}},\\\"fr\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Cliquez pour finir de modifier la zone de texte enrichi.\\\"},\\\"done_as_in_finished\\\":\\\"Terminé\\\"}},\\\"fr-CA\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Cliquez pour finir de modifier la zone de texte enrichi.\\\"},\\\"done_as_in_finished\\\":\\\"Terminé\\\"}},\\\"he\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"הקלקה לסיום עריכת איזור התוכן העשיר\\\"},\\\"done_as_in_finished\\\":\\\"בוצע\\\"}},\\\"ht\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Klike pou fini modifikasyon zòn tèks rich la\\\"},\\\"done_as_in_finished\\\":\\\"Fini\\\"}},\\\"hu\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Kattintson, hogy befejezze a gazdag szövegmező szerkesztését\\\"},\\\"done_as_in_finished\\\":\\\"Kész\\\"}},\\\"hy\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Սեղմեք \\\\\\\"հարստացված տեսքտի\\\\\\\" խմբագրումը ավարտելու համար \\\"},\\\"done_as_in_finished\\\":\\\"Պատրաստ է\\\"}},\\\"is\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Smella til að ljúka breytingum á mótuðum texta\\\"},\\\"done_as_in_finished\\\":\\\"Lokið\\\"}},\\\"it\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Fai clic per terminare la modifica dell'area di testo RTF\\\"},\\\"done_as_in_finished\\\":\\\"Fatto\\\"}},\\\"ja\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"クリックしてリッチ テキスト領域の編集を終了する\\\"},\\\"done_as_in_finished\\\":\\\"完了\\\"}},\\\"ko\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"클릭하면 서식 있는 텍스트 영역의 편집을 마침\\\"},\\\"done_as_in_finished\\\":\\\"마침\\\"}},\\\"mi\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Pāwhiritia ki te whakaoti i te whakatika i te wāhi kuputuhi taonga\\\"},\\\"done_as_in_finished\\\":\\\"Kua mahia\\\"}},\\\"nb\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Klikk for å fullføre redigeringen av riktekstområdet\\\"},\\\"done_as_in_finished\\\":\\\"Ferdig\\\"}},\\\"nb-x-k12\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Klikk for å fullføre redigeringen av riktekstområdet\\\"},\\\"done_as_in_finished\\\":\\\"Ferdig\\\"}},\\\"nl\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Klikken om het bewerken van Rich Text-gebied te voltooien\\\"},\\\"done_as_in_finished\\\":\\\"Gereed\\\"}},\\\"nn\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Klikk her for å fullføre redigeringa av området for rikt tekstformat\\\"},\\\"done_as_in_finished\\\":\\\"Fullført\\\"}},\\\"pl\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Kliknij, aby ukończyć edycję wzbogaconego obszaru tekstowego\\\"},\\\"done_as_in_finished\\\":\\\"Gotowe\\\"}},\\\"pt\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Clique para concluir a edição da área de Rich Text\\\"},\\\"done_as_in_finished\\\":\\\"Feito\\\"}},\\\"pt-BR\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Clique para finalizar a edição da área de conteúdo enriquecido\\\"},\\\"done_as_in_finished\\\":\\\"Feito\\\"}},\\\"ru\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Щелкните, чтобы закончить редактирование форматированного текста\\\"},\\\"done_as_in_finished\\\":\\\"Готово\\\"}},\\\"sv\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Klicka för att slutföra redigering av RTF-området\\\"},\\\"done_as_in_finished\\\":\\\"Klar\\\"}},\\\"sv-x-k12\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Klicka för att slutföra redigering av RTF-området\\\"},\\\"done_as_in_finished\\\":\\\"Klar\\\"}},\\\"tr\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"Zengin metin alanında düzenlemeyi bitirmek için tıklayınız\\\"},\\\"done_as_in_finished\\\":\\\"Tamam\\\"}},\\\"zh-Hans\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"单击以完成编辑富文本区域\\\"},\\\"done_as_in_finished\\\":\\\"完成\\\"}},\\\"zh-Hant\\\":{\\\"EditorToggle\\\":{\\\"done\\\":{\\\"title\\\":\\\"按一下以完成編輯 RTF 區域\\\"},\\\"done_as_in_finished\\\":\\\"已完成\\\"}}}\"));\n","\n    import I18n from 'i18nObj';\n    \n      import 'translations/EditorToggle';\n      import 'translations/_core';\n    \n    import 'translations/_core_en';\n\n    export default I18n.scoped('EditorToggle');\n  ","// this file was auto-generated by rake i18n:generate_js.\n// you probably shouldn't edit it directly\nimport mergeI18nTranslations from 'mergeI18nTranslations';\n\n// we use JSON.parse here instead of just loading it as a javascript object literal\n// because according to https://v8.dev/blog/cost-of-javascript-2019#json that is faster\nmergeI18nTranslations(JSON.parse(\"{\\\"ar\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"محرر HTML\\\",\\\"switch_editor_rich_text\\\":\\\"محرر محتوى\\\"}},\\\"cy\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"Golygydd HTML\\\",\\\"switch_editor_rich_text\\\":\\\"Golygydd Cynnwys Cyfoethog\\\"}},\\\"da\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML-editor\\\",\\\"switch_editor_rich_text\\\":\\\"Rich Content Editor\\\"}},\\\"da-x-k12\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML-editor\\\",\\\"switch_editor_rich_text\\\":\\\"Rich Content Editor\\\"}},\\\"de\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML-Editor\\\",\\\"switch_editor_rich_text\\\":\\\"Rich-Content-Editor\\\"}},\\\"el\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"Επεξεργαστής HTML\\\",\\\"switch_editor_rich_text\\\":\\\"Επεξεργαστής Πλούσιου Περιεχομένου-rich content\\\"}},\\\"en-AU\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML Editor\\\",\\\"switch_editor_rich_text\\\":\\\"Rich Content Editor\\\"}},\\\"en-CA\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML Editor\\\",\\\"switch_editor_rich_text\\\":\\\"Rich Content Editor\\\"}},\\\"en-GB\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML Editor\\\",\\\"switch_editor_rich_text\\\":\\\"Rich Content Editor\\\"}},\\\"es\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"Editor HTML\\\",\\\"switch_editor_rich_text\\\":\\\"Editor de contenido enriquecido\\\"}},\\\"fa\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"ویرایشگر HTML\\\",\\\"switch_editor_rich_text\\\":\\\"ویرایشگر محتوای غنی\\\"}},\\\"fi\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML-muokkausohjelma\\\",\\\"switch_editor_rich_text\\\":\\\"Rikas sisältöeditori\\\"}},\\\"fr\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"Éditeur HTML\\\",\\\"switch_editor_rich_text\\\":\\\"Éditeur de texte enrichi\\\"}},\\\"fr-CA\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"Éditeur HTML\\\",\\\"switch_editor_rich_text\\\":\\\"Éditeur de texte enrichi\\\"}},\\\"he\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"עורך HTML\\\",\\\"switch_editor_rich_text\\\":\\\"עורך תוכן עשיר\\\"}},\\\"ht\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"Editè HTML\\\",\\\"switch_editor_rich_text\\\":\\\"Editè Kontni Rich\\\"}},\\\"hu\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML szerkesztő\\\",\\\"switch_editor_rich_text\\\":\\\"Vizuális szövegszerkesztő\\\"}},\\\"hy\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML խմբագիր\\\",\\\"switch_editor_rich_text\\\":\\\"Ֆորմատավորված տեքստի խմբագիր\\\"}},\\\"is\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML ritill\\\",\\\"switch_editor_rich_text\\\":\\\"Rich Content ritill\\\"}},\\\"it\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"Editor HTML\\\",\\\"switch_editor_rich_text\\\":\\\"Editor di contenuti avanzati\\\"}},\\\"ja\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML エディタ\\\",\\\"switch_editor_rich_text\\\":\\\"リッチ コンテンツ エディタ\\\"}},\\\"mi\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"Editor HTML\\\",\\\"switch_editor_rich_text\\\":\\\"Ētita Ihirangi Whai Rawa\\\"}},\\\"nb\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML-redigering\\\",\\\"switch_editor_rich_text\\\":\\\"Rich innholdsredigering\\\"}},\\\"nb-x-k12\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML-redigering\\\",\\\"switch_editor_rich_text\\\":\\\"Rich innholdsredigering\\\"}},\\\"nl\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML Editor\\\",\\\"switch_editor_rich_text\\\":\\\"Rich Content Editor\\\"}},\\\"nn\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML-redigeringsprogram\\\",\\\"switch_editor_rich_text\\\":\\\"Redigeringsprogram for rikt innhald\\\"}},\\\"pl\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"Edytor HTML\\\",\\\"switch_editor_rich_text\\\":\\\"Edytor wzbogaconej zawartości\\\"}},\\\"pt\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"Editor HTML\\\",\\\"switch_editor_rich_text\\\":\\\"Editor de conteúdo avançado\\\"}},\\\"pt-BR\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"Editor de HTML\\\",\\\"switch_editor_rich_text\\\":\\\"Editor de conteúdo avançado\\\"}},\\\"ru\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"Редактор HTML\\\",\\\"switch_editor_rich_text\\\":\\\"Редактор форматированного текста\\\"}},\\\"sv\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML-redigerare\\\",\\\"switch_editor_rich_text\\\":\\\"Redigerare för formaterat innehåll\\\"}},\\\"sv-x-k12\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML-redigerare\\\",\\\"switch_editor_rich_text\\\":\\\"Redigerare för formaterat innehåll\\\"}},\\\"tr\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML Düzenleyici\\\",\\\"switch_editor_rich_text\\\":\\\"Zengin İçerik Editörü\\\"}},\\\"zh-Hans\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML 编辑器\\\",\\\"switch_editor_rich_text\\\":\\\"富内容编辑器\\\"}},\\\"zh-Hant\\\":{\\\"SwitchEditorControl\\\":{\\\"switch_editor_html\\\":\\\"HTML 編輯器\\\",\\\"switch_editor_rich_text\\\":\\\"多種格式的內容編輯器\\\"}}}\"));\n","\n    import I18n from 'i18nObj';\n    \n      import 'translations/SwitchEditorControl';\n      import 'translations/_core';\n    \n    import 'translations/_core_en';\n\n    export default I18n.scoped('SwitchEditorControl');\n  ","/*\n * Copyright (C) 2016 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport I18n from 'i18n!SwitchEditorControl'\nimport RichContentEditor from '../shared/rce/RichContentEditor'\n\nclass SwitchEditorControl extends React.Component {\n  static displayName = 'SwitchEditor'\n\n  static propTypes = {\n    textarea: PropTypes.object.isRequired\n  }\n\n  state = {mode: 'rce'}\n\n  toggle = e => {\n    e.preventDefault()\n    RichContentEditor.callOnRCE(this.props.textarea, 'toggle')\n    if (this.state.mode === 'rce') {\n      this.setState({mode: 'html'}, () => {\n        this.switchLink.focus()\n      })\n    } else {\n      this.setState({mode: 'rce'}, () => {\n        this.switchLink.focus()\n      })\n    }\n  }\n\n  //\n  // Rendering\n  //\n\n  switchLinkText = () => {\n    if (this.state.mode === 'rce') {\n      return I18n.t('switch_editor_html', 'HTML Editor')\n    } else {\n      return I18n.t('switch_editor_rich_text', 'Rich Content Editor')\n    }\n  }\n\n  linkClass = () => {\n    if (this.state.mode === 'rce') {\n      return 'switch-views__link switch-views__link__html'\n    } else {\n      return 'switch-views__link switch-views__link__rce'\n    }\n  }\n\n  render() {\n    return (\n      <div style={{float: 'right'}}>\n        <a\n          ref={c => (this.switchLink = c)}\n          href=\"#\"\n          className={this.linkClass()}\n          onClick={this.toggle}\n        >\n          {this.switchLinkText()}\n        </a>\n      </div>\n    )\n  }\n}\n\nexport default SwitchEditorControl\n","//\n// Copyright (C) 2012 - present Instructure, Inc.\n//\n// This file is part of Canvas.\n//\n// Canvas is free software: you can redistribute it and/or modify it under\n// the terms of the GNU Affero General Public License as published by the Free\n// Software Foundation, version 3 of the License.\n//\n// Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n// WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n// A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n// details.\n//\n// You should have received a copy of the GNU Affero General Public License along\n// with this program. If not, see <http://www.gnu.org/licenses/>.\n\nimport _ from 'underscore'\nimport I18n from 'i18n!EditorToggle'\nimport $ from 'jquery'\nimport Backbone from 'Backbone'\nimport preventDefault from '../fn/preventDefault'\nimport KeyboardShortcuts from '../views/editor/KeyboardShortcuts'\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport SwitchEditorControl from 'jsx/editor/SwitchEditorControl'\nimport RichContentEditor from 'jsx/shared/rce/RichContentEditor'\n\nRichContentEditor.preloadRemoteModule()\n\n/*\nxsslint safeString.property content\nxsslint safeString.property textArea\n*/\n\n// Simply returns a unique number with each call\nlet _nextID = 0\nconst nextID = () => `editor-toggle-${(_nextID += 1)}`\n\n// #\n// Toggles an element between a rich text editor and itself\n\n// @param {jQueryEl} @el - the element containing html to edit\n// @param {Object} options\nexport default function EditorToggle(elem, options) {\n  this.editingElement(elem)\n  this.options = {\n    // text to display in the \"done\" button\n    doneText: I18n.t('done_as_in_finished', 'Done'),\n    // whether or not a \"Switch Views\" link should be provided to edit the\n    // raw html\n    switchViews: true,\n    ...options\n  }\n  if (this.options.view) this.view = this.options.view\n  this.textArea = this.createTextArea()\n  this.textAreaContainer = $('<div/>').append(this.textArea)\n\n  if (this.options.switchViews) {\n    this.switchViews = this.createSwitchViews()\n  }\n  this.done = this.createDone()\n  this.content = this.getContent()\n  this.editing = false\n}\n\nObject.assign(EditorToggle.prototype, Backbone.Events, {\n  // #\n  // Toggles between editing the content and displaying it\n  // @api public\n  toggle() {\n    if (!this.editing) {\n      return this.edit()\n    } else {\n      return this.display()\n    }\n  },\n\n  // #\n  // Compiles the options for the RichContentEditor\n  // @api private\n  getRceOptions() {\n    const opts = $.extend(\n      {\n        focus: true,\n        tinyOptions: this.options.tinyOptions || {}\n      },\n      this.options.rceOptions\n    )\n    if (this.options.editorBoxLabel) {\n      opts.tinyOptions.aria_label = this.options.editorBoxLabel\n    }\n    return opts\n  },\n\n  // #\n  // Converts the element to an editor\n  // @api public\n  edit() {\n    this.textArea.val(this.getContent())\n    this.textAreaContainer.insertBefore(this.el)\n    this.el.detach()\n    if (!ENV.use_rce_enhancements) {\n      if (this.options.switchViews) {\n        this.switchViews = this.createSwitchViews()\n        this.switchViews.insertBefore(this.textAreaContainer)\n      }\n      if (!this.infoIcon) {\n        this.infoIcon = new KeyboardShortcuts().render().$el\n      }\n      this.infoIcon.insertBefore($('.switch-views__link'))\n      $('<div/>', {style: 'clear: both'}).insertBefore(this.textAreaContainer)\n    }\n    this.done.insertAfter(this.textAreaContainer)\n    RichContentEditor.initSidebar()\n    RichContentEditor.loadNewEditor(this.textArea, this.getRceOptions())\n    this.textArea = RichContentEditor.freshNode(this.textArea)\n    this.editing = true\n    return this.trigger('edit')\n  },\n\n  replaceTextArea() {\n    this.el.insertBefore(this.textAreaContainer)\n    RichContentEditor.destroyRCE(this.textArea)\n    if (this.textArea) {\n      this.textArea.remove()\n    }\n    this.textArea = this.createTextArea()\n    this.textAreaContainer.append(this.textArea)\n    return this.textAreaContainer.detach()\n  },\n\n  // #\n  // Converts the editor to an element\n  // @api public\n  display(opts) {\n    if (!(opts != null ? opts.cancel : undefined)) {\n      this.content = RichContentEditor.callOnRCE(this.textArea, 'get_code')\n      this.textArea.val(this.content)\n      this.el.html(this.content)\n    }\n    this.replaceTextArea()\n    if (this.options.switchViews) {\n      this.switchViews.detach()\n    }\n    if (!ENV.use_rce_enhancements) this.infoIcon.detach()\n    this.done.detach()\n    this.editing = false\n    return this.trigger('display')\n  },\n\n  // #\n  // Assign/re-assign the jQuery element to to edit.\n  //\n  // @param {jQueryEl} @el - the element containing html to edit\n  // @api public\n  editingElement(elem) {\n    return (this.el = elem)\n  },\n\n  // #\n  // method to get the content for the editor\n  // @api private\n  getContent() {\n    // remove MathML additions\n    const content = $('<div></div>').append(this.el.html())\n    content.find('.hidden-readable').remove()\n    return $.trim(content.html())\n  },\n\n  // #\n  // creates the textarea tinymce uses for the editor\n  // @api private\n  createTextArea() {\n    return (\n      $('<textarea/>')\n        // tiny mimics the width of the textarea. its min height is 110px, so\n        // we want the textarea at least that big as well\n        .css({\n          width: '100%',\n          minHeight: '110px'\n        })\n        .addClass('editor-toggle')\n        .attr('id', nextID())\n    )\n  },\n\n  // #\n  // creates the \"done\" button used to exit the editor\n  // @api private\n  createDone() {\n    return $('<div/>')\n      .addClass('edit_html_done_wrapper')\n      .append(\n        $('<a/>')\n          .text(this.options.doneText)\n          .attr('href', '#')\n          .addClass('btn edit_html_done')\n          .attr('title', I18n.t('done.title', 'Click to finish editing the rich text area'))\n          .click(\n            preventDefault(() => {\n              this.display()\n              this.editButton && this.editButton.focus()\n            })\n          )\n      )\n  },\n\n  // #\n  // create the switch views links to go between rich text and a textarea\n  // @api private\n  createSwitchViews() {\n    const component = <SwitchEditorControl textarea={this.textArea} />\n    const $container = $(\"<div class='switch-views'></div>\")\n    ReactDOM.render(component, $container[0])\n    return $container\n  }\n})\n","/*\n * Copyright (C) 2011 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n// Scrolls the supplied object until its visible. Call from\n// (\"html,body\") to scroll the window.\n\nimport $ from 'jquery'\nimport './vendor/jquery.scrollTo'\n\n$.fn.scrollToVisible = function(obj) {\n  const options = {}\n  const $obj = $(obj)\n\n  if ($obj.length === 0) {\n    return\n  }\n  let innerOffset = $obj.offset(),\n    width = $obj.outerWidth(),\n    height = $obj.outerHeight(),\n    top = innerOffset.top,\n    bottom = top + height,\n    left = innerOffset.left,\n    right = left + width,\n    currentTop = this.selector == 'html,body' ? $.windowScrollTop() : this.scrollTop(),\n    currentLeft = this.scrollLeft(),\n    currentHeight = this.outerHeight(),\n    currentWidth = this.outerWidth()\n\n  if (this.selector != 'html,body') {\n    let outerOffset = $('body').offset()\n    this.each(function() {\n      try {\n        outerOffset = $(this).offset()\n        return false\n      } catch (e) {}\n    })\n    top -= outerOffset.top\n    bottom -= outerOffset.top\n    left -= outerOffset.left\n    right -= outerOffset.left\n  }\n\n  if (this[0].tagName == 'HTML' || this[0].tagName == 'BODY') {\n    currentHeight = $(window).height()\n    if ($('#wizard_box:visible').length > 0) {\n      currentHeight -= $('#wizard_box:visible').height()\n    }\n    currentWidth = $(window).width()\n    top -= currentTop\n    left -= currentLeft\n    bottom -= currentTop\n    right -= currentLeft\n  }\n  if (top < 0 || (currentHeight < height && bottom > currentHeight)) {\n    options.scrollTop = top + currentTop\n  } else if (bottom > currentHeight) {\n    options.scrollTop = bottom + currentTop - currentHeight + 20\n  }\n  if (left < 0) {\n    options.scrollLeft = left + currentLeft\n  } else if (right > currentWidth) {\n    options.scrollLeft = right + currentLeft - currentWidth + 20\n  }\n  if (options.scrollTop == 1) {\n    options.scrollTop = 0\n  }\n  if (options.scrollLeft == 1) {\n    options.scrollLeft = 0\n  }\n\n  this.scrollTop(options.scrollTop)\n  this.scrollLeft(options.scrollLeft)\n\n  return this\n}\n","// this file was auto-generated by rake i18n:generate_js.\n// you probably shouldn't edit it directly\nimport mergeI18nTranslations from 'mergeI18nTranslations';\n\n// we use JSON.parse here instead of just loading it as a javascript object literal\n// because according to https://v8.dev/blog/cost-of-javascript-2019#json that is faster\nmergeI18nTranslations(JSON.parse(\"{\\\"ar\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"إلغاء\\\",\\\"delete\\\":\\\"حذف\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"هل ترغب بالتأكيد في حذف هذا؟\\\"}}},\\\"cy\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Canslo\\\",\\\"delete\\\":\\\"Dileu\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Ydych chi’n siŵr eich bod am ddileu hyn?\\\"}}},\\\"da\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Annuller\\\",\\\"delete\\\":\\\"Slet\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Er du sikker på, at du vil slette dette?\\\"}}},\\\"da-x-k12\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Annuller\\\",\\\"delete\\\":\\\"Slet\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Er du sikker på, at du vil slette dette?\\\"}}},\\\"de\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Abbrechen\\\",\\\"delete\\\":\\\"Löschen\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Möchten Sie dies wirklich löschen?\\\"}}},\\\"el\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Ακύρωση\\\",\\\"delete\\\":\\\"Διαγραφή\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Είστε σίγουρος/η ότι επιθυμείτε να το διαγράψετε;\\\"}}},\\\"en-AU\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Cancel\\\",\\\"delete\\\":\\\"Delete\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Are you sure you want to delete this?\\\"}}},\\\"en-CA\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Cancel\\\",\\\"delete\\\":\\\"Delete\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Are you sure you want to delete this?\\\"}}},\\\"en-GB\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Cancel\\\",\\\"delete\\\":\\\"Delete\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Are you sure you want to delete this?\\\"}}},\\\"es\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Cancelar\\\",\\\"delete\\\":\\\"Eliminar\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"¿Seguro que desea eliminarlo?\\\"}}},\\\"fa\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"لغو\\\",\\\"delete\\\":\\\"حذف\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"مطمئنید که می خواهید این مورد حذف شود؟\\\"}}},\\\"fi\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Peruuta\\\",\\\"delete\\\":\\\"Poista\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Haluatko varmasti poistaa tämän?\\\"}}},\\\"fr\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Annuler\\\",\\\"delete\\\":\\\"Supprimer\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Voulez-vous vraiment supprimer cet élément ?\\\"}}},\\\"fr-CA\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Annuler\\\",\\\"delete\\\":\\\"Supprimer\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Voulez-vous vraiment supprimer cet élément?\\\"}}},\\\"he\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"ביטול\\\",\\\"delete\\\":\\\"ביטול\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"בטוח/ה שרוצה לבטל זאת?\\\"}}},\\\"ht\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Anile\\\",\\\"delete\\\":\\\"Efase\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Ou kwè vrèman ou vle efase sa a?\\\"}}},\\\"hu\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Mégse\\\",\\\"delete\\\":\\\"Törlés\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Biztos benne, hogy törli ezt?\\\"}}},\\\"hy\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Չեղյալ համարել\\\",\\\"delete\\\":\\\"Ջնջել\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Դուք իսկապե՞ս ցանկանում եք ջնջել սա:\\\"}}},\\\"is\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Hætta við\\\",\\\"delete\\\":\\\"Eyða\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Viltu örugglega eyða þessu?\\\"}}},\\\"it\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Annulla\\\",\\\"delete\\\":\\\"Elimina\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Vuoi eliminare questo?\\\"}}},\\\"ja\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"キャンセル\\\",\\\"delete\\\":\\\"削除\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"これを削除してもよろしいですか?\\\"}}},\\\"ko\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"취소\\\",\\\"delete\\\":\\\"삭제\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"삭제하시겠습니까?\\\"}}},\\\"mi\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Whakakore\\\",\\\"delete\\\":\\\"Muku\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"E tino hiahia ana koe ki te muku i tēnei?\\\"}}},\\\"nb\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Avbryt\\\",\\\"delete\\\":\\\"Slett\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Er du sikker på at du ønsker å slette dette?\\\"}}},\\\"nb-x-k12\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Avbryt\\\",\\\"delete\\\":\\\"Slett\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Er du sikker på at du ønsker å slette dette?\\\"}}},\\\"nl\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Annuleren\\\",\\\"delete\\\":\\\"Verwijderen\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Weet je zeker dat je dit wilt verwijderen?\\\"}}},\\\"nn\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Avbryt\\\",\\\"delete\\\":\\\"Slett\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Er du sikker på at du vil slette dette?\\\"}}},\\\"pl\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Anuluj\\\",\\\"delete\\\":\\\"Usuń\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Czy na pewno chcesz usunąć ten element?\\\"}}},\\\"pt\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Cancelar\\\",\\\"delete\\\":\\\"Excluir\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Tem certeza de que deseja excluir isto?\\\"}}},\\\"pt-BR\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Cancelar\\\",\\\"delete\\\":\\\"Excluir\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Tem certeza que deseja excluir isto?\\\"}}},\\\"ru\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Отменить\\\",\\\"delete\\\":\\\"Удалить\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Действительно хотите удалить?\\\"}}},\\\"sl\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Prekliči\\\",\\\"delete\\\":\\\"Odstrani\\\"}},\\\"sv\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Avbryt\\\",\\\"delete\\\":\\\"Ta bort\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Vill du verkligen radera det här?\\\"}}},\\\"sv-x-k12\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Avbryt\\\",\\\"delete\\\":\\\"Ta bort\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Vill du verkligen radera det här?\\\"}}},\\\"tr\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"İptal\\\",\\\"delete\\\":\\\"Sil\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"Bunu silmek istediğinize emin misiniz?\\\"}}},\\\"uk\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"Скасувати\\\",\\\"delete\\\":\\\"Видалити\\\"}},\\\"zh-Hans\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"取消\\\",\\\"delete\\\":\\\"删除\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"是否确定要删除它?\\\"}}},\\\"zh-Hant\\\":{\\\"buttons\\\":{\\\"cancel\\\":\\\"取消\\\",\\\"delete\\\":\\\"刪除\\\"},\\\"instructure_misc_plugins\\\":{\\\"confirms\\\":{\\\"default_delete_thing\\\":\\\"您是否確定要刪除？\\\"}}}}\"));\n","\n    import I18n from 'i18nObj';\n    \n      import 'translations/instructure_misc_plugins';\n      import 'translations/_core';\n    \n    import 'translations/_core_en';\n\n    export default I18n.scoped('instructure_misc_plugins');\n  ","/*\n * Copyright (C) 2011 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nimport I18n from 'i18n!instructure_misc_plugins'\nimport $ from 'jquery'\nimport htmlEscape from './str/htmlEscape'\nimport authenticity_token from 'compiled/behaviors/authenticity_token'\nimport './jquery.ajaxJSON'\nimport 'jqueryui/dialog'\nimport './jquery.scrollToVisible'\nimport './vendor/jquery.scrollTo'\n\n$.fn.setOptions = function(prompt, options) {\n  let result = prompt ? \"<option value=''>\" + htmlEscape(prompt) + '</option>' : ''\n\n  if (options == null) {\n    options = []\n  }\n\n  options.forEach(opt => {\n    const optHtml = htmlEscape(opt)\n    result += '<option value=\"' + optHtml + '\">' + optHtml + '</option>'\n  })\n\n  return this.html($.raw(result))\n}\n\n// this function is to prevent you from doing all kinds of expesive operations on a\n// jquery object that doesn't actually have any elements in it\n// it is similar and inspired by http://www.slideshare.net/paul.irish/perfcompression (slide #42)\n// to use it do something like:\n// $(\"a .bunch #of .nodes\").ifExists(function(orignalQuery){\n//   //  'this' points to the original jquery object (in this case, $(\"a .bunch #of .nodes\") );\n//   // orignalQuery is the same as 'this';\n//   this.slideUp().dialog().show();\n// });\n$.fn.ifExists = function(func) {\n  this.length && func.call(this, this)\n  return this\n}\n\n// Returns the width of the browser's scroll bars.\n$.fn.scrollbarWidth = function() {\n  const $div = $(\n      '<div style=\"width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;\"><div style=\"height:100px;\"></div>'\n    ).appendTo(this),\n    $innerDiv = $div.find('div')\n  // Append our div, do our calculation and then remove it\n  const w1 = $innerDiv.innerWidth()\n  $div.css('overflow-y', 'scroll')\n  const w2 = $innerDiv.innerWidth()\n  $div.remove()\n  return w1 - w2\n}\n\n// Simple animation for dimming an element's opacity\n$.fn.dim = function(speed) {\n  return this.animate({opacity: 0.4}, speed)\n}\n\n$.fn.undim = function(speed) {\n  return this.animate({opacity: 1.0}, speed)\n}\n\n// Helper for deleting objects from the DOM and db.\n//  url: URL to pass DELETE message.  If none provided,\n//    behaves as if the request were a success.  Useful for testing.\n//  message: Confirmation message\n//  cancelled: Function to handle cancel.\n//  confirmed: Function to handle confirm, before submit.\n//  success: What to do on success.  If none provided, fades\n//    out the element and removes it from the DOM.\n//  error: Error.\n//  dialog: If present, do a jquery.ui.dialog instead of a confirm(). If an\n//    object, it will be merged into the dialog options.\n$.fn.confirmDelete = function(options) {\n  var options = $.extend({}, $.fn.confirmDelete.defaults, options)\n  const $object = this\n  let $dialog = null\n  let result = true\n  options.noMessage = options.noMessage || options.no_message\n  const onContinue = function() {\n    if (!result) {\n      if (options.cancelled && $.isFunction(options.cancelled)) {\n        options.cancelled.call($object)\n      }\n      return\n    }\n    if (!options.confirmed) {\n      options.confirmed = function() {\n        $object.dim()\n      }\n    }\n    options.confirmed.call($object)\n    if (options.url) {\n      if (!options.success) {\n        options.success = function(data) {\n          $object.fadeOut('slow', () => {\n            $object.remove()\n          })\n        }\n      }\n      const data = options.prepareData ? options.prepareData.call($object, $dialog) : {}\n      data.authenticity_token = authenticity_token()\n      $.ajaxJSON(\n        options.url,\n        'DELETE',\n        data,\n        data => {\n          options.success.call($object, data)\n        },\n        (data, request, status, error) => {\n          if (options.error && $.isFunction(options.error)) {\n            options.error.call($object, data, request, status, error)\n          } else {\n            $.ajaxJSON.unhandledXHRs.push(request)\n          }\n        }\n      )\n    } else {\n      if (!options.success) {\n        options.success = function() {\n          $object.fadeOut('slow', () => {\n            $object.remove()\n          })\n        }\n      }\n      options.success.call($object)\n    }\n  }\n  if (options.message && !options.noMessage && !$.skipConfirmations) {\n    if (options.dialog) {\n      result = false\n      const dialog_options = typeof options.dialog === 'object' ? options.dialog : {}\n      const confirmation_class = options.url.includes('assignments') ? 'btn-danger' : 'btn-primary'\n      $dialog = $(options.message).dialog(\n        $.extend(\n          {},\n          {\n            modal: true,\n            close: onContinue,\n            buttons: [\n              {\n                text: I18n.t('#buttons.cancel', 'Cancel'),\n                click() {\n                  $(this).dialog('close')\n                } // ; onContinue();\n              },\n              {\n                text: I18n.t('#buttons.delete', 'Delete'),\n                class: confirmation_class,\n                click() {\n                  result = true\n                  $(this).dialog('close')\n                }\n              }\n            ]\n          },\n          dialog_options\n        )\n      )\n      return\n    } else {\n      result = confirm(options.message)\n    }\n  }\n  onContinue()\n}\n$.fn.confirmDelete.defaults = {\n  get message() {\n    return I18n.t('confirms.default_delete_thing', 'Are you sure you want to delete this?')\n  }\n}\n\n// Watches the given element's location.href for any changes\n// to the fragment (\"#...\") and calls the provided function\n// when there are any.\n// $(document).fragmentChange(function(event, hash) { alert(hash); });\n$.fn.fragmentChange = function(fn) {\n  if (fn && fn !== true) {\n    const query = (window.location.search || '').replace(/^\\?/, '').split('&')\n    // The URL can hard-code a hash regardless of what's\n    // actually shown in the hash by specifying a query\n    // parameter, hash=some_hash\n    let query_hash = null\n    for (var i = 0; i < query.length; i++) {\n      const item = query[i]\n      if (item && item.indexOf('hash=') === 0) {\n        query_hash = '#' + item.substring(5)\n      }\n    }\n    this.bind('document_fragment_change', fn)\n    const $doc = this\n    let found = false\n    // Can only be used on the root document,\n    // will not work on an iframe, for example.\n    for (var i = 0; i < $._checkFragments.fragmentList.length; i++) {\n      const obj = $._checkFragments.fragmentList[i]\n      if (obj.doc[0] == $doc[0]) {\n        found = true\n      }\n    }\n    if (!found) {\n      $._checkFragments.fragmentList.push({\n        doc: $doc,\n        fragment: ''\n      })\n    }\n    $(window).bind('hashchange', $._checkFragments)\n    setTimeout(() => {\n      if (query_hash && query_hash.length > 0) {\n        $doc.triggerHandler('document_fragment_change', query_hash)\n      } else if ($doc && $doc[0] && $doc[0].location && $doc[0].location.hash.length > 0) {\n        $doc.triggerHandler('document_fragment_change', $doc[0].location.hash)\n      }\n    }, 500)\n  } else {\n    this.triggerHandler('document_fragment_change', this[0].location.hash)\n  }\n  return this\n}\n$._checkFragments = function() {\n  const list = $._checkFragments.fragmentList\n  for (let idx = 0; idx < list.length; idx++) {\n    const obj = list[idx]\n    const $doc = obj.doc\n    if ($doc[0].location.hash != obj.fragment) {\n      $doc.triggerHandler('document_fragment_change', $doc[0].location.hash)\n      obj.fragment = $doc[0].location.hash\n      $._checkFragments.fragmentList[idx] = obj\n    }\n  }\n}\n$._checkFragments.fragmentList = []\n// Triggers a click only if the anchor tag isn't disabled.\n$.fn.clickLink = function() {\n  const $obj = this.eq(0)\n  if (!$obj.hasClass('disabled_link')) {\n    $obj.click()\n  }\n}\n\n// jQuery supposedly has this built-in, but I haven't\n// had much success with it.\n$.fn.showIf = function(bool) {\n  if ($.isFunction(bool)) {\n    return this.each(function(index) {\n      $(this).showIf(bool.call(this))\n    })\n  }\n  if (bool) {\n    this.show()\n  } else {\n    this.hide()\n  }\n  return this\n}\n\n$.fn.disableIf = function(bool) {\n  if ($.isFunction(bool)) {\n    bool = bool.call(this)\n  }\n  this.prop('disabled', !!bool)\n  return this\n}\n\n$.fn.indicate = function(options) {\n  options = options || {}\n  let $indicator\n  if (options == 'remove') {\n    $indicator = this.data('indicator')\n    if ($indicator) {\n      $indicator.remove()\n    }\n    return\n  }\n  $('.indicator_box').remove()\n  let offset = this.offset()\n  if (options && options.offset) {\n    offset = options.offset\n  }\n  const width = this.width()\n  const height = this.height()\n  const zIndex = (options.container || this).zIndex()\n  $indicator = $(document.createElement('div'))\n  $indicator.css({\n    width: width + 6,\n    height: height + 6,\n    top: offset.top - 3,\n    left: offset.left - 3,\n    zIndex: zIndex + 1,\n    position: 'absolute',\n    display: 'block',\n    '-moz-border-radius': 5,\n    opacity: 0.8,\n    border: '2px solid #870',\n    backgroundColor: '#fd0'\n  })\n  $indicator.addClass('indicator_box')\n  $indicator.mouseover(function() {\n    $(this)\n      .stop()\n      .fadeOut('fast', function() {\n        $(this).remove()\n      })\n  })\n  if (this.data('indicator')) {\n    this.indicate('remove')\n  }\n  this.data('indicator', $indicator)\n  $('body').append($indicator)\n  if (options && options.singleFlash) {\n    $indicator\n      .hide()\n      .fadeIn()\n      .animate({opacity: 0.8}, 500)\n      .fadeOut('slow', function() {\n        $(this).remove()\n      })\n  } else {\n    $indicator\n      .hide()\n      .fadeIn()\n      .animate({opacity: 0.8}, 500)\n      .fadeOut('slow')\n      .fadeIn('slow')\n      .animate({opacity: 0.8}, 2500)\n      .fadeOut('slow', function() {\n        $(this).remove()\n      })\n  }\n  if (options && options.scroll) {\n    $('html,body').scrollToVisible($indicator)\n  }\n}\n\n$.fn.hasScrollbar = function() {\n  return this.length && this[0].clientHeight < this[0].scrollHeight\n}\n\n$.fn.log = function(msg) {\n  console.log('%s: %o', msg, this)\n  return this\n}\n\n// this is used if you want to fill the browser window with something inside #content but you want to also leave the footer and header on the page.\n$.fn.fillWindowWithMe = function(options) {\n  const opts = $.extend({minHeight: 400}, options),\n    $this = $(this),\n    $wrapper = $('#wrapper'),\n    $main = $('#main'),\n    $not_right_side = $('#not_right_side'),\n    $window = $(window),\n    $toResize = $(this).add(opts.alsoResize)\n\n  function fillWindowWithThisElement() {\n    $toResize.height(0)\n    const spaceLeftForThis =\n        $window.height() -\n        ($wrapper.offset().top + $wrapper.outerHeight()) +\n        ($main.height() - $not_right_side.height()),\n      newHeight = Math.max(400, spaceLeftForThis)\n\n    $toResize.height(newHeight)\n    if ($.isFunction(opts.onResize)) {\n      opts.onResize.call($this, newHeight)\n    }\n  }\n  fillWindowWithThisElement()\n  $window\n    .unbind('resize.fillWindowWithMe')\n    .bind('resize.fillWindowWithMe', fillWindowWithThisElement)\n  return this\n}\n\n$.fn.autoGrowInput = function(o) {\n  o = $.extend(\n    {\n      maxWidth: 1000,\n      minWidth: 0,\n      comfortZone: 70\n    },\n    o\n  )\n\n  this.filter('input:text').each(function() {\n    let minWidth = o.minWidth || $(this).width(),\n      val = '',\n      input = $(this),\n      testSubject = $('<tester/>').css({\n        position: 'absolute',\n        top: -9999,\n        left: -9999,\n        width: 'auto',\n        fontSize: input.css('fontSize'),\n        fontFamily: input.css('fontFamily'),\n        fontWeight: input.css('fontWeight'),\n        letterSpacing: input.css('letterSpacing'),\n        whiteSpace: 'nowrap'\n      }),\n      check = function() {\n        setTimeout(() => {\n          if (val === (val = input.val())) {\n            return\n          }\n\n          // Enter new content into testSubject\n          testSubject.text(val)\n\n          // Calculate new width + whether to change\n          const testerWidth = testSubject.width(),\n            newWidth =\n              testerWidth + o.comfortZone >= minWidth ? testerWidth + o.comfortZone : minWidth,\n            currentWidth = input.width(),\n            isValidWidthChange =\n              (newWidth < currentWidth && newWidth >= minWidth) ||\n              (newWidth > minWidth && newWidth < o.maxWidth)\n\n          // Animate width\n          if (isValidWidthChange) {\n            input.width(newWidth)\n          }\n        })\n      }\n\n    testSubject.insertAfter(input)\n\n    $(this).bind('keyup keydown blur update change', check)\n  })\n\n  return this\n}\n\nexport default $\n","// this file was auto-generated by rake i18n:generate_js.\n// you probably shouldn't edit it directly\nimport mergeI18nTranslations from 'mergeI18nTranslations';\n\n// we use JSON.parse here instead of just loading it as a javascript object literal\n// because according to https://v8.dev/blog/cost-of-javascript-2019#json that is faster\nmergeI18nTranslations(JSON.parse(\"{\\\"ar\\\":{\\\"user_content_aaf0fb5a\\\":\\\"محتوى المستخدم\\\"},\\\"cy\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Cynnwys Defnyddiwr\\\"},\\\"da\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Brugerindhold\\\"},\\\"da-x-k12\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Brugerindhold\\\"},\\\"de\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Benutzer-Content\\\"},\\\"el\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Περιεχόμενο Χρήστη\\\"},\\\"en-AU\\\":{\\\"user_content_aaf0fb5a\\\":\\\"User Content\\\"},\\\"en-CA\\\":{\\\"user_content_aaf0fb5a\\\":\\\"User Content\\\"},\\\"en-GB\\\":{\\\"user_content_aaf0fb5a\\\":\\\"User content\\\"},\\\"es\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Contenido del usuario\\\"},\\\"fa\\\":{\\\"user_content_aaf0fb5a\\\":\\\"محتوای کاربر\\\"},\\\"fi\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Käyttäjän sisältö\\\"},\\\"fr\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Contenu de l'utilisateur\\\"},\\\"fr-CA\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Contenu de l'utilisateur\\\"},\\\"he\\\":{\\\"user_content_aaf0fb5a\\\":\\\"תוכן משתמש\\\"},\\\"ht\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Kontni Itilizatè\\\"},\\\"hu\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Felhasználói tartalom\\\"},\\\"is\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Notandaefni\\\"},\\\"it\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Contenuto utente\\\"},\\\"ja\\\":{\\\"user_content_aaf0fb5a\\\":\\\"ユーザーコンテンツ\\\"},\\\"mi\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Ihirangi kaiwhakamahi\\\"},\\\"nb\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Brukerinnhold\\\"},\\\"nb-x-k12\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Brukerinnhold\\\"},\\\"nl\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Gebruikersinhoud\\\"},\\\"nn\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Brukarinnhald\\\"},\\\"pl\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Zawartość użytkownika\\\"},\\\"pt\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Conteúdo do Utilizador\\\"},\\\"pt-BR\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Conteúdo do Usuário\\\"},\\\"ru\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Контент пользователя\\\"},\\\"sl\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Vsebina uporabnika\\\"},\\\"sv\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Användarinnehåll\\\"},\\\"sv-x-k12\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Användarinnehåll\\\"},\\\"tr\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Kullanıcı İçeriği\\\"},\\\"uk\\\":{\\\"user_content_aaf0fb5a\\\":\\\"Контент користувача\\\"},\\\"zh-Hans\\\":{\\\"user_content_aaf0fb5a\\\":\\\"用户内容\\\"},\\\"zh-Hant\\\":{\\\"user_content_aaf0fb5a\\\":\\\"使用者內容\\\"}}\"));\n","\n    import I18n from 'i18nObj';\n    \n      import 'translations/user_content';\n      import 'translations/_core';\n    \n    import 'translations/_core_en';\n\n    export default I18n.scoped('user_content');\n  ","//\n// Copyright (C) 2015 - present Instructure, Inc.\n//\n// This file is part of Canvas.\n//\n// Canvas is free software: you can redistribute it and/or modify it under\n// the terms of the GNU Affero General Public License as published by the Free\n// Software Foundation, version 3 of the License.\n//\n// Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n// WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n// A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n// details.\n//\n// You should have received a copy of the GNU Affero General Public License along\n// with this program. If not, see <http://www.gnu.org/licenses/>.\n\nimport $ from 'jquery'\nimport _ from 'underscore'\nimport htmlEscape from 'str/htmlEscape'\nimport I18n from 'i18n!user_content'\n\nconst apiUserContent = {\n  /*\n  xsslint safeString.identifier mathml\n  */\n  translateMathmlForScreenreaders($equationImage) {\n    // note, it is safe to treat the x-canvaslms-safe-mathml as html because it\n    // only ever gets put there by us (in Api::Html::Content::apply_mathml).\n    // Any user content that gets sent to the server will have the\n    // x-canvaslms-safe-mathml attribute stripped out.\n    const mathml = $('<div/>')\n      .html($equationImage.attr('x-canvaslms-safe-mathml'))\n      .html()\n    const mathmlSpan = $('<span class=\"hidden-readable\"></span>')\n    mathmlSpan.html(mathml)\n    return mathmlSpan\n  },\n\n  toMediaCommentLink(node) {\n    const $link = $(\n      `<a\n        id='media_comment_${htmlEscape($(node).data('media_comment_id'))}'\n        data-media_comment_type='${htmlEscape($(node).data('media_comment_type'))}'\n        class='instructure_inline_media_comment ${htmlEscape(node.nodeName.toLowerCase())}_comment'\n        data-alt='${htmlEscape($(node).attr('data-alt'))}'\n      />`\n    )\n    $link.html($(node).html())\n    return $link\n  },\n\n  /*\n  xsslint safeString.identifier mathmlSpan\n  */\n  // use this method to process any user content fields returned in api responses\n  // this is important to handle object/embed tags safely, and to properly display audio/video tags\n  convert(html, options = {}) {\n    const $dummy = $('<div />').html(html)\n    // finds any <video/audio class=\"instructure_inline_media_comment\"> and turns them into media comment thumbnails\n    $dummy\n      .find('video.instructure_inline_media_comment,audio.instructure_inline_media_comment')\n      .replaceWith(function() {\n        return apiUserContent.toMediaCommentLink(this)\n      })\n\n    // remove any embed tags inside an object tag, to avoid repeated translations\n    $dummy.find('object.instructure_user_content:not(#kaltura_player) embed').remove()\n\n    // if we aren't actually displaying this content but are instead putting\n    // it into a RTE, we want to preserve the object/embed tags\n    if (!options.forEditing) {\n      // find all object/embed tags and convert them into an iframe that posts\n      // to safefiles to display the content (to avoid javascript attacks)\n      //\n      // see the corresponding code in lib/user_content.rb for non-api user\n      // content handling\n      $dummy\n        .find('object.instructure_user_content,embed.instructure_user_content')\n        .replaceWith(function() {\n          const $this = $(this)\n          if (!$this.data('uc_snippet') || !$this.data('uc_sig')) {\n            return this\n          }\n\n          const uuid = _.uniqueId('uc_')\n          let action = '/object_snippet'\n          if (ENV.files_domain) {\n            action = `//${ENV.files_domain}${action}`\n          }\n          const $form = $(\n            `<form\n            action='${htmlEscape(action)}'\n            method='post'\n            class='user_content_post_form'\n            target='${htmlEscape(uuid)}'\n            id='form-${htmlEscape(uuid)}'\n          />`\n          )\n          $form.append(\n            $(\"<input type='hidden'/>\").attr({\n              name: 'object_data',\n              value: $this.data('uc_snippet')\n            })\n          )\n          $form.append(\n            $(\"<input type='hidden'/>\").attr({\n              name: 's',\n              value: $this.data('uc_sig')\n            })\n          )\n          $('body').append($form)\n          setTimeout(() => $form.submit(), 0)\n          return $(\n            `<iframe\n            class='user_content_iframe'\n            name='${htmlEscape(uuid)}'\n            style='width: ${htmlEscape($this.data('uc_width'))}; height: ${htmlEscape(\n              $this.data('uc_height')\n            )};'\n            frameborder='0'\n            title='${htmlEscape(I18n.t('User Content'))}'\n          />`\n          )\n        })\n\n      $dummy.find('img.equation_image').each((index, equationImage) => {\n        const $equationImage = $(equationImage)\n        const mathmlSpan = apiUserContent.translateMathmlForScreenreaders($equationImage)\n        $equationImage.removeAttr('x-canvaslms-safe-mathml')\n        $equationImage.after(mathmlSpan)\n      })\n    }\n    return $dummy.html()\n  }\n}\n\nexport default apiUserContent\n"],"sourceRoot":""}