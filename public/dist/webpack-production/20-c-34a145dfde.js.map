{"version":3,"sources":["webpack:///./app/jsx/shared/helpers/deprecated.js","webpack:///./app/jsx/shared/rce/RichContentEditor.js","webpack:///./public/javascripts/translations/editor_accessibility.js","webpack:///./public/javascripts/dummyI18nResource.js?093d","webpack:///./app/coffeescripts/editor/editorAccessibility.js","webpack:///./public/javascripts/translations/findLinkForService.js","webpack:///./public/javascripts/dummyI18nResource.js?4e71","webpack:///./public/javascripts/findLinkForService.js","webpack:///./app/jsx/shared/rce/Sidebar.js","webpack:///./app/jsx/shared/jwt.js","webpack:///./public/javascripts/tinymce.config.js","webpack:///./app/jsx/shared/rce/editorOptions.js","webpack:///./public/javascripts/setupAndFocusTinyMCEConfig.js","webpack:///./public/javascripts/translations/ExternalToolsPlugin.js","webpack:///./public/javascripts/dummyI18nResource.js?30e1","webpack:///./public/javascripts/jquery.dropdownList.js","webpack:///./public/javascripts/tinymce_plugins/instructure_external_tools/ExternalToolsHelper.js","webpack:///./public/javascripts/tinymce_plugins/instructure_links/linkable_editor.js","webpack:///./public/javascripts/tinymce_plugins/instructure_links/youtube_api.js","webpack:///./public/javascripts/tinymce_plugins/instructure_links/links.js","webpack:///./public/javascripts/tinymce_plugins/instructure_external_tools/initializeExternalTools.js","webpack:///./app/jsx/shared/rce/polyfill.js","webpack:///./app/jsx/shared/rce/serviceRCELoader.js","webpack:///./app/jsx/shared/rce/loadEventListeners.js"],"names":["deprecated","message","obj","method","fn","Sidebar","ENV","use_rce_enhancements","require","default","_editorUid","ensureID","el","$el","$","id","attr","freshNode","target","$target","node2jquery","targetId","newTarget","length","RichContentEditor","preloadRemoteModule","cb","serviceRCELoader","preload","initSidebar","deprecationMsg","subscriptions","init","showSidebar","show","hideSidebar","hide","loadNewEditor","tinyMCEInitOptions","extend","this","manageParent","parentId","parent","wrap","establishParentNode","callback","css","originalOnFocus","onFocus","args","Function","loadOnTarget","textarea","remoteEditor","data","trigger","RCELOADED_EVENT_NAME","loadServiceRCE","rce","focus","activateRCE","callOnRCE","methodName","send","destroyRCE","destroy","node","mergeI18nTranslations","JSON","parse","scoped","EditorAccessiblity","constructor","editor","id_prepend","editorContainer","accessiblize","_cacheElements","_addTitles","_addLabels","_accessiblizeMenubar","_removeStatusbarFromTabindex","$iframe","find","I18n","t","getBody","text","$menubar","$firstMenu","first","addShortcut","getUserServices","service_types","success","error","isArray","url","join","ajaxJSON","lastLookup","findLinkForService","service_type","$dialog","append","htmlEscape","submit","event","preventDefault","stopPropagation","now","Date","setTimeout","empty","query","val","replaceTags","idx","short_title","title","description","TextHelper","truncateText","max","appendTo","href","delegate","dialog","end","service_name","titleize","open","select","width","instance","pendingShow","initializing","loadSidebarOnTarget","get","loadServiceSidebar","sidebar","reset","refreshFn","initialToken","token","promise","done","axios","post","jwt","then","resp","EditorConfig","tinymce","inst","domId","formatBtnGroup","positionBtnGroup","fontBtnGroup","baseURL","maxButtons","maxVisibleEditorButtons","extraButtons","editorButtons","instConfig","viewportWidth","idAttribute","defaultConfig","selector","toolbar","window","directionality","getDirection","plugins","external_plugins","instructure_image","instructure_links","instructure_embed","instructure_equation","instructure_external_tools","instructure_record","language_load","convert_urls","menubar","branding","remove_script_host","resize","block_formats","valid_elements","extended_valid_elements","non_empty_elements","content_css","url_to_what_gets_loaded_inside_the_tinymce_editor_css","browser_spellcheck","init_instance_callback","ed","show_media_upload","INST","kalturaSettings","hide_rte_button","external_buttons","externals","match","buildInstructureButtons","instructure_buttons","allowMediaComments","equellaEnabled","balanceButtons","instBtnGroup","buttons1","buttons2","buttons3","map","b","split","editorOptions","enableBookmarkingOverride","editorConfig","autoFocus","enableBookmarking","auto_focus","setup","$editor","on","e","document","selection","getBookmark","mod","triggerHandler","contentDocument","bind","mceSrc","nodeType","nodeName","activeEditor","documentBaseURI","toAbsolute","contentWindow","blur","removed","undoManager","typing","add","setupAndFocusTinyMCEConfig","tinyOptions","dropdownList","options","$div","remove","defaults","$list","children","mousedown","closest","mouseup","keydown","$current","keyCode","prev","removeClass","addClass","$item","next","click","height","each","optionHtml","$option","unhoverOtherOptions","isFunction","mouseenter","mouseleave","offset","outerHeight","outerWidth","whiteSpace","position","top","left","right","buttonConfig","button","config","name","classes","onAction","execCommand","cmd","canvas_icon_class","icon","image","icon_url","clumpedButtonMapping","clumpedButtons","onClickHandler","reduce","items","key","attachClumpedDropdown","buttons","LinkableEditor","$editorEl","selectedContent","getContent","selectionDetails","getNode","range","getRng","getEditor","createLink","dataAttrs","dataAttributes","YouTubeApi","fetchYouTubeTitle","JWT","appHost","RICH_CONTENT_APP_HOST","ajax","headers","Authorization","err","titleYouTubeText","$link","youTubeID","vidTitle","console","responseText","yttFailCnt","inlineContentClasses","autoShowContentClasses","initializedEditors","WeakMap","buttonToImg","src","prepEditorForDialog","nodeChanged","buildLinkClasses","priorClasses","$box","replace","bindLinkSubmit","linkableEditor","fetchClasses","$form","off","alt","call","updateLinks","arg","counter","yt_api","hasClass","youTubeRegEx","renderDialog","createElement","$services","service","$service","user_service","$img","after","change","showIf","$alt","toggleClass","for_inline_content","for_inline_content_can_auto_show","prior_classes","re","RegExp","hideDisableEnhancement","hideShowInline","img","Image","checkCompletion","complete","paddingLeft","background","display","parentNode","$a","preview_alt","initEditor","$holder","$frame","style","set","TRANSLATIONS","ExternalToolsPlugin","_INST","Links","ExternalToolDialog","dialogContainer","body","appendChild","ReactDOM","render","win","contextAssetString","context_asset_string","iframeAllowances","resourceSelectionUrl","deepLinkingOrigin","DEEP_LINKING_POST_MESSAGE_ORIGIN","ltiButtons","current_button","openDialog","push","ExternalToolsHelper","addCommand","addButton","ui","registry","ev","CustomEvent","detail","dispatchEvent","tooltip","handleClick","_id","more_external_tools","onkeyup","onclick","editorExtensions","_textareaEl","sidebarExtensions","polyfill","wrapEditor","extensions","Object","assign","wrapSidebar","getTrayProps","contextType","contextId","userId","current_user_id","RICH_CONTENT_CAN_UPLOAD_FILES","splitAssetString","canUploadFiles","containingContext","filesTabDisabled","RICH_CONTENT_FILES_TAB_DISABLED","host","refreshToken","themeUrl","active_brand_config_json_url","liveRegion","getElementById","loadingPromise","RCELoader","requestIdleCallback","loadRCE","getTargetTextarea","renderingTarget","getRenderingTarget","propsForRCE","createRCEProps","FEATURES","la_620_old_rce_init_fix","RCE","renderIntoDiv","async","Promise","resolve","reject","mceInstance","iid","setInterval","clearInterval","getTinyInstance","RICH_CONTENT_SKIP_SIDEBAR","props","renderSidebarIntoDiv","remoteSidebar","loadingCallbacks","callbacks","forEach","cbName","addEventListener","EquationEditorView","view","equationCB","linksCB","InsertUpdateImageView","selectedNode","imagePickerCB","initializeEquella","equellaCB","initializeExternalTools","externalToolCB","mediaEditorLoader","insertEditor","recordCB","loadEventListeners","loadingCallback","initialTarget","type","getTargetFn","_attrsToMirror","attrs","_","attributes","memo","value","pick","offsetWidth","offsetHeight","myLanguage","LOCALE","languages","keys","closedCaptionLanguages","locale","label","sort","a","localeCompare","autosave","enabled","rce_auto_save","rce_auto_save_max_age_ms","Number","isNaN","defaultContent","language","mirroredAttrs","onBlur","textareaClassName","className","textareaId","trayProps"],"mappings":";;AAqCe,SAASA,EAAWC,EAASC,EAAKC,EAAQC,GAmBvD,OAlBkBD,EACYD,EAAoB,mBAAPE,EAAoBA,EAAKF,EAAIC,G;AChB1E,MAAME,GAAWC,IAAIC,sBAAwBC,EAAQ,QAAkBC;AA8CvE,IAAIC,EAAa;AAUjB,SAASC,EAASC,GAChB,MAAMC,EAAMC,IAAEF,GACRG,EAAK,SAAUF,EAAMA,EAAIG,KAAK,MAAQH,EAAIE;AAC3CA,GAAY,IAANA,GACTF,EAAIG,KAAK,KAZX,2BAA2BN,MAsB7B,SAASO,EAAUC,GACjB,MAAMC,EAAUC,EAAYF,GAEtBG,EAAWF,EAAQH,KAAK;AAC9B,IAAKK,GAAwB,IAAZA,EACf,OAAOF;AAGT,MAAMG,EAAYR,IAAE,IAAD,OAAKO;AACxB,OAAIC,EAAUC,QAAU,EACfJ,EAEFG,EAGT,MAGME,EAAoB,CASxBC,oBAAmB,CAACC,EAAK,WAChBC,IAAiBC,QAAQF,GASlCG,YAAa7B,EAAW8B,EAAgB,CAACC,EAAgB,MAClDzB,IAAIC,sBAAsBF,EAAQ2B,KAAKD,KAS9CE,YAAajC,EAAW8B,EAAgB,KACjCxB,IAAIC,sBAAsBF,EAAQ6B,SASzCC,YAAanC,EAAW8B,EAAgB,KACjCxB,IAAIC,sBAAsBF,EAAQ+B,SAkBzCC,cAAcnB,EAAQoB,EAAqB,GAAIZ,GAC7C,IAAIP,EAAUC,EAAYF;AAC1B,GAAIC,EAAQI,QAAU,EAEpB;AAGFZ,EAASQ,GAGTmB,EAAqBxB,IAAEyB,OAAO,GAAID;AAYlCnB,EAAUqB,KAAKvB,UAAUE,GAErBmB,EAAmBG,sBACdH,EAAmBG,aAlJhC,SAA6BvB,GAC3B,MAAMC,EAAUC,EAAYF,GAKtBG,EAAWF,EAAQH,KAAK,MAExB0B,EAAW,qBAAH,OAAwBrB;AACtC,GAAIF,EAAQwB,SAAS3B,KAAK,QAAU0B,EAG3BvB,EAAQyB,KAAR,mBAAyBF,EAAzB,wCAuILG,CAAoB1B,IA1K1B,SAAwBD,EAAQoB,EAAoBQ,GAClD5B,EAAO6B,IAAI,UAAW;AAEtB,MAAMC,EAAkBV,EAAmBW;AAE3CX,EAAmBW,QAAU,IAAIC,KAC1B5C,IAAIC,sBAAsBiB,EAAkBS,cAC7Ce,aAA2BG,UAC7BH,KAAmBE,IAIvBvB,IAAiByB,aAAalC,EAAQoB,EAAoB,CAACe,EAAUC,KACnE,MAAMnC,EAAUC,EAAYF;AACVD,EAAUH,IAAEuC,IACpBE,KAAK,eAAgBD,GAC/BnC,EAAQqC,QAAQC,IAAsBH,GAClCR,GACFA,EAASQ,KA2JXI,CAAevC,EAASmB,EAjBPqB,IACXrB,EAAmBsB,OAErBpB,KAAKqB,YAAY1C,GAEfO,GACFA,EAAGiC,KA1HT7C,IAAE,qBAAqBE,KAAK,eAAe,IA+I3C8C,UAAU5C,EAAQ6C,KAAeb,GAC/B,IAAI/B,EAAUC,EAAYF;AAE1B,OADAC,EAAUqB,KAAKvB,UAAUE,GAClB6C,YAAK7C,EAAS4C,KAAeb,IAQtCe,WAAW/C,GACT,IAAIC,EAAUC,EAAYF;AAC1BC,EAAUqB,KAAKvB,UAAUE,GACzB+C,YAAQ/C,GACHb,IAAIC,sBAAsBF,EAAQ+B,QASzCyB,YAAY3C,GACV,IAAIC,EAAUC,EAAYF;AAC1BC,EAAUqB,KAAKvB,UAAUE,GACzByC,YAAMzC,GACDb,IAAIC,sBAAsBF,EAAQ6B,QAGzCjB,YACAN;AAKF,SAASS,EAAY+C,GACnB,OAAOA,EAAK5C,OAAS4C,EAAOrD,IAAEqD,GAGjB3C,O;;;ACnPf,OAAA4C,EAAA,GAAsBC,KAAKC,MAAM;;ICEd,YAAKC,OAAO,wB;ACchB,MAAMC,EACnBC,YAAYC,GACVlC,KAAKkC,OAASA,EACdlC,KAAKmC,WAAaD,EAAO3D,GACzByB,KAAK3B,IAAMC,IAAE,IAAD,OAAK4D,EAAOE,gBAAgB7D,KAG1C8D,eACErC,KAAKsC,iBACLtC,KAAKuC,aACLvC,KAAKwC,aACLxC,KAAKyC,uBACLzC,KAAK0C,+BAIPJ,iBACEtC,KAAK2C,QAAU3C,KAAK3B,IAAIuE,KAAK,yBAG/BJ,aACExC,KAAK3B,IAAIG,KAAK,aAAcqE,EAAKC,EAAE,wBACnCxE,IAAE0B,KAAKkC,OAAOa,WAAWvE,KAAK,aAAcF,IAAE,cAAD,OAAe0B,KAAKmC,WAApB,OAAoCa,QACjFhD,KAAK3B,IACFuE,KAAK,gCACLpE,KAAK,aAAcqE,EAAKC,EAAE,mBAAoB,oCACjD9C,KAAK3B,IACFuE,KAAK,8CACLpE,KAAK,aAAcqE,EAAKC,EAAE,oBAAqB,qCAClD9C,KAAK3B,IACFuE,KAAK,gCACLpE,KAAK,aAAcqE,EAAKC,EAAE,wBAAyB,qCACtD9C,KAAK3B,IACFuE,KAAK,qCACLpE,KACC,aACAqE,EAAKC,EAAE,+BAAgC,2CAI7CP,aACEvC,KAAK2C,QAAQnE,KAAK,QAASqE,EAAKC,EAAE,kBAAmB,0CAIvDL,uBACE,MAAMQ,EAAWjD,KAAK3B,IAAIuE,KAAK,gBACzBM,EAAaD,EAASL,KAAK,gBAAgBO;AACjDF,EAASrD,OACTI,KAAKkC,OAAOkB,YAAY,SAAU,GAAI,KACpCH,EAASvD,OACTwD,EAAW9B,QAEXpB,KAAKkC,OAAOkB,YAAY,SAAU,GAAI,IAAMF,EAAW9B,WAM3DsB,+BACqB1C,KAAK3B,IAAIuE,KAAK,wCACtBpE,KAAK,YAAa,M;;;AC7EjC,OAAAoD,EAAA,GAAsBC,KAAKC,MAAM;;ICEd,YAAKC,OAAO,sB;;ACkBxB,SAASsB,EAAgBC,EAAeC,EAASC,GACjDlF,IAAEmF,QAAQH,KACbA,EAAgB,CAACA;AAEnB,MAAMI,EAAM,2BAAH,OAA8BJ,EAAcK,KAAK;AAC1DrF,IAAEsF,SACAF,EACA,MACA,GACA3C,IACMwC,GACFA,EAAQxC,IAGZA,IACMyC,GACFA,EAAMzC,KAMd,IAAI8C;AACG,SAASC,EAAmBC,EAAczD,GAC/C,IAAI0D,EAAU1F,IAAE;AACX0F,EAAQjF,SACXiF,EAAU1F,IAAE,2CACZ0F,EAAQC,OAAR,UACK,kNADL,OAIyDC,YACrDrB,EAAKC,EAAE,iBAAkB,WAL7B,qBAQAkB,EAAQC,OAAO,qEACfD,EAAQpB,KAAK,QAAQuB,OAAOC,IAC1BA,EAAMC,iBACND,EAAME;AACN,MAAMC,EAAM,IAAIC;AAChB,GAAoB,SAAhBT,GAA2BF,GAAcU,EAAMV,EAAa,KAgB9D,OAdAY,WAAW,KACTT,EAAQpB,KAAK,QAAQuB,UACpB,MAASI,EAAMV,SAClBG,EACGpB,KAAK,YACL8B,QACAT,OACCC,YACErB,EAAKC,EACH,iCACA;AAMVkB,EACGpB,KAAK,YACL8B,QACAT,OAAOC,YAAWrB,EAAKC,EAAE,mBAAoB,kBAChDe,EAAa,IAAIW;AACjB,MAAMG,EAAQX,EAAQpB,KAAK,UAAUgC,MAC/BlB,EAAMpF,IAAEuG,YAAYb,EAAQjD,KAAK,iBAAkB,QAAS4D;AAClErG,IAAEsF,SACAF,EACA,MACA,GACA3C,IACEiD,EAAQpB,KAAK,YAAY8B,QACpB3D,EAAKhC,QACRiF,EACGpB,KAAK,YACLqB,OAAOC,YAAWrB,EAAKC,EAAE,mBAAoB;AAElD,IAAK,MAAMgC,KAAO/D,EAChBA,EAAK+D,GAAKC,YAAchE,EAAK+D,GAAKE,MAC9BjE,EAAK+D,GAAKE,OAASjE,EAAK+D,GAAKG,cAC/BlE,EAAK+D,GAAKC,YAAcG,IAAWC,aAAapE,EAAK+D,GAAKG,YAAa,CAACG,IAAK,MAE/E9G,IAAE,2BACC+G,SAASrB,EAAQpB,KAAK,aACtBqB,OACC3F,IAAE,yDACCE,KAAK,CACJ8G,KAAMvE,EAAK+D,GAAKpB,IAChBsB,MAAOjE,EAAK+D,GAAKE,QAElBhC,KAAKjC,EAAK+D,GAAKC,cAEnBd,OACC3F,IAAE,sDAAsD0E,KACtDjC,EAAK+D,GAAKG,aAAepC,EAAKC,EAAE,iBAAkB,qBAK5D,KACEkB,EACGpB,KAAK,YACL8B,QACAT,OAAOC,YAAWrB,EAAKC,EAAE,uBAAwB,0CAI1DkB,EAAQuB,SAAS,iBAAkB,SAAS,SAASnB,GACnDA,EAAMC;AACN,MAAMX,EAAMpF,IAAE0B,MAAMxB,KAAK,QACnBwG,EAAQ1G,IAAE0B,MAAMxB,KAAK,UAAYF,IAAE0B,MAAMgD;AAC/CgB,EAAQwB,OAAO,SACflF,EAAS,CACPoD,MACAsB,cAINhB,EACGpB,KAAK,kBACLI,KACiB,aAAhBe,EACIlB,EAAKC,EAAE,wBAAyB,iBAChCD,EAAKC,EAAE,iBAAkB,WAEjCkB,EAAQpB,KAAK,YAAYpE,KAAK,MAA9B,kBAAgDuF,EAAhD;AACA,IAAIL,EAAM;AACVA,EAAMpF,IAAEuG,YAAYnB,EAAK,eAAgBK,GACzCC,EAAQjD,KAAK,gBAAiB2C,GAC9BM,EACGpB,KAAK,YACL8B,QACAe,MACA7C,KAAK,UACLgC,IAAI,IACPZ,EAAQwB,OAAO,CACbR,MAAOnC,EAAKC,EAAE,yBAA0B,mCAAoC,CAC1E4C,aAAcpH,IAAEqH,SAAS5B,KAE3B6B,OACE5B,EACGpB,KAAK,uBACLxB,QACAyE,UAELC,MAAO,Q;AC1KX;AAAA;AAyBA,MAAMjI,EAAU,CAMdkI,cAAU,EACVC,aAAa,EACbC,cAAc,EACd1G,cAAe,GAUfC,KAAKD,EAAgB,IACnB,IAAKS,KAAK+F,WAAa/F,KAAKiG,aAAc,CACxCjG,KAAKiG,cAAe,EAzB1B,SAA4B3F,GAC1BnB,IAAiB+G,oBAAoB5H,IAAE,gBAAgB6H,IAAI,GAAI7F,GAgC3D8F,CAPiBC,IACfrG,KAAKiG,cAAe,EACpBjG,KAAK+F,SAAWM,EACZrG,KAAKgG,aACPhG,KAAKN,SAKXM,KAAKT,cAAgBA,GAUvBG,OACMM,KAAK+F,UACP/F,KAAK+F,SAASrG,OACVM,KAAKT,cAAcG,MACrBM,KAAKT,cAAcG,QAGrBM,KAAKgG,aAAc,GAWvBpG,OACMI,KAAK+F,UACP/F,KAAK+F,SAASnG,OACVI,KAAKT,cAAcK,MACrBI,KAAKT,cAAcK,QAGrBI,KAAKgG,aAAc,GASvBM,QACEtG,KAAK+F,cAAL,EACA/F,KAAKiG,cAAe,EACpBjG,KAAKT,cAAgB;AAIV1B,a;;ACvFR,SAAS0I,EAAUC,GACxB,IAAIC,EAAQD,EACRE,EAAU;AAEd,OAAOC,IACW,OAAZD,IACFA,EAAUE,IAAMC,KAAK,uBAAwB,CAACC,IAAKL,IAAQM,KAAKC,IAC9DN,EAAU,KACVD,EAAQO,EAAKjG,KAAK0F,MACXA,KAIS,mBAATE,GACTD,EAAQK,KAAKJ,GAGRD,G;ACjBI,MAAMO,EAqBnBhF,YAAYiF,EAASC,EAAMrB,EAAOsB,GAAO,KAmJzCC,eACE,0FApJuC,KAsJzCC,iBAAmB,uDAtJsB,KAwJzCC,aAAe,iDAvJbvH,KAAKwH,QAAUN,EAAQM,QACvBxH,KAAKyH,WAAaN,EAAKO,wBACvB1H,KAAK2H,aAAeR,EAAKS,cACzB5H,KAAK6H,WAAaV,EAClBnH,KAAK8H,cAAgBhC,EACrB9F,KAAK+H,YAAcX,EAgBrBY,gBACE,MAAO,CACLC,SAAU,IAAF,OAAMjI,KAAK+H,aACnBG,QAASlI,KAAKkI,UACd,EAAEC,OAAOrK,IAAIC,sBAAwB,SAAU,SAC/C,EAAEoK,OAAOrK,IAAIC,sBAAwB,SAAS,EAC9CqK,eAAgBC,cAChBC,QAAS,oCAAF,OACLH,OAAOrK,IAAIC,qBACP,8EACA,YAHC,+CAKPwK,iBAAkB,CAChBC,kBAAmB,2DACnBC,kBAAmB,2DACnBC,kBAAmB,2DACnBC,qBAAsB,8DACtBC,2BACE,oEACFC,mBAAoB,6DAEtBC,eAAe,EACfC,cAAc,EAGdC,SAAS,EACTC,UAAU,EACVC,oBAAoB,EACpBC,QAAQ,EACRC,cAAe,mEAMfC,eACE,gzCAmBFC,wBACE,k3MAEFC,mBACE,yIAEFC,YAAarB,OAAOrK,IAAI2L,sDACxBC,oBAAoB,EACpBC,uBAAwBC,IACtBtL,EAAE,IAAD,OAAKsL,EAAGrL,KACN4B,SACAI,IAAI,aAAc,YAIvBsJ,oBAAqBC,KAAKC,kBAAoBD,KAAKC,gBAAgBC,iBAYvEC,mBACE,IAAIC,EAAY;AAChB,IAAK,IAAIpF,EAAM,EAAG9E,KAAK2H,cAAgB7C,EAAM9E,KAAK2H,aAAa5I,OAAQ+F,IACjE9E,KAAK2H,aAAa5I,QAAUiB,KAAKyH,YAAc3C,EAAM9E,KAAKyH,WAAa,EACzEyC,EAAY,GAAH,OAAMA,EAAN,wCAA+ClK,KAAK2H,aAAa7C,GAAKvG,IACrE2L,EAAUC,MAAM,uCAC1BD,GAAa;AAGjB,OAAOA,EAUTE,0BACE,IAAIC,EAAsB,0CAAH,OACrBlC,OAAOrK,IAAIC,qBAAuB,qBAAuB;AAc3D,OAZAsM,GAAuBrK,KAAKiK,mBAE1BjK,KAAK6H,YACL7H,KAAK6H,WAAWyC,oBAChBtK,KAAK6H,WAAWkC,kBACf/J,KAAK6H,WAAWkC,gBAAgBC,kBAEjCK,GAAuB,uBAIzBA,GADErK,KAAK6H,YAAc7H,KAAK6H,WAAW0C,eAAiB,uBAAyB,GAExEF,EAuBTG,eAAeH,GACb,MAAMI,EAAe,uCAAH,OAA0CJ;AAC5D,IAAIK,EAAW,GACXC,EAAW,GACXC,EAAW;AAYf,OAVI5K,KAAK8H,cAAgB,KAAO9H,KAAK8H,cAAgB,GACnD4C,EAAW1K,KAAKqH,eAChBsD,EAAW,GAAH,OAAM3K,KAAKsH,iBAAX,YAA+BmD,GACvCG,EAAW5K,KAAKuH,cACPvH,KAAK8H,cAAgB,MAC9B4C,EAAW,GAAH,OAAM1K,KAAKqH,eAAX,YAA6BrH,KAAKsH,kBAC1CqD,EAAW,GAAH,OAAMF,EAAN,YAAsBzK,KAAKuH,eAEnCmD,EAAW,GAAH,OAAM1K,KAAKqH,eAAX,YAA6BrH,KAAKsH,iBAAlC,YAAsDmD,EAAtD,YAAsEzK,KAAKuH,cAEjFY,OAAOrK,IAAIC,qBACN,CAAC2M,EAAUC,EAAUC,GAErB,CAACF,EAAUC,EAAUC,GAAUC,IAAIC,GAAKA,EAAEC,MAAM,KAAKpH,KAAK,MAYrEuE,UACE,MAAMmC,EAAsBrK,KAAKoK;AACjC,OAAOpK,KAAKwK,eAAeH,I;ACzMhBW,MAbf,SAAuBlF,EAAOvH,EAAIuB,EAAoBmL,EAA2B/D,GAC/E,MAAMgE,EAAe,IAAIjE,EAAaC,EAAS4C,IAAMhE,EAAOvH;AAK5D,sBACK2M,EAAalD,gBADlB,GCRa,SAAoCd,EAASiE,EAAWF,GACrE,GAAiC,MAA7BA,EACF,IAAIG,GAAoB;KAEpBA,EAAoBH;AAG1B,MAAO,CACLI,WAAYF,EACZG,MAAM1B,GACJ,MAAM2B,EAAUjN,IAAE,IAAMsL,EAAGrL;AAI3BqL,EAAG4B,GAAG,QAASC,IACbnN,IAAEoN,UAAU1K,QAAQ,cAAe,CAACyK,MAGtC7B,EAAG4B,GAAG,SAAU,KACdD,EAAQvK,QAAQ,YAIlB4I,EAAG4B,GAAG,gCAAiC,KACjCJ,GAAqBxB,EAAG+B,WAC1BJ,EAAQxK,KAAK,gBAAiB6I,EAAG+B,UAAUC,YAAY,MAItD9N,IAAIC,sBACP6L,EAAG4B,GAAG,OAAQ,KACOK;AAEnB,KAFmBA,EACoB7N,EAAQ,SADhBC,QAAU4N,EAAI5N,QAAU4N,GAE/BjC,GAAIvH,iBAIhCuH,EAAG4B,GAAG,OAAQ,KACZlN,IAAE6J,QAAQ2D,eAAe,UAQzBxN,IAAEsL,EAAGmC,iBAAiBC,KAAK,kBAAmBP,IAC5C,IACEQ,EADEvN,EAAS+M,EAAE/M;AAGO,IAApBA,EAAOwN,UACa,QAApBxN,EAAOyN,WACNF,EAAS3N,IAAEI,GAAQqC,KAAK,SAEzBzC,IAAEI,GAAQF,KAAK,MAAO0I,EAAQkF,aAAaC,gBAAgBC,WAAWL,MAapE,eAAgBrC,EAAG2C,eACvBjO,IAAEsL,EAAG2C,eAAeC,KAAKf,KAClB7B,EAAG6C,SAAW7C,EAAG8C,YAAYC,SAChC/C,EAAG8C,YAAYC,QAAS,EACxB/C,EAAG8C,YAAYE,aD7DtBC,CAA2B3F,OAJd,EAIkC+D,GAFpD,GAGMnL,EAAmBgN,aAAe,K;AEzB1C,OAAAlL,EAAA,GAAsBC,KAAKC,MAAM;;ICEd,YAAKC,OAAO,uB;ACwB/BzD,IAAEV,GAAGmP,aAAe,SAASC,GAC3B,GAAIhN,KAAKjB,OAAQ,CACf,IAAIkO,EAAO3O,IAAE;AACb,GACa,QAAX0O,GACW,UAAXA,GACAC,EAAKlM,KAAK,+BAAiCf,KAAK,GAGhD,YADAiN,EAAKC,SAASnM,KAAK,6BAA8B;AAG/CiM,EAAU1O,IAAEyB,OAAO,GAAIzB,IAAEV,GAAGmP,aAAaI,SAAUH;AAAvD,IACEI,EAAQH,EAAKI,SAAS;AACnBD,EAAMrO,SACTkO,EAAO3O,IACL,wFACA+G,SAAS,QACX/G,IAAEoN,UACC4B,UAAUlJ,IAEP6I,EAAKlM,KAAK,gCACTzC,IAAE8F,EAAM1F,QAAQ6O,QAAQ,8BAA8BxO,QAEvDkO,EAAKrN,OAAOmB,KAAK,6BAA8B,QAGlDyM,QAAQpJ,IAEL6I,EAAKlM,KAAK,gCACTzC,IAAE8F,EAAM1F,QAAQ6O,QAAQ,8BAA8BxO,SAEvDkO,EAAKrN,OACL6E,WAAW,KACTwI,EAAKlM,KAAK,6BAA8B,OACvC,QAGN6L,IAAI5M,MACJ4M,IAAIK,GACJQ,QAAQrJ,IACP,GAAI6I,EAAKlM,KAAK,8BAA+B,CAC3C,MAAM2M,EAAWT,EAAKrK,KAAK;AAC3B,GAAqB,IAAjBwB,EAAMuJ,QAcR,OAZID,EAAS3O,QAAU2O,EAASE,OAAO7O,OACrC2O,EACGG,YAAY,kCACZC,SAAS,WACTF,OACAE,SAAS,kBACTD,YAAY,WACZjL,KAAK,QACLxB,QAEH2M,MAAM3M,SAED;AACF,GAAqB,IAAjBgD,EAAMuJ,QAmBf,OAjBKD,EAAS3O,OAOH2O,EAASM,OAAOjP,QACzB2O,EACGG,YAAY,kCACZC,SAAS,WACTE,OACAF,SAAS,kBACTD,YAAY,WACZjL,KAAK,QACLxB,QAdH6L,EACGrK,KAAK,iBACLkL,SAAS,kBACTD,YAAY,WACZjL,KAAK,QACLxB,SAWE;AACF,GAAqB,IAAjBgD,EAAMuJ,SAAiBD,EAAS3O,OAEzC,OADA2O,EAASO,SACF;AAEPhB,EAAKrN,OAAOmB,KAAK,6BAA8B,SAIvDkM,EACGrK,KAAK,WACLiL,YAAY,kCACZC,SAAS,WACZb,EAAKgB,MAAM7J,IACT6I,EAAKrN,OAAOmB,KAAK,6BAA8B,QAEjDqM,EAAQH,EAAKI,SAAS,aAExBJ,EAAKlM,KAAK,6BAA8Bf,KAAK,IACzCgN,EAAQlH,OACVmH,EAAKnH,MAAMkH,EAAQlH,OAEjBkH,EAAQkB,QACVjB,EAAKrK,KAAK,SAASrC,IAAI,YAAayM,EAAQkB,QAE9Cd,EAAM1I,QACNpG,IAAE6P,KAAKnB,EAAQA,QAAS,CAACoB,EAAY9N,KACnC,MAAM+N,EAAU/P,IACd,uIAEE8P,EAFF,iBAKA/I,SAAS+H;AACX,SAASkB,IACPD,EACGlO,SACAyC,KAAK,cACLiL,YAAY,kCACZC,SAAS,WAEVxP,IAAEiQ,WAAWjO,GACf+N,EAAQP,SAAS,oBAAoB9B,KAAK,CACxCwC,aACEF,IACAD,EAAQP,SAAS,kBAAkBD,YAAY,YAEjDY,WAAYH,EACZhB,UAAUlJ,GACRA,EAAMC,iBACNiK,IACAD,EAAQP,SAAS,mBAAmBD,YAAY,YAElDL,QAASc,EACTL,MAAO3N,IAGT+N,EAAQP,SAAS,qBAAqB9B,KAAK,CACzCsB,UAAUlJ,GACRA,EAAMC;AAKd,MAAMqK,EAAS1O,KAAK0O,SAClBR,EAASlO,KAAK2O;AACN3O,KAAK4O;AAEf3B,EACG1M,IAAI,CACHsO,WAAY,SACZC,SAAU,WACVC,IAAKL,EAAOK,IAAMb,EAClBc,KAAMN,EAAOM,KAAO,EACpBC,MAAO,KAERrP,OACAF,OAGCuN,EAAKyB,SAASM,KAAO/B,EAAKnH,QAAUxH,IAAE6J,QAAQrC,SAChDmH,EAAK1M,IAAI,CAACyO,KAAM,GAAIC,MAAO,IAG/B,OAAOjP,MAET1B,IAAEV,GAAGmP,aAAaI,SAAW,CAACe,OAAQ,IAAKpI,MAAO;;ICjKnC,GAiBboJ,aAAaC,EAAQjN,GACnB,MAAMkN,EAAS,CACbpK,MAAOmK,EAAOE,KACdC,QAAS;AAiBX,OAfIxR,IAAIC,sBACNqR,EAAO7Q,GAAK4Q,EAAO5Q,GACnB6Q,EAAOG,SAAW,IAAMrN,EAAOsN,YAAP,mCAA+CL,EAAO5Q,KAC9E6Q,EAAOnK,YAAckK,EAAOlK,aAE5BmK,EAAOK,IAAP,mCAAyCN,EAAO5Q,IAG9C4Q,EAAOO,kBACTN,EAAOO,KAAP,mCAA0CR,EAAOO,mBAGjDN,EAAOQ,MAAQT,EAAOU,SAGjBT,GAsBTU,qBAAoB,CAACC,EAAgBnG,EAAIoG,IAChCD,EAAeE,OAAO,CAACC,EAAOf,KACnC,IAAIgB;AAaJ,OATEA,EADEhB,EAAOO,kBACH,aAAH,OAAgBxL,YAAWiL,EAAOO,mBAAlC,2BAAuEP,EAAO5Q,GAA9E,UAGG,aAAH,OAAgB2F,YAAWiL,EAAOU,UAAlC,2BAA8DV,EAAO5Q,GAArE,OAEL4R,GAAO,SAAJ,OAAajM,YAAWiL,EAAOE,OAClCa,EAAMC,GAAO,WACXH,EAAeb,EAAQvF,IAElBsG,GACN,IAiBLE,sBAAsB1R,EAAQ2R,EAASnO,GACrCxD,EAAOqO,aAAa,CAACC,QAASqD,IAC9BnO,EAAOsJ,GAAG,QAAS,KACjB9M,EAAOqO,aAAa,Y;AC3CXuD,MA9CQ,SAASpO,EAAQqO,GACtCvQ,KAAKzB,GAAK2D,EAAO3D,GACjByB,KAAKwQ,gBAAkBtO,EAAOyJ,UAAU8E,aACxCzQ,KAAK0Q,iBAAmB,CACtB/O,KAAMO,EAAOyJ,UAAUgF,UACvBC,MAAO1O,EAAOyJ,UAAUkF,UAE1B7Q,KAAKuQ,UAAYA,EASjBvQ,KAAK8Q,UAAY,WACf,YAAI,IAAA9Q,KAAKuQ,UACAvQ,KAAKuQ,UAEPjS,IAAE,IAAM0B,KAAKzB,KAetByB,KAAK+Q,WAAa,SAAS/N,EAAMsM,EAAS0B,GACxCxP,YAAKxB,KAAK8Q,YAAa,cAAe,CACpCpN,IAAKV,EACLsM,UACAkB,gBAAiBxQ,KAAKwQ,gBACtBS,eAAgBD,EAChBN,iBAAkB1Q,KAAK0Q,qB;;AC5Dd,MAAMQ,EACnBC,kBAAkB5S,EAAIW,GACpB,MAAM4H,EAAMhJ,IAAIsT,IACVC,EAAUvT,IAAIwT,sBACd5N,EAAM,KAAH,OAAQ2N,EAAR,qCAA4C9S;AACrDD,IAAEiT,KAAK,CACLC,QAAS,CAACC,cAAe,UAAF,OAAY3K,IACnCpD,QAECH,QAAQxC,IACHA,EAAKxC,KAAOA,GACdW,EAAG6B,EAAKiE,SAGXxB,MAAMkO,IACLxS,EAAG,KAAMwS,KAIfC,iBAAiBC,GACf,MAAMrT,EAAKD,IAAEuT,UAAUD,EAAMpT,KAAK;AAClCwB,KAAKmR,kBAAkB5S,EAAI,CAACuT,EAAUJ,KACpC,GAAIA,EAAK,CACPK,QAAQvO,MAAR,sDAA6DjF,EAA7D,MAAqEmT,EAAIM;AACzE,MAAMC,IAAeL,EAAMpT,KAAK,qBAAuB,GAAK;AAC5DoT,EAAMpT,KAAK,mBAAoByT,QAE/BL,EAAM5O,KAAK8O,GACXF,EAAMpT,KAAK,mBAAoBsT,MCjBvC,MAAMI,EAAuB,CAAC,2BAGxBC,EAAyB,CAAC,2BAE1BC,EAAqB,IAAIC;AAW/B,SAASC,EAAY5T,GACnB,MAAM6T,EAAM7T,EAAO6O,QAAQ,OAAO/O,KAAK;AACvC,MAAO,aAAe0F,YAAWqO,GAAO,MAe1C,SAASC,EAAoBtQ,GAE3B,OADAA,EAAOuQ,cACA,IAAInC,EAAepO,GAqB5B,SAASwQ,EAAiBC,EAAcC,GACtC,IAAItD,EAAUqD,EAAaE,QAAQ,+BAAgC;AAOnE,OANID,EAAKhQ,KAAK,6BAA6BpE,KAAK,aAC9C8Q,GAAW,cAETsD,EAAKhQ,KAAK,2BAA2BpE,KAAK,aAC5C8Q,GAAW,oBAENA,EA0BT,SAASwD,EAAeF,EAAMG,EAAgBC,EAAcrM,GAC1D,MAAMsM,EAAQL,EAAKhQ,KAAK;AACxBqQ,EAAMC,IAAI,UACVD,EAAMzH,GAAG,UAAU,SAASpH,GAC1BA,EAAMC,iBACND,EAAME;AACUsO,EAAK7R,KAAK;AAA1B,MACMiC,EAAO1E,IAAE0B,MACZ4C,KAAK,WACLgC,MACGuO,EAAMP,EAAKhQ,KAAK,gCAAgCgC,MAChD0K,EAAUoD,EAAiBM,EAAaI,OAAQR,GAChD5B,EAAY,CAAC,cAAemC;AAClCP,EAAKpN,OAAO,SACZuN,EAAehC,WAAW/N,EAAMsM,EAAS0B,GACzCrK,EAAKyM,UAiQT,SAASC,EAAYzJ,EAAI0J,GACvBD,EAAYE,QAAUF,EAAYE,SAAW,EAClC,GAAPD,GAAsC,GAAvBD,EAAYE,QAC7BF,EAAYE,SAAWF,EAAYE,QAAU,GAAK,EAElDjV,IAAEsL,EAAG7G,WACFH,KAAK,KACLuL,MAAK,WACJ,MAAMqF,EAAS,IAAItC,EACbU,EAAQtT,IAAE0B;AAChB,GACE4R,EAAMpT,KAAK,UACVoT,EAAM6B,SAAS,oBAChB7B,EAAMpT,KAAK,QAAQ2L,MAAML,KAAK4J,cAC9B,CACA,MAAMzB,GAAcL,EAAMpT,KAAK,qBAAuB;AACtDoT,EAAM9D,SAAS,uBACX8D,EAAM5O,SAAW4O,EAAMpT,KAAK,SAAWyT,EAAa,GACtDuB,EAAO7B,iBAAiBC,OAkDrB,OACbU,cACAE,sBACAE,mBACAI,iBACAa,aAtUF,SAAsB/J,GACpB,MAAMmJ,EAAiBP,EAAoB5I,GACrC2B,EAAUwH,EAAejC;AAC/B,IAAI8B,EAAOtU,IAAE;AACb,IAAIqU,EAAe;AAiBnB,GAhBAC,EACG/E,YAAY,sBACZjL,KAAK,wBACLhD,OACA6F,MACA7C,KAAK,cACLhD,OACA6F,MACA7C,KAAK,kBACLI,KAAK,eACLyC,MACA7C,KAAK,2BACLpE,KAAK,WAAW,GAChBiH,MACA7C,KAAK,6BACLpE,KAAK,WAAW,GACA,GAAfoU,EAAK7T,OAAa,CAChB6T,EAAOtU,IAAEoN,SAASkI,cAAc;AACpCvQ,YAAgB,mBAAmB,SAAStC,GAC1C,MAAMwK,EAAUqH,EAAK7R,KAAK,UACpB8S,EAAYvV,IAAE;AACpB,IAAIwV,EAASC;AACb,IAAK,MAAMjP,KAAO/D,EAEhB,GADA+S,EAAU/S,EAAK+D,GAAKkP,aAChBF,EAAS,CACXC,EAAWzV,IAAE,mDACbyV,EAASjG,SAASgG,EAAQA,SAC1BC,EAAShT,KAAK,UAAW+S,GACzBC,EAASvV,KAAK,QAAS,oBAAsBsV,EAAQA;AACrD,MAAMG,EAAO3V,IAAE;AACf2V,EAAKzV,KAAK,MAAO,WAAasV,EAAQA,QAAU,mBAChDC,EAAS9P,OAAOgQ,GAChBF,EAAS9F,OAAM,SAAS7J,GACtBA,EAAMC,iBACN/F,IAAE,4BAA4BkH,OAAO,SACrC1B,YAAmBxF,IAAE0B,MAAMe,KAAK,WAAW+S,QAAS/S,IAClDzC,IAAE,4BAA4BkH,OAAO,SACrChE,YAAK+J,EAAS,cAAe,CAC3BvG,MAAOjE,EAAKiE,MACZtB,IAAK3C,EAAK2C,IACV4L,QAASqD,SAIfkB,EAAU5P,OAAO8P,GACjBF,EAAU5P,OAAO,gBAGrB2O,EAAKhQ,KAAK,iCAAiCsR,MAAML,MAEnDjB,EACG3O,OACC,mcAEDA,OAAO,wDACPA,OACC,6JAEDA,OACC,uOAEDA,OACC,wOAGJ2O,EAAKhQ,KAAK,2BAA2BuR,QAAO,WACtC7V,IAAE0B,MAAMxB,KAAK,YACfoU,EAAKhQ,KAAK,6BAA6BpE,KAAK,WAAW,GAEzDoU,EACGhQ,KAAK,cACLwR,QAAQ9V,IAAE0B,MAAMxB,KAAK,YAAcoU,EAAKa,SAAS,wCAEtDb,EAAKhQ,KAAK,YAAY2C,SAAS,oBAAqB,QAASnB,IAC3D,MAAMmH,EAAUqH,EAAK7R,KAAK,UACpBpC,EAAUL,IAAE8F,EAAM1F;AACxB0F,EAAMC,iBACN7C,YAAK+J,EAAS,cAAe+G,EAAY3T,IACzCiU,EAAKpN,OAAO,WAGdoN,EAAKhQ,KAAK,YAAY2C,SAAS,sBAAuB,QAASnB,IAC7DA,EAAMC,iBACNuO,EAAKhQ,KAAK,iCAAiCkJ,eAAe,YAE5D8G,EAAKhQ,KAAK,yCAAyCoJ,KAAK,gBAAgB,WACtE,MAAMqI,EAAOzB,EAAKhQ,KAAK;AACvByR,EAAKzU,OACLtB,IAAE,qCAAqCoG;AACvC,MAAME,EAAMtG,IAAE0B,MAAM4E,MAGd7D,EAAO6R,EAAK7R,KAAK;AACvB,GAAKA,GAAQ6D,GAAO7D,EAAK2C,IAKvBkP,EACG0B,YAAY,qBAAsBvT,EAAKwT,oBACvCD,YAAY,mCAAoCvT,EAAKyT,kCACrD5R,KAAK,wBACLwR,OAAOrT,EAAKwT,oBACZ9O,MACA7C,KAAK,cACLwR,OAAOrT,EAAKyT,kCACf7B,EAAe5R,EAAK0T;IAbQ,CAC5B7B,EAAK/E,YAAY,sBAAsBA,YAAY;AACnD,MAAM6G,EAAK,IAAIC,OAAO,IAAMzC,EAAqBvO,KAAK,KAAO,IAAK;AAClEgP,EAAeA,EAAaE,QAAQ6B,EAAI,IAY1C,IAAIE,GAA0BhC,EAAKa,SAAS;AAC5C,MAAMoB,GAAkBjC,EAAKa,SAAS;AAEtC,GAAI7O,EAAIuF,MAAM,yBAA0B,EAClC8C,EAAO3O,IAAEoN,SAASkI,cAAc,SAC/BrT,IAAI,YAAa,WAClB0T,EAAO3V,IAAEoN,SAASkI,cAAc,SAC/BpV,KAAK,MAAOoG,GACjBqP,EAAKnG,SAAS,oBACdmG,EAAK1T,IAAI,SAAU;AACnB,MAAMuU,EAAM,IAAIC;AAChBD,EAAIvC,IAAM3N;AACV,IAAIoQ,EAAkB,WAChBF,EAAIG,UACFH,EAAI5G,OAAS,KAAQ4G,EAAI5G,OAAS,KAAO4G,EAAI5G,OAAS,MACxD+F,EAAK/F,OAAO4G,EAAI5G,QAGlBzJ,WAAWuQ,EAAiB;AAGhCvQ,WAAWuQ,EAAiB,KAC5Bf,EAAK/F,OAAO,KACZ+F,EAAKzV,KAAK,QAAS,4BACnByO,EAAKhJ,OAAOgQ,GACZ3V,IAAE,qCAAqC2F,OAAOgJ,QACzC,GAAIrI,EAAIuF,MAAML,KAAK4J,cAAe,CACvCW,EAAK3U;AACL,MAAMnB,EAAKD,IAAEuT,UAAUjN;AACvB,IAAIqI,EAUAgH,GAVAhH,EAAO3O,IAAEoN,SAASkI,cAAc,SAC/BrT,IAAI,YAAa,WAEnBqS,EAAKhQ,KAAK,2BAA2BpE,KAAK,YAC3CoU,EAAKa,SAAS,qCAEdb,EAAKhQ,KAAK,cAAclD,OAE1BkV,GAAyB,EACzBhC,EAAKhQ,KAAK,wBAAwBlD,QAC9BuU,EAAO3V,IAAEoN,SAASkI,cAAc,SAC/BpV,KAAK,MAAO,6BAA+BD,EAAK,UACrD0V,EAAK1T,IAAI,CACP2U,YAAa,IACbC,WAAY,sDACZjH,OAAQ,GACRkH,QAAS,iBAEXnB,EAAKzV,KAAK,MAAOoG,GACjBqP,EAAKnG,SAAS,sBACdmG,EAAK1T,IAAI,SAAU,WACnB0T,EAAKzV,KAAK,QAAS,gCACnByO,EAAKhJ,OAAOgQ,GACZ3V,IAAE,qCAAqC2F,OAAOgJ,GAE5C2H,IACFhC,EAAKhQ,KAAK,wBAAwBhD,OAClCgT,EAAKhQ,KAAK,2BAA2BpE,KAAK,WAAW,IAEnDqW,IACFjC,EAAKhQ,KAAK,cAAchD,OACxBgT,EAAKhQ,KAAK,6BAA6BpE,KAAK,WAAW,OAG3DoU,EAAKpU,KAAK,KAAM,2BAChBF,IAAE,QAAQ2F,OAAO2O,GAWnBE,EAAeF,EAAMG,GANA,WACnB,OAAOJ,KAEI,WACXU,EAAYzJ,GAAI,MAIlBgJ,EAAK7R,KAAK,SAAUwK,GACpBqH,EAAK7R,KAAK,gBAAiB;AAC3B,IAAI0K,EAAI7B,EAAG+B,UAAUgF;AACrB,KAAqB,KAAdlF,EAAEU,UAAiC,QAAdV,EAAEU,UAAsBV,EAAE4J,YACpD5J,EAAIA,EAAE4J;AAER,MAAMC,EAAmB,KAAd7J,EAAEU,SAAkB7N,IAAEmN,GAAK;AACtC,GAAI6J,EAAI,CACN1C,EACGhQ,KAAK,WACLgC,IAAI0Q,EAAG9W,KAAK,SACZ2V,SACHvB,EAAKhQ,KAAK,gCAAgCgC,IAAI0Q,EAAGvU,KAAK,gBACtD4R,GAAgB2C,EAAG9W,KAAK,UAAY,IAAIqU,QAAQ,sBAAuB;AACvE,IAAI6B,EAAK,IAAIC,OAAO,IAAMzC,EAAqBvO,KAAK,KAAO,MACtD2R,EAAG9W,KAAK,UAAY,IAAI2L,MAAMuK,IACjC9B,EACG9E,SAAS,sBACTlL,KAAK,wBACLlD;AAEDgV,EAAK,IAAIC,OAAO,IAAMxC,EAAuBxO,KAAK,KAAO,MACxD2R,EAAG9W,KAAK,UAAY,IAAI2L,MAAMuK,IACjC9B,EACG9E,SAAS,oCACTlL,KAAK,cACLlD,OAELkT,EAAK7R,KAAK,gBAAiB,CACzB2C,IAAK4R,EAAG9W,KAAK,QACb+V,mBAAoB3B,EAAKa,SAAS,sBAClCe,iCAAkC5B,EAAKa,SAAS,oCAChDgB,cAAe9B,EACf4C,YAAaD,EAAGvU,KAAK,iBAEvB6R,EACGhQ,KAAK,2BACLpE,KAAK,UAAW8W,EAAG7B,SAAS,oBAC5B3H,eAAe,UAClB8G,EACGhQ,KAAK,6BACLpE,KAAK,UAAW8W,EAAG7B,SAAS,cAC5B3H,eAAe,UAClB8G,EAAKhQ,KAAK,kBAAkBI,KAAK,oBAEjC4P,EACGhQ,KAAK,WACLgC,IAAI,IACJuP;AAELvB,EAAKpN,OAAO,CACVM,MAAO,IACPoI,OAAQ,OACRlJ,MAAO,sBACPY,OACEtH,IAAE0B,MACC4C,KAAK,WACLxB,QACAyE,aA+EPwN,cACAmC,WAlDF,SAAoB5L,GACdwI,EAAmBjM,IAAIyD,SAAO,IAAAA,EAAG4B,KAGrC5B,EAAG4B,GAAG,cAAc,SAASpH,GAC3B9F,IAAE8F,EAAMzC,MACLiB,KAAK,yBACLiL,YAAY,uBACfvP,IAAE8F,EAAMzC,MACLiB,KAAK,0BACLuL,MAAK,WACJ,MAAMsH,EAAUnX,IAAE0B,MACZ0V,EAASpX,IAAE,aACX4P,EAASuH,EAAQjX,KAAK,WAAaiX,EAAQlV,IAAI,UAC/CuF,EAAQ2P,EAAQhC,SAAS,aAC3B,OACAgC,EAAQjX,KAAK,UAAYiX,EAAQlV,IAAI;AAEzCkV,EAAQjX,KAAK,QAASsH,GACtB2P,EAAQlV,IAAI,QAASuF,GACrB4P,EAAOlX,KAAK,MAAOiX,EAAQjX,KAAK,QAChCkX,EAAOlX,KAAK,QAASiX,EAAQjX,KAAK,kBAC7BkX,EAAO,GAAGC,MAAMzH,OAAOnP,SAC1B2W,EAAOlX,KAAK,SAAU0P,GACtBwH,EAAOnV,IAAI,SAAU2N,IAElBwH,EAAO,GAAGC,MAAM7P,MAAM/G,SACzB2W,EAAOlX,KAAK,QAASsH,GACrB4P,EAAOnV,IAAI,QAASuF,IAEtBxH,IAAE0B,MAAMkU,MAAMwB,GACdpX,IAAE0B,MAAMkN,eAGdtD,EAAG4B,GAAG,SAAU,KACd6H,EAAYzJ,KAEdA,EAAG4B,GAAG,aAAc,KAClB6H,EAAYzJ,EAAI,oBAElBwI,EAAmBwD,IAAIhM,GAAI,M;AC/a7B,MAAMiM,EAAe,CACnB,0BACE,OAAO3R,YAAWrB,EAAKC,EAAE,sBAAuB;AAiGrCgT,MA7Fa,CAC1BtW,KAAKoK,EAAIlG,EAAKqS,GAEZ,GADAC,EAAMR,WAAW5L,IACZmM,IAAUA,EAAMnO,gBAAkBmO,EAAMnO,cAAc7I,OACzD;AAGF,IAAIyG,EAAS,CAEXI,KAAM,IAAIlF,IAAS+D,WAAW,IAAMe,EAAOI,QAAQlF,GAAO;AAE5D,+GAAwCqG,KAAK,EAAE9I,QAASgY,MACtD,MAAMC,EAAkBxK,SAASkI,cAAc;AAC/ClI,SAASyK,KAAKC,YAAYF,GAC1BG,IAASC,OACP,YAACL,EAAD,CACEM,IAAKpO,OACLjG,OAAQ0H,EACR4M,mBAAoB1Y,IAAI2Y,qBACxBC,iBAAkBA,cAClBC,qBAAsBrY,IAAE,iDAAiDE,KAAK,QAC9EoY,kBAAmB9Y,IAAI+Y,mCAEzBX,GACA,WACE1Q,EAASxF;AAKf,MAAM+P,EAAiB,GACjB+G,EAAa;AACnB,IAAK,IAAIhS,EAAM,EAAGiR,EAAMnO,eAAiB9C,EAAMiR,EAAMnO,cAAc7I,OAAQ+F,IAAO,CAChF,MAAMiS,EAAiBhB,EAAMnO,cAAc9C,GAErCkS,EAAa,IAAMxR,EAAOI,KAAKmR;AACjCjZ,IAAIC,sBACN+Y,EAAWG,KAAKC,EAAoBhI,aAAa6H,EAAgBnN,IACjEA,EAAGuN,WAAH,mCAA0CJ,EAAexY,IAAMyY,IAE/DjB,EAAMnO,cAAc7I,OAASgX,EAAMrO,yBACnC5C,GAAOiR,EAAMrO,wBAA0B,EAEvCqI,EAAekH,KAAKF,IAEpBnN,EAAGuN,WAAH,mCAA0CJ,EAAexY,IAAMyY,GAC/DpN,EAAGwN,UAAH,sCACiCL,EAAexY,IAC9C2Y,EAAoBhI,aAAa6H,EAAgBnN,KAcvD,GAVIkN,EAAW/X,QAAUjB,IAAIC,sBAC3B6L,EAAGyN,GAAGC,SAASF,UAAU,oBAAqB,CAC5C7H,SAAU,KACR,MAAMgI,EAAK,IAAIC,YAAY,0BAA2B,CAACC,OAAQ,CAACX;AAChEpL,SAASgM,cAAcH,IAEzB5H,KAAM,MACNgI,QAAS,SAGT5H,EAAehR,OAAQ,CACzB,MAAM6Y,EAAc,WAClB,MAAM1H,EAAQgH,EAAoBpH,qBAAqBC,EAAgBnG,EAAIuF,GACzE3J,EAAOI,KAAKuJ;AAEd+H,EAAoB9G,sBAAsB9R,IAAE,IAAD,OAAK0B,KAAK6X,MAAQ3H,EAAOtG;AAGlE9L,IAAIC,qBACN6L,EAAGyN,GAAGC,SAASF,UAAU,oCAAqC,CAC5DpS,MAAO6Q,EAAaiC,oBACpBlI,MAAO,uBACPL,SAAUqI,IAGZhO,EAAGwN,UAAU,oCAAqC,CAChDpS,MAAO6Q,EAAaiC,oBACpBlI,MAAO,uBACPmI,QAAQ3T,GACgB,KAAlBA,EAAMuJ,SAAoC,KAAlBvJ,EAAMuJ,UAChCvJ,EAAME,kBACNsT,EAAYxE,KAAKpT,QAGrBgY,QAASJ;ACrGnB,MAAMK,EAAmB,CACvB7E,KAAK7R,KAAeb,GAIlB,MAAmB,YAAfa,GAGGvB,KAAKuB,MAAeb,IAG7BU,QACE,QAAgB,IAAZ8F,QAAuB,CACzB,MAAMhF,EAASgF,QAAQf,IAAInG,KAAKkY,YAAY3Z;AAC5C2D,GAAUA,EAAOd,OAAM,MAKvB+W,EAAoB,CACxBzY,OAEEpB,EAAE,gBAAgBoB,QAGpBE,OAEEtB,EAAE,gBAAgBsB;AAgBPwY,MAZE,CACfC,WAAWnW,GACT,MAAMoW,EAAa,eAAIL,EAAP,GAA4B/V;AAC5C,OAAOqW,OAAOC,OAAOtW,EAAQoW,IAG/BG,YAAYpS,GACV,MAAMiS,EAAa,eAAIH,EAAP,GAA6B9R;AAC7C,OAAOkS,OAAOC,OAAOnS,EAASiS,K;ACZlC,SAASI,IACP,IAAK5a,IAAI2Y,qBACP,OAAO;AAET,IAAIkC,EAAaC;AACjB,MAAMC,EAAS/a,IAAIgb;AAKnB,GAAIhb,IAAIC,uBAAyBD,IAAIib,8BACnCH,EAAYC,EACZF,EAAc;IACT,OACuBK,YAAiBlb,IAAI2Y,sBAAsB,GADlE;AACHkC,EADG,KACUC,EADV,KAIP,MAAO,CACLK,eAAgBnb,IAAIib,8BACpBG,kBAAmB,CAACP,cAAaC,YAAWC,UAC5CF,cACAC,YACAO,iBAAkBrb,IAAIsb,gCACtBC,KAAMvb,IAAIwT,sBACVxK,IAAKhJ,IAAIsT,IACTkI,aAAcA,EAAaxb,IAAIsT,KAC/BmI,SAAUzb,IAAI0b,6BACdC,WAAY,IAAM/N,SAASgO,eAAe,8BAI9C,IAAIC;AAEJ,MAAMC,EAAY,CAChBxa,QAAQF,IAEJiJ,OAAO0R,qBAAuB1R,OAAO1D,YAAY,IAAMzE,KAAK8Z,QAAQ5a,KAGxE0B,aAAalC,EAAQoB,EAAoBQ,GAAU;AACjD,MAAMO,EAAWb,KAAK+Z,kBAAkBrb,GAClCsb,EAAkBha,KAAKia,mBAAmBpZ,EAAUf,EAAmBma,oBACvEC,EAAcla,KAAKma,eAAetZ,EAAUf,IAElD,UAAIhC,WAAJ,iBAAI,EAAKsc,gBAAT,aAAI,EAAeC,yBAKjBra,KAAK8Z,QAAQQ,IACXA,EAAIC,cAAcP,EAAiBE,EAAaM,iBApExDA,eAA+B1Z,GAE7B,OAAO,IAAI2Z,QAAQ,CAACC,EAASC,KAC3B,IAAI/Q,EAAK9I,EAAa8Z;AACtB,GAAIhR,EACF8Q,EAAQ9Q;IACH,CACL,MAAMiR,EAAMC,YAAY,KACtBlR,EAAK9I,EAAa8Z,cACdhR,IACFmR,cAAcF,GACdH,EAAQ9Q,KAET,QAwDsBoR,CAAgBla,IAC9B0K,GAAG,OAAQ,IAAMlL,EAASO,EAAUuX,EAASC,WAAWvX,SAInEd,KAAK8Z,QAAQQ,IACXA,EAAIC,cAAcP,EAAiBE,EAAapZ,IAC9CA,EACG8Z,cACApP,GAAG,OAAQ,IAAMlL,EAASO,EAAUuX,EAASC,WAAWvX,UAMnEoF,oBAAoBxH,EAAQ4B,GAC1B,GAAIxC,IAAImd,0BACN;AAGF,MAAMC,EAAQxC;AAEd1Y,KAAK8Z,QAAQQ,IACXA,EAAIa,qBAAqBzc,EAAQwc,EAAOE,IACtC9a,EAAS8X,EAASK,YAAY2C,SAWpCC,iBAAkB,GAClBf,IAAK,KASLR,QAAQ5a,EAAK,UAaX,OAZKya,IACHA,GAAkBxR,OAAOrK,IAAIC,qBACzB,wQACA,oKAGFgJ,KAAKuT,IACLta,KAAKsa,IAAMA,EChIJ,SAA4BgB,EAAY,IAC9B,CACrB,aACA,UACA,gBACA,YACA,iBACA,YAGaC,QAAQC,SACjB,IAAAF,EAAUE,KACZF,EAAUE,GAAU,gBAMxB9P,SAAS+P,iBAAiB,uBAAwB,EAAEhE,aAClD,yDAAoD1Q,KAAK,EAAE9I,QAASyd,MAClE,MAAMC,EAAO,IAAID,EAAmBjE,EAAO7N;AAC3C0R,EAAUM,WAAWD,OAIzBjQ,SAAS+P,iBAAiB,oBAAqB,EAAEhE,aAC/CzB,EAAMrC,aAAa8D,EAAO7N,IAC1B0R,EAAUO,YAGZnQ,SAAS+P,iBAAiB,0BAA2BhQ,IACnD,qHAAuD1E,KACrD,EAAE9I,QAAS6d,MACT,MAAMH,EAAO,IAAIG,EAAsBrQ,EAAEgM,OAAO7N,GAAI6B,EAAEgM,OAAOsE;AAC7DT,EAAUU,cAAcL,OAK9BjQ,SAAS+P,iBAAiB,sBAAuBhQ,IAC/C,mCAAgE1E,KAC9D,EAAE9I,QAASge,MACTA,EAAkBxQ,EAAEgM,OAAO7N,IAC3B0R,EAAUY,gBAKhBxQ,SAAS+P,iBAAiB,4BAA6BhQ,IACrD0Q,EAAwB3c,KAAKiM,EAAEgM,OAAO7N,GAAI6B,EAAEgM,OAAO/T,IAAKoG,KACxDwR,EAAUc,mBAGZ1Q,SAAS+P,iBAAiB,qBAAsBhQ,IAC9C,0DAA+D1E,KAC7D,EAAE9I,QAASoe,MACTA,EAAkBC,aAAa7Q,EAAEgM,OAAO7N,IACxC0R,EAAUiB,eDwEVC,GACOlC,KAGJX,EAAe5S,KAAK,KACzB/G,KAAKqb,iBAAiBE,QAAQkB,GAAmBA,EAAgBzc,KAAKsa,MACtEta,KAAKqb,iBAAmB,GACxBnc,EAAGc,KAAKsa,QAaZP,kBAAkB2C,GACwB,aAAjCpe,IAAEoe,GAAevW,IAAI,GAAGwW,KAC3Bre,IAAEoe,GAAevW,IAAI,GACrB7H,IAAEoe,GACC9Z,KAAK,YACLuD,IAAI,GAWb8T,mBAAmBpZ,EAAU+b,GAC3B,IAAI5C;AAWJ,OAREA,OADyB,IAAhB4C,EACSte,IAAEuC,GACjBV,SACAgG,IAAI,GAEWyW,EAAY/b,GAEhCvC,IAAE0b,GAAiBlM,SAAS,wBAErBkM,GAWT6C,eAAehc,GACb,MACMic,EAAQC,IAAE9M,OACdpP,EAASmc,WACT,CAACC,EAAMze,KACLye,EAAKze,EAAK6Q,MAAQ7Q,EAAK0e,MAChBD,GAET;AAGF,OAAOF,IAAEI,KAAKL,EAVK,CAAC,UAqBtB3C,eAAetZ,EAAUf,GACvB,MAAMgG,EAAQjF,EAASuc,YACjBlP,EAASrN,EAASwc;AAEpBnP,IACFpO,EAAmBgN,YAAnB,aACEoB,UACIpO,EAAmBgN,aAAe;AAI1C,MAAMwQ,EAAaxf,IAAIyf,OACjBC,EAAYjF,OAAOkF,KAAKC,KAC3B7S,IAAI8S,IACI,CAACpf,GAAIof,EAAQC,MAAOF,IAAuBC,MAEnDE,KAAK,CAACC,EAAGhT,IACJgT,EAAEvf,KAAO+e,GACH,EACCxS,EAAEvM,KAAO+e,EACX,EAEAQ,EAAEF,MAAMG,cAAcjT,EAAE8S,MAAON,IAMtCU,EAAW,CACfC,QAASngB,IAAIC,sBAAwBD,IAAIogB,cACzCC,yBAA0BC,OAAOC,MAAMvgB,IAAIqgB,0BACvC,KACArgB,IAAIqgB;AAGV,MAAO,CACLG,eAAgBzd,EAASqc,OAASpd,EAAmBwe,eACrDtT,cAAeA,EAAcgB,KAAK,KAAMlG,EAAOjF,EAAStC,GAAIuB,EAAoB,MAChFye,SAAUzgB,IAAIyf,OACdiB,cAAexe,KAAK6c,eAAehc,GACnCJ,QAASX,EAAmBW,QAC5Bge,OAAQ3e,EAAmB2e,OAC3BC,kBAAmB7d,EAAS8d,UAC5BC,WAAY/d,EAAStC,GACrBsgB,UAAWnG,IACX8E,YACAQ;AAKSpE","file":"20-c-34a145dfde.js","sourcesContent":["/*\n * Copyright (C) 2017 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * This will log a single deprecation notice when NODE_ENV isn't `production`.\n *\n * @param {string} message The deprecation message to log to the console. Say what should be used instead here.\n * @param {string} obj the object to deprecate `method` on\n * @param {string} method The method on `obj` to deprecate\n * @return {function} The function that will warn once and then call `fn`\n * There are 3 ways you can use this:\n * @example\n * // Most basic usage, just logs supplied deprecation message\n * $.somethingOld = deprecated(\"use '@instructure/ui-something-better' instead\", () => { ...})\n * @example\n * // Will log a more helpful deprecation method than the first example because\n * // it will tell you the host object and name of the method that is deprecated.\n * deprecated(\"use '@instructure/ui-something-better' instead\", $, 'somethingOld', () => { ...} )\n * @example\n * // if you want to mark a method defined somewhere else (like a lib you don't control) as deprecated\n * deprecated(\"use '@instructure/ui-something-better' instead\", $, 'somethingOld')\n */\nexport default function deprecated(message, obj, method, fn) {\n  const isBareFn = !method\n  const originalFn = isBareFn ? obj : typeof fn === 'function' ? fn : obj[method]\n  if (process.env.NODE_ENV !== 'production') {\n    let warned = false\n    const newFn = Object.assign(function() {\n      if (!warned && console) {\n        const warningArgs = isBareFn\n          ? [originalFn]\n          : [obj && obj.name ? obj.name : obj, `.${method} (aka: `, originalFn, ')']\n        console.warn(...warningArgs, 'is deprecated.', message)\n      }\n      warned = true\n      return originalFn.apply(this, arguments)\n    }, originalFn)\n\n    if (!isBareFn) obj[method] = newFn\n    return newFn\n  }\n  return originalFn\n}\n","/*\n * Copyright (C) 2016 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport serviceRCELoader from './serviceRCELoader'\nimport {RCELOADED_EVENT_NAME, send, destroy, focus} from './RceCommandShim'\nimport deprecated from '../helpers/deprecated'\nimport $ from 'jquery'\n\nconst Sidebar = !ENV.use_rce_enhancements && require('../rce/Sidebar').default\n\nfunction loadServiceRCE(target, tinyMCEInitOptions, callback) {\n  target.css('display', 'none')\n\n  const originalOnFocus = tinyMCEInitOptions.onFocus\n\n  tinyMCEInitOptions.onFocus = (...args) => {\n    if (!ENV.use_rce_enhancements) RichContentEditor.showSidebar()\n    if (originalOnFocus instanceof Function) {\n      originalOnFocus(...args)\n    }\n  }\n\n  serviceRCELoader.loadOnTarget(target, tinyMCEInitOptions, (textarea, remoteEditor) => {\n    const $target = node2jquery(target)\n    const $textarea = freshNode($(textarea))\n    $textarea.data('remoteEditor', remoteEditor)\n    $target.trigger(RCELOADED_EVENT_NAME, remoteEditor)\n    if (callback) {\n      callback(remoteEditor)\n    }\n  })\n}\n\nfunction establishParentNode(target) {\n  const $target = node2jquery(target)\n  // some areas would wipe out the whole form\n  // if we rendered a new editor into the textarea parent\n  // element, so this is some helper functionality to create/reuse\n  // a parent element if that's the case\n  const targetId = $target.attr('id')\n  // xsslint safeString.identifier targetId parentId\n  const parentId = `tinymce-parent-of-${targetId}`\n  if ($target.parent().attr('id') === parentId) {\n    // parent wrapper already exits\n  } else {\n    return $target.wrap(`<div id='${parentId}' style='visibility: hidden'></div>`)\n  }\n}\n\nfunction hideResizeHandleForScreenReaders() {\n  $('.mce-resizehandle').attr('aria-hidden', true)\n}\n\n// Returns a unique id\nlet _editorUid = 0\nfunction nextID() {\n  return `random_editor_id_${_editorUid++}`\n}\n\n/**\n * Make sure each the element has an id. If it\n * doesn't, give it a random one.\n * @private\n */\nfunction ensureID(el) {\n  const $el = $(el)\n  const id = 'attr' in $el ? $el.attr('id') : $el.id\n  if (!id || id == '') {\n    $el.attr('id', nextID())\n  }\n}\n\n/**\n * we need to make sure we have the latest node in order to capture any\n * changes, lots of views like to use stale nodes\n *\n * @private\n */\nfunction freshNode(target) {\n  const $target = node2jquery(target)\n  // Try to get the id\n  const targetId = $target.attr('id')\n  if (!targetId || targetId == '') {\n    return $target\n  }\n  // Try to get the element on the DOM\n  const newTarget = $(`#${targetId}`)\n  if (newTarget.length <= 0) {\n    return $target\n  }\n  return newTarget\n}\n\nconst deprecationMsg =\n  \"with the new RCE you don't need to call this method, it is a no op since there is no sidebar\"\n\nconst RichContentEditor = {\n  /**\n   * start the remote module (if the feature flag is on) loading so that it's\n   * hopefully done by the time initSidebar and loadNewEditor are called.\n   * should typically be called at the top of any source file that calls one\n   * of those.\n   *\n   * @public\n   */\n  preloadRemoteModule(cb = () => {}) {\n    return serviceRCELoader.preload(cb)\n  },\n\n  /**\n   * load the sidebar. can pass callbacks to execute any time the sidebar is\n   * shown (`show`) or hidden (`hide`).\n   *\n   * @public\n   */\n  initSidebar: deprecated(deprecationMsg, (subscriptions = {}) => {\n    if (!ENV.use_rce_enhancements) Sidebar.init(subscriptions)\n  }),\n\n  /**\n   * show the sidebar if it's around\n   *\n   * @public\n   */\n\n  showSidebar: deprecated(deprecationMsg, () => {\n    if (!ENV.use_rce_enhancements) Sidebar.show()\n  }),\n\n  /**\n   * hide the sidebar if it's around\n   *\n   * @public\n   */\n\n  hideSidebar: deprecated(deprecationMsg, () => {\n    if (!ENV.use_rce_enhancements) Sidebar.hide()\n  }),\n\n  /**\n   * load an editor into the target element with the given options. most\n   * options are passed on to tinymce, but locally:\n   *\n   *   focus (boolean)\n   *     claim the new editor as active immediately after it's loaded\n   *     (including showing the sidebar if any)\n   *\n   *   manageParent (boolean)\n   *     ensure the target element has a containing div that doesn't contain\n   *     the element's siblings, so when the RCE is rendered into the\n   *     container it doesn't wipe out other parts of the DOM\n   *\n   * @public\n   */\n  loadNewEditor(target, tinyMCEInitOptions = {}, cb) {\n    let $target = node2jquery(target)\n    if ($target.length <= 0) {\n      // no actual target, just short circuit out\n      return\n    }\n\n    ensureID($target)\n\n    // avoid modifying the original options object provided\n    tinyMCEInitOptions = $.extend({}, tinyMCEInitOptions)\n\n    const callback = rce => {\n      if (tinyMCEInitOptions.focus) {\n        // call activateRCE once loaded\n        this.activateRCE($target)\n      }\n      if (cb) {\n        cb(rce)\n      }\n    }\n\n    $target = this.freshNode($target)\n\n    if (tinyMCEInitOptions.manageParent) {\n      delete tinyMCEInitOptions.manageParent\n      establishParentNode($target)\n    }\n\n    loadServiceRCE($target, tinyMCEInitOptions, callback)\n\n    hideResizeHandleForScreenReaders()\n  },\n\n  /**\n   * call a function on the target editor.\n   *\n   * @public\n   */\n  callOnRCE(target, methodName, ...args) {\n    let $target = node2jquery(target)\n    $target = this.freshNode($target)\n    return send($target, methodName, ...args)\n  },\n\n  /**\n   * remove the target editor. if there's a sidebar, hide it\n   *\n   * @public\n   */\n  destroyRCE(target) {\n    let $target = node2jquery(target)\n    $target = this.freshNode($target)\n    destroy($target)\n    if (!ENV.use_rce_enhancements) Sidebar.hide()\n  },\n\n  /**\n   * make the target the active editor, including to be recipient of sidebar\n   * events. if there's a sidebar, make sure it's showing\n   *\n   * @private\n   */\n  activateRCE(target) {\n    let $target = node2jquery(target)\n    $target = this.freshNode($target)\n    focus($target)\n    if (!ENV.use_rce_enhancements) Sidebar.show()\n  },\n\n  freshNode,\n  ensureID\n}\n\n// while the internals work with jquery, let's not\n// require that of our consumer\nfunction node2jquery(node) {\n  return node.length ? node : $(node)\n}\n\nexport default RichContentEditor\n","// this file was auto-generated by rake i18n:generate_js.\n// you probably shouldn't edit it directly\nimport mergeI18nTranslations from 'mergeI18nTranslations';\n\n// we use JSON.parse here instead of just loading it as a javascript object literal\n// because according to https://v8.dev/blog/cost-of-javascript-2019#json that is faster\nmergeI18nTranslations(JSON.parse(\"{\\\"ar\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"لون الخلفية، اضغط لأسفل للتحديد\\\",\\\"forecolor\\\":\\\"لون النص، اضغط لأسفل للتحديد\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"حجم الخط، اضغط لأسفل للتحديد\\\",\\\"formatting\\\":\\\"التنسيق، اضغط لأسفل للتحديد\\\",\\\"rte_help\\\":\\\"منطقة نص منسق. اضغط على ALT+F8 للمساعدة\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Rich Content Editor\\\"},\\\"cy\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Lliw'r Cefndir, pwyswch i lawr i ddewis\\\",\\\"forecolor\\\":\\\"Lliw'r Testun, pwyswch i lawr i ddewis\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Maint y Ffont, pwyswch i lawr i ddewis\\\",\\\"formatting\\\":\\\"Fformat, pwyswch i lawr i ddewis\\\",\\\"rte_help\\\":\\\"Ardal Testun Cyfoethog. Pwyswch ALT+F8 i gael help\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Golygydd Cynnwys Cyfoethog\\\"},\\\"da\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Baggrundsfarve, tryk ned for at vælge\\\",\\\"forecolor\\\":\\\"Tekstfarve, tryk ned for at vælge\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Skriftstørrelse, tryk ned for at vælge\\\",\\\"formatting\\\":\\\"Formatering, tryk ned for at vælge\\\",\\\"rte_help\\\":\\\"Område med RTF. Tryk på ALT+F8 for hjælp\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Rich Content Editor\\\"},\\\"da-x-k12\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Baggrundsfarve, tryk ned for at vælge\\\",\\\"forecolor\\\":\\\"Tekstfarve, tryk ned for at vælge\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Skriftstørrelse, tryk ned for at vælge\\\",\\\"formatting\\\":\\\"Formatering, tryk ned for at vælge\\\",\\\"rte_help\\\":\\\"Område med RTF. Tryk på ALT+F8 for hjælp\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Rich Content Editor\\\"},\\\"de\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Hintergrundfarbe, zum Auswählen Pfeil-nach-unten drücken\\\",\\\"forecolor\\\":\\\"Textfarbe, zum Auswahlen Pfeil-nach-unten drücken\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Schriftgröße, zum Auswählen Pfeil-nach-unten drücken\\\",\\\"formatting\\\":\\\"Formatierung, zum Auswählen Pfeil-nach-unten drücken\\\",\\\"rte_help\\\":\\\"Rich Text-Bereich. Für Hilfe \\\\u003cAlt\\\\u003e+F8 drücken\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Rich-Content-Editor\\\"},\\\"el\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Χρώμα Φόντου, πιέστε για επιλογή\\\",\\\"forecolor\\\":\\\"Χρώμα Κειμένου, πιέστε για επιλογή\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Μέγεθος Γραμματοσειράς, πιέστε για επιλογή\\\",\\\"formatting\\\":\\\"Μορφοποίηση, πατήστε κάτω για επιλογή\\\",\\\"rte_help\\\":\\\"\\\\u003cmrk mid=\\\\\\\"6144\\\\\\\" mtype=\\\\\\\"seg\\\\\\\"\\\\u003eΠεριοχή Rich Text.\\\\u003c/mrk\\\\u003e \\\\u003cmrk mid=\\\\\\\"6145\\\\\\\" mtype=\\\\\\\"seg\\\\\\\"\\\\u003eΠατήστε ALT+F8 για βοήθεια\\\\u003c/mrk\\\\u003e\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Επεξεργαστής Πλούσιου Περιεχομένου-rich content\\\"},\\\"en-AU\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Background Colour, press down to select\\\",\\\"forecolor\\\":\\\"Text Colour, press down to select\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Font Size, press down to select\\\",\\\"formatting\\\":\\\"Formatting, press down to select\\\",\\\"rte_help\\\":\\\"Rich Text Area. Press ALT+F8 for help.\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Rich Content Editor\\\"},\\\"en-CA\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Background Color, press down to select\\\",\\\"forecolor\\\":\\\"Text Color, press down to select\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Font Size, press down to select\\\",\\\"formatting\\\":\\\"Formatting, press down to select\\\",\\\"rte_help\\\":\\\"Rich Text Area. Press ALT+F8 for help\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Rich Content Editor\\\"},\\\"en-GB\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Background colour. Press down to select\\\",\\\"forecolor\\\":\\\"Text colour. Press down to select\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Font size. Press down to select\\\",\\\"formatting\\\":\\\"Formatting. Press down to select\\\",\\\"rte_help\\\":\\\"Rich Text Area. Press ALT+F8 for help\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Rich Content Editor\\\"},\\\"es\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Color de fondo, pulse abajo para seleccionar\\\",\\\"forecolor\\\":\\\"Color de texto, pulse abajo para seleccionar\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Tamaño del texto, pulse abajo para seleccionar\\\",\\\"formatting\\\":\\\"Formato, pulse abajo para seleccionar\\\",\\\"rte_help\\\":\\\"Área del texto enriquecido. Presione ALT+F8 para ayuda\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Editor de contenido enriquecido\\\"},\\\"fa\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"رنگ پس زمینه، کلید down را برای انتخاب فشار دهید\\\",\\\"forecolor\\\":\\\"رنگ متن، کلید down را برای انتخاب فشار دهید\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"اندازه قلم، کلید down را برای انتخاب فشار دهید\\\",\\\"formatting\\\":\\\"در حال قالب بندی، کلید down را برای انتخاب فشار دهید\\\",\\\"rte_help\\\":\\\"قسمت دارای متن غنی. ALT+F8 را برای راهنمایی فشار دهید.\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"ویرایشگر محتوای غنی\\\"},\\\"fi\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Taustaväri, valitse painamalla alas\\\",\\\"forecolor\\\":\\\"Tekstin väri, valitse painamalla alas\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Fontin koko, valitse painamalla alas\\\",\\\"formatting\\\":\\\"Muotoilu, valitse painamalla alas\\\",\\\"rte_help\\\":\\\"RTF-muoto Ohjeet painamalla ALT+F8\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Rikas sisältöeditori\\\"},\\\"fr\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Couleur de fond. Appuyez pour sélectionner.\\\",\\\"forecolor\\\":\\\"Couleur du texte. Appuyez pour sélectionner.\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Taille du texte. Appuyez pour sélectionner.\\\",\\\"formatting\\\":\\\"Mise en forme. Appuyez pour sélectionner.\\\",\\\"rte_help\\\":\\\"Zone de texte enrichi. Presser ALT+F8 pour obtenir de l'aide\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Éditeur de texte enrichi\\\"},\\\"fr-CA\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Couleur de fond. Appuyez pour sélectionner.\\\",\\\"forecolor\\\":\\\"Couleur du texte. Appuyez pour sélectionner.\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Taille du texte. Appuyez pour sélectionner.\\\",\\\"formatting\\\":\\\"Mise en forme. Appuyez pour sélectionner.\\\",\\\"rte_help\\\":\\\"Zone de texte enrichi. Presser ALT+F8 pour obtenir de l'aide\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Éditeur de texte enrichi\\\"},\\\"he\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"צבע רקע, יש להקיש כדי לבחור\\\",\\\"forecolor\\\":\\\"צבע טקסט, יש להקיש כדי לבחור\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"גודל אות, יש להקיש כדי לבחור\\\",\\\"formatting\\\":\\\"עיצוב, יש להקיש כדי לבחור\\\",\\\"rte_help\\\":\\\"איזור תוכן עשיר. יש להקיש ALT+F8 לעזרה\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"עורך תוכן עשיר\\\"},\\\"ht\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Koulè Fon, peze anba pou ka seleksyone\\\",\\\"forecolor\\\":\\\"Koulè Tèks, peze anba pou ka seleksyone\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Gwosè Tèks, peze anba pou ka seleksyone\\\",\\\"formatting\\\":\\\"Fòmataj, peze anba pou ka seleksyone\\\",\\\"rte_help\\\":\\\"Zòn Tèks Rich. Peze ALT+F8 pou èd\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Editè Kontni Rich\\\"},\\\"hu\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Háttérszín, nyomja le a kiválasztáshoz\\\",\\\"forecolor\\\":\\\"Szövegszín, nyomja le a kiválasztáshoz\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Betűméret, nyomja le a kiválasztáshoz\\\",\\\"formatting\\\":\\\"Formázás, nyomja le a kiválasztáshoz\\\",\\\"rte_help\\\":\\\"Vizuális szövegterület, nyomja le az ALT+F8-at a segítséghez\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Vizuális szövegszerkesztő\\\"},\\\"hy\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Ֆոնի գույն, ընտրելու համար սեղմեք ներքև\\\",\\\"forecolor\\\":\\\"Տեքստի գույն, ընտրելու համար սեղմեք ներքև\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Տառերի չափ, ընտրելու համար սեղմեք ներքև\\\",\\\"formatting\\\":\\\"Ֆորմատավորում, ընտրելու համար սեղմեք ներքև\\\",\\\"rte_help\\\":\\\"Ֆորմատավորված տեքստի դաշտ, տեղեկությունների համար սեղմել ALT+F8 \\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Ֆորմատավորված տեքստի խմբագիր\\\"},\\\"is\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Bakgrunnslitur, ýttu á niðurör til að velja\\\",\\\"forecolor\\\":\\\"Textalitur, ýttu á niðurör til að velja\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Stafastærð, ýttu á niðurör til að velja\\\",\\\"formatting\\\":\\\"Forsníð, ýttu á niðurör til að velja\\\",\\\"rte_help\\\":\\\"Mótað textasvæði. Ýttu á ALT+F8 til að fá hjálp\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Rich Content ritill\\\"},\\\"it\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Colore sfondo, premi per selezionare\\\",\\\"forecolor\\\":\\\"Colore testo, premi per selezionare\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Dimensioni carattere, premi per selezionare\\\",\\\"formatting\\\":\\\"Formattazione, premi per selezionare\\\",\\\"rte_help\\\":\\\"Area di testo RTF. Premi ALT+F8 per la Guida\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Editor di contenuti avanzati\\\"},\\\"ja\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"背景色、押して選択\\\",\\\"forecolor\\\":\\\"テキスト色、押して選択\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"フォント サイズ、押して選択\\\",\\\"formatting\\\":\\\"書式設定、押して選択\\\",\\\"rte_help\\\":\\\"リッチテキストエリア。ヘルプへは、ALT+F8を押してください\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"リッチ コンテンツ エディタ\\\"},\\\"ko\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"배경색, 선택하려면 누름\\\",\\\"forecolor\\\":\\\"텍스트 색, 선택하려면 누름\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"글자 크기, 선택하려면 누름\\\",\\\"formatting\\\":\\\"서식, 선택하려면 누름\\\",\\\"rte_help\\\":\\\"Rich Text Area. Press ALT+F8 for help\\\"}}},\\\"mi\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Tae Papamuri, ki te pēhi ki raro tīpako\\\",\\\"forecolor\\\":\\\"Tae Kuputuhi, ki te pēhi ki raro tīpako\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Rahi Momotuhi, ki te pēhi ki raro tīpako\\\",\\\"formatting\\\":\\\"Whakahōputu, ki te pēhi ki raro tīpako\\\",\\\"rte_help\\\":\\\"Horahanga Kupu Taunaki. Pēhi ALT + K8 no te tauturu\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Ētita Ihirangi Whai Rawa\\\"},\\\"nb\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Bakgrunnsfarge, trykk nedover for å velge\\\",\\\"forecolor\\\":\\\"Tekstfarge, trykk nedover for å velge\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Skriftstørrelse, trykk nedover for å velge\\\",\\\"formatting\\\":\\\"Formatering, trykk nedover for å velge\\\",\\\"rte_help\\\":\\\"Riktekstområde. Trykk ALT+F8 for hjelp\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Rich innholdsredigering\\\"},\\\"nb-x-k12\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Bakgrunnsfarge, trykk nedover for å velge\\\",\\\"forecolor\\\":\\\"Tekstfarge, trykk nedover for å velge\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Skriftstørrelse, trykk nedover for å velge\\\",\\\"formatting\\\":\\\"Formatering, trykk nedover for å velge\\\",\\\"rte_help\\\":\\\"Riktekstområde. Trykk ALT+F8 for hjelp\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Rich innholdsredigering\\\"},\\\"nl\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Achtergrondkleur, er op drukken om een optie te selecteren\\\",\\\"forecolor\\\":\\\"Tekstkleur, er op drukken om een optie te selecteren\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Tekstkleur, er op drukken om een optie te selecteren\\\",\\\"formatting\\\":\\\"Opmaak, er op drukken om een optie te selecteren\\\",\\\"rte_help\\\":\\\"Rich Text Area. Druk ALT+F8 voor hulp\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Rich Content Editor\\\"},\\\"nn\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Bakgrunnsfarge, trykk ned for å velje\\\",\\\"forecolor\\\":\\\"Tekstfarge, trykk ned for å velje\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Skriftstorleik, trykk ned for å velje\\\",\\\"formatting\\\":\\\"Formatering, trykk ned for å velje\\\",\\\"rte_help\\\":\\\"Område for rikt tekstformat. Trykk ALT+F8 for hjelp\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Redigeringsprogram for rikt innhald\\\"},\\\"pl\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Kolor tła; naciskaj do dołu, aby wybrać\\\",\\\"forecolor\\\":\\\"Kolor tekstu; naciskaj do dołu, aby wybrać\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Rozmiar czcionki; naciskaj do dołu, aby wybrać\\\",\\\"formatting\\\":\\\"Formatowanie; naciskaj do dołu, aby wybrać\\\",\\\"rte_help\\\":\\\"Obszar Rich Text. Wciśnij ALT+F8 po pomoc\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Edytor wzbogaconej zawartości\\\"},\\\"pt\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Cor de fundo, premir para baixo para selecionar\\\",\\\"forecolor\\\":\\\"Cor do texto, premir para baixo para selecionar\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Tamanho da letra, premir para baixo para selecionar\\\",\\\"formatting\\\":\\\"Formatação, premir para baixo para selecionar\\\",\\\"rte_help\\\":\\\"Área Rich Text. Pressione ALT+F8 para ajuda\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Editor de conteúdo avançado\\\"},\\\"pt-BR\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Cor de fundo, pressione para selecionar\\\",\\\"forecolor\\\":\\\"Cor do texto, pressione para selecionar\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Tamanho da fonte, pressione para selecionar\\\",\\\"formatting\\\":\\\"Formatação, pressione para selecionar\\\",\\\"rte_help\\\":\\\"Área de conteúdo enriquecido. Pressione ALT + F8 para obter ajuda\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Editor de conteúdo avançado\\\"},\\\"ru\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Цвет фона, нажмите стрелку вниз, чтобы выбрать\\\",\\\"forecolor\\\":\\\"Цвет текста, нажмите стрелку вниз, чтобы выбрать\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Размер шрифта, нажмите стрелку вниз, чтобы выбрать\\\",\\\"formatting\\\":\\\"Форматирование, нажмите стрелку вниз, чтобы выбрать\\\",\\\"rte_help\\\":\\\"Область форматированного текста. Нажмите ALT + F8 для справки\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Редактор форматированного текста\\\"},\\\"sl\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Barva ozadja; za izbiro pritisnite navzdol.\\\",\\\"forecolor\\\":\\\"Barva besedila; za izbiro pritisnite navzdol.\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Velikost pisave; za izbiro pritisnite navzdol.\\\",\\\"formatting\\\":\\\"Oblikovanje; za izbiro pritisnite navzdol.\\\",\\\"rte_help\\\":\\\"Območje besedila Za pomoč pritisnite ALT+F8.\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Urejevalnik\\\"},\\\"sv\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Bakgrundsfärg, tryck ner för att välja\\\",\\\"forecolor\\\":\\\"Textfärg, tryck ner för att välja\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Typsnittsstorlek, tryck ner för att välja\\\",\\\"formatting\\\":\\\"Formatering, tryck ner för att välja\\\",\\\"rte_help\\\":\\\"RTF-område. Tryck ALT+F8 för hjälp\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Innehållsredigeraren\\\"},\\\"sv-x-k12\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Bakgrundsfärg, tryck ner för att välja\\\",\\\"forecolor\\\":\\\"Textfärg, tryck ner för att välja\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Typsnittsstorlek, tryck ner för att välja\\\",\\\"formatting\\\":\\\"Formatering, tryck ner för att välja\\\",\\\"rte_help\\\":\\\"RTF-område. Tryck ALT+F8 för hjälp\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Innehållsredigeraren\\\"},\\\"tr\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Arkaplan rengi, aşağı tuşa basın ve seçin\\\",\\\"forecolor\\\":\\\"Yazı rengi, aşağı tuşa basın ve seçin\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Yazı büyüklüğü, aşağı tuşa basın ve seçin\\\",\\\"formatting\\\":\\\"Format, aşağı tuşa basın ve seçin\\\",\\\"rte_help\\\":\\\"Zengin Metin Alanı. Yardım için ALT+F8 e basın\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Zengin İçerik Editörü\\\"},\\\"uk\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"Колір фону, натисніть внизу, щоб обрати\\\",\\\"forecolor\\\":\\\"Колір тексту, натисніть внизу, щоб обрати\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"Розмір шрифту, натисніть внизу, щоб обрати\\\",\\\"formatting\\\":\\\"Форматування, натисніть внизу, щоб вибрати\\\",\\\"rte_help\\\":\\\"Багатофункціональна область тексту. Натисніть ALT+F8 для довідки\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"Покращений редактор контенту\\\"},\\\"zh-Hans\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"背景颜色，按下即可选择\\\",\\\"forecolor\\\":\\\"文本颜色，按下即可选择\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"字体大小，按下即可选择\\\",\\\"formatting\\\":\\\"格式，按下即可选择\\\",\\\"rte_help\\\":\\\"富文本区域，按 Alt+ F8 寻求帮助\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"富内容编辑器\\\"},\\\"zh-Hant\\\":{\\\"editor_accessibility\\\":{\\\"accessibles\\\":{\\\"background_color\\\":\\\"背景顏色，按下以選擇\\\",\\\"forecolor\\\":\\\"文字顏色，按下以選擇\\\"},\\\"titles\\\":{\\\"font_size\\\":\\\"字體大小，按下以選擇\\\",\\\"formatting\\\":\\\"格式化，按下以選擇\\\",\\\"rte_help\\\":\\\"富文本區域。按 ALT+F8 求助\\\"}},\\\"rich_content_editor_2708ef21\\\":\\\"富內容編輯器\\\"}}\"));\n","\n    import I18n from 'i18nObj';\n    \n      import 'translations/editor_accessibility';\n      import 'translations/_core';\n    \n    import 'translations/_core_en';\n\n    export default I18n.scoped('editor_accessibility');\n  ","//\n// Copyright (C) 2013 - present Instructure, Inc.\n//\n// This file is part of Canvas.\n//\n// Canvas is free software: you can redistribute it and/or modify it under\n// the terms of the GNU Affero General Public License as published by the Free\n// Software Foundation, version 3 of the License.\n//\n// Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n// WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n// A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n// details.\n//\n// You should have received a copy of the GNU Affero General Public License along\n// with this program. If not, see <http://www.gnu.org/licenses/>.\n\nimport I18n from 'i18n!editor_accessibility'\nimport $ from 'jquery'\n\n// #\n// Used to insert accessibility titles into core TinyMCE components\nexport default class EditorAccessiblity {\n  constructor(editor) {\n    this.editor = editor\n    this.id_prepend = editor.id\n    this.$el = $(`#${editor.editorContainer.id}`)\n  }\n\n  accessiblize() {\n    this._cacheElements()\n    this._addTitles()\n    this._addLabels()\n    this._accessiblizeMenubar()\n    this._removeStatusbarFromTabindex()\n  }\n\n  /* PRIVATE FUNCTIONS */\n  _cacheElements() {\n    this.$iframe = this.$el.find('.mce-edit-area iframe')\n  }\n\n  _addLabels() {\n    this.$el.attr('aria-label', I18n.t('Rich Content Editor'))\n    $(this.editor.getBody()).attr('aria-label', $(`label[for=\"${this.id_prepend}\"]`).text())\n    this.$el\n      .find(\"div[aria-label='Font Sizes']\")\n      .attr('aria-label', I18n.t('titles.font_size', 'Font Size, press down to select'))\n    this.$el\n      .find('div.mce-listbox.mce-last:not([aria-label])')\n      .attr('aria-label', I18n.t('titles.formatting', 'Formatting, press down to select'))\n    this.$el\n      .find(\"div[aria-label='Text color']\")\n      .attr('aria-label', I18n.t('accessibles.forecolor', 'Text Color, press down to select'))\n    this.$el\n      .find(\"div[aria-label='Background color'\")\n      .attr(\n        'aria-label',\n        I18n.t('accessibles.background_color', 'Background Color, press down to select')\n      )\n  }\n\n  _addTitles() {\n    this.$iframe.attr('title', I18n.t('titles.rte_help', 'Rich Text Area. Press ALT+F8 for help'))\n  }\n\n  // Hide the menubar until ALT+F9 is pressed.\n  _accessiblizeMenubar() {\n    const $menubar = this.$el.find('.mce-menubar')\n    const $firstMenu = $menubar.find('.mce-menubtn').first()\n    $menubar.hide()\n    this.editor.addShortcut('Alt+F9', '', () => {\n      $menubar.show()\n      $firstMenu.focus()\n      // Once it's shown, we don't need to show it again, so replace this handler with one that just focuses.\n      this.editor.addShortcut('Alt+F9', '', () => $firstMenu.focus())\n    })\n  }\n\n  // keyboard only nav gets permastuck in the statusbar in FF. If you can't\n  // click with a mouse, the only way out is to refresh the page.\n  _removeStatusbarFromTabindex() {\n    const $statusbar = this.$el.find('.mce-statusbar > .mce-container-body')\n    $statusbar.attr('tabindex', -1)\n  }\n}\n","// this file was auto-generated by rake i18n:generate_js.\n// you probably shouldn't edit it directly\nimport mergeI18nTranslations from 'mergeI18nTranslations';\n\n// we use JSON.parse here instead of just loading it as a javascript object literal\n// because according to https://v8.dev/blog/cost-of-javascript-2019#json that is faster\nmergeI18nTranslations(JSON.parse(\"{\\\"ar\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"بحث\\\",\\\"search_by_tag\\\":\\\"بحث حسب العلامة\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"فشل البحث، الرجاء المحاولة مرة أخرى.\\\"},\\\"no_description\\\":\\\"بلا وصف\\\",\\\"no_results_found\\\":\\\"لم يتم العثور على نتائج\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"يقوم Diigo بتقييد المستخدمين إلى بحث واحد كل عشر ثوان.  يرجى الانتظار...\\\",\\\"searching\\\":\\\"جارٍ البحث...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"البحث في الإشارات المرجعية: %{service_name}\\\"}}},\\\"cy\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Chwilio\\\",\\\"search_by_tag\\\":\\\"Chwilio yn ôl tag\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Mae'r broses chwilio wedi methu, rhowch gynnig arall arni.\\\"},\\\"no_description\\\":\\\"Dim disgrifiad\\\",\\\"no_results_found\\\":\\\"Heb ddod o hyd i ganlyniadau\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Mae Diigo yn cyfyngu defnyddwyr i chwilio dim ond unwaith bob deg eiliad.  Arhoswch funud...\\\",\\\"searching\\\":\\\"Wrthi'n chwilio...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Chwilio am nod tudalen: %{service_name}\\\"}}},\\\"da\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Søg\\\",\\\"search_by_tag\\\":\\\"Søg efter tag\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Søgning mislykkede, prøv igen.\\\"},\\\"no_description\\\":\\\"Ingen beskrivelse\\\",\\\"no_results_found\\\":\\\"Der blev ikke fundet resultater\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo begrænser brugerne til en søgning hvert tiende sekund.  Vent venligst ...\\\",\\\"searching\\\":\\\"Søger ...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Bogmærkesøgning: %{service_name}\\\"}}},\\\"da-x-k12\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Søg\\\",\\\"search_by_tag\\\":\\\"Søg efter tag\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Søgning mislykkede, prøv igen.\\\"},\\\"no_description\\\":\\\"Ingen beskrivelse\\\",\\\"no_results_found\\\":\\\"Der blev ikke fundet resultater\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo begrænser brugerne til en søgning hvert tiende sekund.  Vent venligst ...\\\",\\\"searching\\\":\\\"Søger ...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Bogmærkesøgning: %{service_name}\\\"}}},\\\"de\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Suchen\\\",\\\"search_by_tag\\\":\\\"Suche nach Tag\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Suche fehlgeschlagen. Bitte erneut versuchen\\\"},\\\"no_description\\\":\\\"Keine Beschreibung\\\",\\\"no_results_found\\\":\\\"Keine Ergebnisse gefunden\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo beschränkt den Benutzer auf eine Suche alle zehn Sekunden.  Bitte warten Sie ...\\\",\\\"searching\\\":\\\"Suche läuft ...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Lesezeichensuche: %{service_name}\\\"}}},\\\"el\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Αναζήτηση\\\",\\\"search_by_tag\\\":\\\"Αναζήτηση βάσει Ετικέτας\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Η αναζήτηση απέτυχε, παρακαλώ δοκιμάστε ξανά.\\\"},\\\"no_description\\\":\\\"Δεν υπάρχει περιγραφή\\\",\\\"no_results_found\\\":\\\"Δεν βρέθηκαν αποτελέσματα\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"\\\\u003cmrk mid=\\\\\\\"1417\\\\\\\" mtype=\\\\\\\"seg\\\\\\\"\\\\u003eΤο Diigo περιορίζει τους χρήστες σε μία αναζήτηση ανά δέκα δευτερόλεπτα.\\\\u003c/mrk\\\\u003e  \\\\u003cmrk mid=\\\\\\\"1418\\\\\\\" mtype=\\\\\\\"seg\\\\\\\"\\\\u003eΠαρακαλώ περιμένετε...\\\\u003c/mrk\\\\u003e\\\",\\\"searching\\\":\\\"Αναζήτηση...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"\\\\u003cmrk mid=\\\\\\\"1431\\\\\\\" mtype=\\\\\\\"seg\\\\\\\"\\\\u003eΑναζήτηση Σελιδοδείκτη:\\\\u003c/mrk\\\\u003e \\\\u003cmrk mid=\\\\\\\"1432\\\\\\\" mtype=\\\\\\\"seg\\\\\\\"\\\\u003e%{service_name}\\\\u003c/mrk\\\\u003e\\\"}}},\\\"en-AU\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Search\\\",\\\"search_by_tag\\\":\\\"Search by Tag\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Search failed, please try again.\\\"},\\\"no_description\\\":\\\"No description\\\",\\\"no_results_found\\\":\\\"No Results Found\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo limits users to one search every ten seconds.  Please wait...\\\",\\\"searching\\\":\\\"Searching...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Bookmark Search: %{service_name}\\\"}}},\\\"en-CA\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Search\\\",\\\"search_by_tag\\\":\\\"Search by Tag\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Search failed, please try again.\\\"},\\\"no_description\\\":\\\"No description\\\",\\\"no_results_found\\\":\\\"No Results Found\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo limits users to one search every ten seconds.  Please wait...\\\",\\\"searching\\\":\\\"Searching...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Bookmark Search: %{service_name}\\\"}}},\\\"en-GB\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Search\\\",\\\"search_by_tag\\\":\\\"Search by tag\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Search failed, please try again.\\\"},\\\"no_description\\\":\\\"No description\\\",\\\"no_results_found\\\":\\\"No results found\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo limits users to one search every ten seconds.  Please wait...\\\",\\\"searching\\\":\\\"Searching...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Bookmark Search: %{service_name}\\\"}}},\\\"es\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Buscar\\\",\\\"search_by_tag\\\":\\\"Buscar por etiqueta\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Error en la búsqueda; intente de nuevo.\\\"},\\\"no_description\\\":\\\"Sin descripción\\\",\\\"no_results_found\\\":\\\"No se encontraron resultados\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo limita a los usuarios a una búsqueda cada diez segundos.  Espere...\\\",\\\"searching\\\":\\\"Buscando...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Búsqueda de marcadores: %{service_name}\\\"}}},\\\"fa\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"جستجو\\\",\\\"search_by_tag\\\":\\\"جستجو بر اساس برچسب\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"جستجو انجام نشد، لطفا دوباره سعی کنید.\\\"},\\\"no_description\\\":\\\"شرح موجود نیست\\\",\\\"no_results_found\\\":\\\"نتیجه ای یافت نشد\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo کاربران را به یک جستجو در هر ده ثانیه محدود می کند. لطفا صبر کنید...\\\",\\\"searching\\\":\\\"درحال جستجو...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"نشانه گذاری جستجو: %{service_name}\\\"}}},\\\"fi\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Hae\\\",\\\"search_by_tag\\\":\\\"Hae merkin perusteella\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Haku epäonnistui, yritä uudelleen.\\\"},\\\"no_description\\\":\\\"Ei kuvausta\\\",\\\"no_results_found\\\":\\\"Tuloksia ei löytynyt\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo rajoittaa käyttäjiä yhteen hakuun kymmenen sekunnin välein.  Odota hetki...\\\",\\\"searching\\\":\\\"Haku on käynnissä...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Kirjanmerkin haku: %{service_name}\\\"}}},\\\"fr\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Rechercher\\\",\\\"search_by_tag\\\":\\\"Rechercher par étiquette\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Échec de la recherche, veuillez réessayer.\\\"},\\\"no_description\\\":\\\"Aucune description\\\",\\\"no_results_found\\\":\\\"Aucun résultat trouvé\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo limite les utilisateurs à une recherche toutes les 10 secondes.  Veuillez patienter...\\\",\\\"searching\\\":\\\"Recherche en cours...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Recherche dans les favoris : %{service_name}\\\"}}},\\\"fr-CA\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Rechercher\\\",\\\"search_by_tag\\\":\\\"Rechercher par étiquette\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Échec de la recherche, veuillez réessayer.\\\"},\\\"no_description\\\":\\\"Aucune description\\\",\\\"no_results_found\\\":\\\"Aucun résultat trouvé\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo limite les utilisateurs à une recherche toutes les dix secondes.  Veuillez patienter...\\\",\\\"searching\\\":\\\"Recherche en cours...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Recherche d’un signet : %{service_name}\\\"}}},\\\"he\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"חיפוש\\\",\\\"search_by_tag\\\":\\\"חיפוש לפי תגיות\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"החיפוש נכשל, יש לנסות שוב\\\"},\\\"no_description\\\":\\\"אין תיאור\\\",\\\"no_results_found\\\":\\\"לא נמצאו תוצאות\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"דייגו מגביל משתמשים לחיפוש אחד כל עשר שניות. נא להמתין...\\\",\\\"searching\\\":\\\"מחפש...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"סימון מאפייני החיפוש %{service_name} לגישה ישירה\\\"}}},\\\"ht\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Chèche\\\",\\\"search_by_tag\\\":\\\"Cheche pa Etikèt\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Rechèch echwe, tanpri eseye ankò.\\\"},\\\"no_description\\\":\\\"Pa gen deskripsyon\\\",\\\"no_results_found\\\":\\\"Nou pa jwenn rezilta\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo limite itilizatè yo a yon rechèch chak dis segonn.  Tanpri tann...\\\",\\\"searching\\\":\\\"Chèche...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Make Rechèch: %{service_name}\\\"}}},\\\"hu\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Keresés\\\",\\\"search_by_tag\\\":\\\"Keresés címke alapján\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"A keresés sikertelen, kérjük, próbálja újra. \\\"},\\\"no_description\\\":\\\"Nincs leírás\\\",\\\"no_results_found\\\":\\\"Nincs találat\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"A Diigo korlátozása alapján tíz másodpercenként egy keresést lehet végrehajtani. Kérjük, várjon...\\\",\\\"searching\\\":\\\"Keresés...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Könyvjelző keresése: %{service_name}\\\"}}},\\\"hy\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Որոնել\\\",\\\"search_by_tag\\\":\\\"Որոնում ըստ պիտակի\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Որոնումը չհաջողվեց, փորձեք կրկին:\\\"},\\\"no_description\\\":\\\"Նկարագրություն չկա\\\",\\\"no_results_found\\\":\\\"Ոչ մի արդյունք չի գտնվել\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo-ն օգտատերերի համար սահմանել է որոնում տասը վայրկյան պարբերականությամբ:  Խնդրում ենք սպասել... \\\",\\\"searching\\\":\\\"Որոնումը ընթացքում է...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Էջանիշի որոնում՝ %{service_name}\\\"}}},\\\"is\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Leita\\\",\\\"search_by_tag\\\":\\\"Leita eftir merki\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Leit tókst ekki, reyndu aftur.\\\"},\\\"no_description\\\":\\\"Engin lýsing\\\",\\\"no_results_found\\\":\\\"Engar niðurstöður fundust\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo takmarkar notendur við eina leit á hverjum tíu sekúndum.  Augnablik...\\\",\\\"searching\\\":\\\"Leita...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Bókamerkjaleit: %{service_name}\\\"}}},\\\"it\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Cerca\\\",\\\"search_by_tag\\\":\\\"Cerca per tag\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Ricerca non riuscita. Riprova.\\\"},\\\"no_description\\\":\\\"Nessuna descrizione\\\",\\\"no_results_found\\\":\\\"Nessun risultato trovato\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo limita gli utenti a una ricerca ogni dieci secondi.  Attendi...\\\",\\\"searching\\\":\\\"Ricerca in corso...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Aggiungi ricerca ai preferiti: %{service_name}\\\"}}},\\\"ja\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"検索\\\",\\\"search_by_tag\\\":\\\"タグで検索\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"検索に失敗しました。もう一度やり直してください。\\\"},\\\"no_description\\\":\\\"説明なし\\\",\\\"no_results_found\\\":\\\"一致するものが見つかりませんでした\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo によりユーザーは検索を１0秒ごとに1回に制限されています。  お待ちください...\\\",\\\"searching\\\":\\\"検索しています...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"ブックマーク検索: %{service_name}\\\"}}},\\\"ko\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"검색\\\",\\\"search_by_tag\\\":\\\"태그로 검색\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"검색에 실패했습니다. 다시 시도하시기 바랍니다.\\\"},\\\"no_description\\\":\\\"설명 없음\\\",\\\"no_results_found\\\":\\\"찾은 결과 없음\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo는 매 10초마다 한 번의 검색만 허용합니다. 기다려 주십시오...\\\",\\\"searching\\\":\\\"검색 중...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"북마크 검색: %{service_name}\\\"}}},\\\"mi\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Rapu\\\",\\\"search_by_tag\\\":\\\"Rapu i te Tūtohu\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"I rahua te rapunga, tēnā koa ngana anō koa.\\\"},\\\"no_description\\\":\\\"Kāore he whakaahuatanga\\\",\\\"no_results_found\\\":\\\"Kaore he hua\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo aukati ai i ngā kaiwhakamahi ki te rapu ia tekau hēkona i te wā  Tēnā koa tatari ....\\\",\\\"searching\\\":\\\"Rapu ana ...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Pukatohu Rapu %{service_name}\\\"}}},\\\"nb\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Søk\\\",\\\"search_by_tag\\\":\\\"Søk basert på merke\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Søk mislyktes, vennligst prøv igjen.\\\"},\\\"no_description\\\":\\\"Ingen beskrivelse\\\",\\\"no_results_found\\\":\\\"Ingen resultater funnet\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo begrenser brukere til ett søk hvert tiende sekund.  Vennligst vent…\\\",\\\"searching\\\":\\\"Søker...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Bokmerke søk: %{service_name}\\\"}}},\\\"nb-x-k12\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Søk\\\",\\\"search_by_tag\\\":\\\"Søk basert på merke\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Søk mislyktes, vennligst prøv igjen.\\\"},\\\"no_description\\\":\\\"Ingen beskrivelse\\\",\\\"no_results_found\\\":\\\"Ingen resultater funnet\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo begrenser brukere til ett søk hvert tiende sekund.  Vennligst vent…\\\",\\\"searching\\\":\\\"Søker...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Bokmerke søk: %{service_name}\\\"}}},\\\"nl\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Zoeken\\\",\\\"search_by_tag\\\":\\\"Zoeken op label\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Zoeken mislukt, probeer het opnieuw.\\\"},\\\"no_description\\\":\\\"Geen beschrijving\\\",\\\"no_results_found\\\":\\\"Geen resultaten gevonden\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo beperkt gebruikers tot één zoekopdracht per tien seconden.  Een ogenblik geduld...\\\",\\\"searching\\\":\\\"Bezig met zoeken...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Zoekopdracht aan bladwijzer: %{service_name}\\\"}}},\\\"nn\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Søk\\\",\\\"search_by_tag\\\":\\\"Søk etter tag\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Søket mislukkast, prøv på nytt seinare.\\\"},\\\"no_description\\\":\\\"Inga skildring\\\",\\\"no_results_found\\\":\\\"Finn ikkje resultat\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Med Diigo er du avgrensa til eit søk kvart tiande sekund. Vent...\\\",\\\"searching\\\":\\\"Søker...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Bokmerk søket: %{service_name}\\\"}}},\\\"pl\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Wyszukaj\\\",\\\"search_by_tag\\\":\\\"Wyszukaj według etykiety\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Wyszukiwanie nie powiodło się, ponów próbę.\\\"},\\\"no_description\\\":\\\"Brak opisu\\\",\\\"no_results_found\\\":\\\"Brak wyników\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Witryna Diigo ogranicza użytkownikom możliwość wyszukiwania do jednej próby co dziesięć sekund.  Prosimy czekać...\\\",\\\"searching\\\":\\\"Trwa wyszukiwanie...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Dodaj wyszukiwanie do ulubionych: %{service_name}\\\"}}},\\\"pt\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Pesquisar\\\",\\\"search_by_tag\\\":\\\"Pesquisar por tag\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Falha na pesquisa, tente novamente.\\\"},\\\"no_description\\\":\\\"Sem descrição\\\",\\\"no_results_found\\\":\\\"Nenhum resultado encontrado\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"O Diigo limita os utilizadores a uma pesquisa a cada dez segundos.  É favor aguardar...\\\",\\\"searching\\\":\\\"A pesquisar...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Pesquisa de Bookmark: %{service_name}\\\"}}},\\\"pt-BR\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Pesquisar\\\",\\\"search_by_tag\\\":\\\"Pesquisar por tag\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Falha na pesquisa, tente novamente.\\\"},\\\"no_description\\\":\\\"Sem descrição\\\",\\\"no_results_found\\\":\\\"Nenhum resultado encontrado\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"O Diigo limita os usuários a uma pesquisa a cada dez segundos.  Por favor, aguarde...\\\",\\\"searching\\\":\\\"Pesquisando...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Pesquisa dos favoritos: %{service_name}\\\"}}},\\\"ru\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Поиск\\\",\\\"search_by_tag\\\":\\\"Поиск по тегу\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Сбой поиска, повторите попытку\\\"},\\\"no_description\\\":\\\"Описание отсутствует\\\",\\\"no_results_found\\\":\\\"Результаты не найдены\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo позволяет пользователям выполнять один поиск раз в десять секунд.  Подождите...\\\",\\\"searching\\\":\\\"Идет поиск...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Сделать закладку для поиска: %{service_name}\\\"}}},\\\"sv\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Sök\\\",\\\"search_by_tag\\\":\\\"Sök efter tagg\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Sökning misslyckades, försök igen.\\\"},\\\"no_description\\\":\\\"Ingen beskrivning\\\",\\\"no_results_found\\\":\\\"Inga resultat hittades\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo begränsar användare till en sökning var 10 sekund.  Vänta ...\\\",\\\"searching\\\":\\\"Söker ...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Bokmärkessökning: %{service_name}\\\"}}},\\\"sv-x-k12\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Sök\\\",\\\"search_by_tag\\\":\\\"Sök efter tagg\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Sökning misslyckades, försök igen.\\\"},\\\"no_description\\\":\\\"Ingen beskrivning\\\",\\\"no_results_found\\\":\\\"Inga resultat hittades\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo begränsar användare till en sökning var 10 sekund.  Vänta ...\\\",\\\"searching\\\":\\\"Söker ...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Bokmärkessökning: %{service_name}\\\"}}},\\\"tr\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"Ara\\\",\\\"search_by_tag\\\":\\\"Etikete göre Ara\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"Arama işlemi başarısız, lütfen tekrar deneyin.\\\"},\\\"no_description\\\":\\\"Açıklama Yok\\\",\\\"no_results_found\\\":\\\"Hiç Sonuç Bulunamadı\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo kullanıcıları her 10 saniyede bir arama yapabilecek şekilde sınırlıyor. Lütfen bekleyiniz...\\\",\\\"searching\\\":\\\"Aranıyor...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"Yer İmi Arama: %{service_name}\\\"}}},\\\"zh-Hans\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"搜索\\\",\\\"search_by_tag\\\":\\\"按标签搜索\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"搜索失败，请重试。\\\"},\\\"no_description\\\":\\\"无描述\\\",\\\"no_results_found\\\":\\\"未找到结果\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo 限制用户每 10 秒搜索一次。  请稍等...\\\",\\\"searching\\\":\\\"正在搜索...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"书签搜索：%{service_name}\\\"}}},\\\"zh-Hant\\\":{\\\"findLinkForService\\\":{\\\"buttons\\\":{\\\"search\\\":\\\"搜尋\\\",\\\"search_by_tag\\\":\\\"透過標籤搜尋\\\"},\\\"errors\\\":{\\\"search_failed\\\":\\\"搜尋失敗，請再試一次。\\\"},\\\"no_description\\\":\\\"沒有說明\\\",\\\"no_results_found\\\":\\\"找不到結果\\\",\\\"status\\\":{\\\"diigo_search_throttling\\\":\\\"Diigo 限制使用者每十秒鐘搜尋一次。  請稍候...\\\",\\\"searching\\\":\\\"正在搜尋...\\\"},\\\"titles\\\":{\\\"bookmark_search\\\":\\\"書籤搜尋：%{service_name}\\\"}}}}\"));\n","\n    import I18n from 'i18nObj';\n    \n      import 'translations/findLinkForService';\n      import 'translations/_core';\n    \n    import 'translations/_core_en';\n\n    export default I18n.scoped('findLinkForService');\n  ","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport I18n from 'i18n!findLinkForService'\nimport $ from 'jquery'\nimport htmlEscape from './str/htmlEscape'\nimport TextHelper from 'compiled/str/TextHelper'\nimport './jquery.ajaxJSON'\nimport './jquery.instructure_forms'\nimport 'jqueryui/dialog'\n\nexport function getUserServices(service_types, success, error) {\n  if (!$.isArray(service_types)) {\n    service_types = [service_types]\n  }\n  const url = `/services?service_types=${service_types.join(',')}`\n  $.ajaxJSON(\n    url,\n    'GET',\n    {},\n    data => {\n      if (success) {\n        success(data)\n      }\n    },\n    data => {\n      if (error) {\n        error(data)\n      }\n    }\n  )\n}\n\nlet lastLookup // used to keep track of diigo requests\nexport function findLinkForService(service_type, callback) {\n  let $dialog = $('#instructure_bookmark_search')\n  if (!$dialog.length) {\n    $dialog = $(\"<div id='instructure_bookmark_search'/>\")\n    $dialog.append(\n      `${\"<form id='bookmark_search_form' style='margin-bottom: 5px;'>\" +\n        \"<img src='/images/blank.png'/>&nbsp;&nbsp;\" +\n        \"<input type='text' class='query' style='width: 230px;'/>\" +\n        \"<button class='btn search_button' type='submit'>\"}${htmlEscape(\n        I18n.t('buttons.search', 'Search')\n      )}</button></form>`\n    )\n    $dialog.append(\"<div class='results' style='max-height: 200px; overflow: auto;'/>\")\n    $dialog.find('form').submit(event => {\n      event.preventDefault()\n      event.stopPropagation()\n      const now = new Date()\n      if (service_type == 'diigo' && lastLookup && now - lastLookup < 15000) {\n        // let the user know we have to take things slow because of Diigo\n        setTimeout(() => {\n          $dialog.find('form').submit()\n        }, 15000 - (now - lastLookup))\n        $dialog\n          .find('.results')\n          .empty()\n          .append(\n            htmlEscape(\n              I18n.t(\n                'status.diigo_search_throttling',\n                'Diigo limits users to one search every ten seconds.  Please wait...'\n              )\n            )\n          )\n        return\n      }\n      $dialog\n        .find('.results')\n        .empty()\n        .append(htmlEscape(I18n.t('status.searching', 'Searching...')))\n      lastLookup = new Date()\n      const query = $dialog.find('.query').val()\n      const url = $.replaceTags($dialog.data('reference_url'), 'query', query)\n      $.ajaxJSON(\n        url,\n        'GET',\n        {},\n        data => {\n          $dialog.find('.results').empty()\n          if (!data.length) {\n            $dialog\n              .find('.results')\n              .append(htmlEscape(I18n.t('no_results_found', 'No Results Found')))\n          }\n          for (const idx in data) {\n            data[idx].short_title = data[idx].title\n            if (data[idx].title == data[idx].description) {\n              data[idx].short_title = TextHelper.truncateText(data[idx].description, {max: 30})\n            }\n            $(\"<div class='bookmark'/>\")\n              .appendTo($dialog.find('.results'))\n              .append(\n                $('<a class=\"bookmark_link\" style=\"font-weight: bold;\"/>')\n                  .attr({\n                    href: data[idx].url,\n                    title: data[idx].title\n                  })\n                  .text(data[idx].short_title)\n              )\n              .append(\n                $(\"<div style='margin: 5px 10px; font-size: 0.8em;'/>\").text(\n                  data[idx].description || I18n.t('no_description', 'No description')\n                )\n              )\n          }\n        },\n        () => {\n          $dialog\n            .find('.results')\n            .empty()\n            .append(htmlEscape(I18n.t('errors.search_failed', 'Search failed, please try again.')))\n        }\n      )\n    })\n    $dialog.delegate('.bookmark_link', 'click', function(event) {\n      event.preventDefault()\n      const url = $(this).attr('href')\n      const title = $(this).attr('title') || $(this).text()\n      $dialog.dialog('close')\n      callback({\n        url,\n        title\n      })\n    })\n  }\n  $dialog\n    .find('.search_button')\n    .text(\n      service_type == 'delicious'\n        ? I18n.t('buttons.search_by_tag', 'Search by Tag')\n        : I18n.t('buttons.search', 'Search')\n    )\n  $dialog.find('form img').attr('src', `/images/${service_type}_small_icon.png`)\n  let url = '/search/bookmarks?q=%7B%7B+query+%7D%7D&service_type=%7B%7B+service_type+%7D%7D'\n  url = $.replaceTags(url, 'service_type', service_type)\n  $dialog.data('reference_url', url)\n  $dialog\n    .find('.results')\n    .empty()\n    .end()\n    .find('.query')\n    .val('')\n  $dialog.dialog({\n    title: I18n.t('titles.bookmark_search', 'Bookmark Search: %{service_name}', {\n      service_name: $.titleize(service_type)\n    }),\n    open() {\n      $dialog\n        .find('input:visible:first')\n        .focus()\n        .select()\n    },\n    width: 400\n  })\n}\n","/*\n * Copyright (C) 2016 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery'\nimport serviceRCELoader from './serviceRCELoader'\n\nfunction loadServiceSidebar(callback) {\n  serviceRCELoader.loadSidebarOnTarget($('#editor_tabs').get(0), callback)\n}\n\nconst Sidebar = {\n  /**\n   * variables to track singleton state and initialization status\n   *\n   * @private\n   */\n  instance: undefined,\n  pendingShow: false,\n  initializing: false,\n  subscriptions: {},\n\n  /**\n   * initialize the sidebar. safe to call multiple times; if the sidebar is\n   * already initialized or currently initializing, it won't be started\n   * again. can also pass callbacks to execute any time the sidebar is shown\n   * (`show`) or hidden (`hide`).\n   *\n   * @public\n   */\n  init(subscriptions = {}) {\n    if (!this.instance && !this.initializing) {\n      this.initializing = true\n      const callback = sidebar => {\n        this.initializing = false\n        this.instance = sidebar\n        if (this.pendingShow) {\n          this.show()\n        }\n      }\n      loadServiceSidebar(callback)\n    }\n    this.subscriptions = subscriptions\n  },\n\n  /**\n   * show the sidebar, if initialized. no-op if the sidebar is not\n   * initialized or even if it's currently initializing. if shown, triggers\n   * any callbacks registered for `show` on init.\n   *\n   * @public\n   */\n  show() {\n    if (this.instance) {\n      this.instance.show()\n      if (this.subscriptions.show) {\n        this.subscriptions.show()\n      }\n    } else {\n      this.pendingShow = true\n    }\n  },\n\n  /**\n   * hide the sidebar, if initialized. no-op if the sidebar is not\n   * initialized or even if it's currently initializing. if hidden, triggers\n   * any callbacks registered for `hide` on init.\n   *\n   * @public\n   */\n  hide() {\n    if (this.instance) {\n      this.instance.hide()\n      if (this.subscriptions.hide) {\n        this.subscriptions.hide()\n      }\n    } else {\n      this.pendingShow = false\n    }\n  },\n\n  /**\n   * reset, for specs\n   *\n   * @private\n   */\n  reset() {\n    this.instance = undefined\n    this.initializing = false\n    this.subscriptions = {}\n  }\n}\n\nexport default Sidebar\n","/*\n * Copyright (C) 2017 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport axios from 'axios'\n\nexport function refreshFn(initialToken) {\n  let token = initialToken\n  let promise = null\n\n  return done => {\n    if (promise === null) {\n      promise = axios.post('/api/v1/jwts/refresh', {jwt: token}).then(resp => {\n        promise = null\n        token = resp.data.token\n        return token\n      })\n    }\n\n    if (typeof done === 'function') {\n      promise.then(done)\n    }\n\n    return promise\n  }\n}\n","/*\n * Copyright (C) 2015 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport {getDirection} from 'jsx/shared/helpers/rtlHelper'\n\nexport default class EditorConfig {\n  /**\n   * Create an editor config instance, with some internal state passed in\n   *   so the object knows how to generate a dynamic hash of default\n   *   configuration parameters.  May get overridden by merging\n   *   with another hash of overwriting config parameters.\n   *\n   *  @param {tinymce} tinymce the tinymce global which we use to pull\n   *    some config info off of like the BaseURL for refrencing the skin css\n   *  @param {INST} inst a config hash defined in public/javascripts/INST.js,\n   *    provides feature information like whether notorious is enabled for\n   *    their account.  Generally you can just pass it in after requiring it.\n   *  @param {int} width The width of the viewport the editor is in, this is\n   *    useful for deciding how many buttons to show per toolbar line\n   *  @param {string} domId the \"id\" attribute of the element that's going\n   *    to be transformed with a tinymce editor\n   *\n   *  @exports\n   *  @constructor\n   *  @return {EditorConfig}\n   */\n  constructor(tinymce, inst, width, domId) {\n    this.baseURL = tinymce.baseURL\n    this.maxButtons = inst.maxVisibleEditorButtons\n    this.extraButtons = inst.editorButtons\n    this.instConfig = inst\n    this.viewportWidth = width\n    this.idAttribute = domId\n  }\n\n  /**\n   * export an appropriate config hash for this config instance.\n   * This returns a simple javascript object with our default\n   * configuration parameters enabled.  You can override\n   * any configuration parameters you want by combining this hash\n   * with an override hash at runtime using \"$.extend\" or similar:\n   *\n   *   var overrides = { resize: false };\n   *   var tinyOptions = $.extend(editorConfig.defaultConfig(), overrides);\n   *   tinymce.init(tinyOptions);\n   *\n   * @return {Hash}\n   */\n  defaultConfig() {\n    return {\n      selector: `#${this.idAttribute}`,\n      toolbar: this.toolbar(),\n      [!window.ENV.use_rce_enhancements && 'theme']: 'modern',\n      [!window.ENV.use_rce_enhancements && 'skin']: false,\n      directionality: getDirection(),\n      plugins: `autolink,media,paste,table,lists,${\n        window.ENV.use_rce_enhancements\n          ? 'hr,instructure-ui-icons,instructure_condensed_buttons,instructure_documents'\n          : 'textcolor'\n      },link,directionality,a11y_checker,wordcount`,\n      external_plugins: {\n        instructure_image: '/javascripts/tinymce_plugins/instructure_image/plugin.js',\n        instructure_links: '/javascripts/tinymce_plugins/instructure_links/plugin.js',\n        instructure_embed: '/javascripts/tinymce_plugins/instructure_embed/plugin.js',\n        instructure_equation: '/javascripts/tinymce_plugins/instructure_equation/plugin.js',\n        instructure_external_tools:\n          '/javascripts/tinymce_plugins/instructure_external_tools/plugin.js',\n        instructure_record: '/javascripts/tinymce_plugins/instructure_record/plugin.js'\n      },\n      language_load: false,\n      convert_urls: false,\n      // we add the menubar for a11y purposes but then\n      // hide it with js for non screenreader users\n      menubar: true,\n      branding: false,\n      remove_script_host: true,\n      resize: true,\n      block_formats: 'Paragraph=p;Header 2=h2;Header 3=h3;Header 4=h4;Preformatted=pre',\n\n      // part of unifying tinymce and canvas_sanitize's element whitelist\n      // copied from\n      // https://www.tiny.cloud/docs-3x/reference/configuration/Configuration3x@valid_elements/#defaultruleset\n      // then edited.\n      valid_elements:\n        '@[id|class|style|title|dir<ltr?rtl|lang|xml::lang|onclick|ondblclick|' +\n        'onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|' +\n        'onkeydown|onkeyup],a[rel|rev|charset|hreflang|tabindex|accesskey|type|' +\n        'name|href|target|title|class|onfocus|onblur],strong/b,em/i,strike,u,' +\n        '#p,-ol[type|compact],-ul[type|compact],-li,br,img[longdesc|usemap|' +\n        'src|border|alt=|title|hspace|vspace|width|height|align],-sub,-sup,' +\n        '-blockquote,-table[border=0|cellspacing|cellpadding|width|frame|rules|' +\n        'height|align|summary|bgcolor|background|bordercolor],-tr[rowspan|width|' +\n        'height|align|valign|bgcolor|background|bordercolor],tbody,thead,tfoot,' +\n        '#td[colspan|rowspan|width|height|align|valign|bgcolor|background|bordercolor' +\n        '|scope],#th[colspan|rowspan|width|height|align|valign|scope],caption,-div,' +\n        '-span,-code,-pre,address,-h1,-h2,-h3,-h4,-h5,-h6,hr[size|noshade],-font[face' +\n        '|size|color],dd,dl,dt,cite,abbr,acronym,del[datetime|cite],ins[datetime|cite],' +\n        'object[classid|width|height|codebase|*],param[name|value|_value],embed[type|width' +\n        '|height|src|*],script[src|type],map[name],area[shape|coords|href|alt|target],bdo,' +\n        'col[align|char|charoff|span|valign|width],colgroup[align|char|charoff|span|' +\n        'valign|width],dfn,kbd,label[for],legend,q[cite],samp,small,tt,var,big,' +\n        'figure,figcaption,source,track,mark,article,aside,details,footer,header,nav,section,summary,time',\n\n      extended_valid_elements:\n        '@[id|accesskey|class|dir|lang|style|tabindex|title|contenteditable|contextmenu|draggable|dropzone|hidden|longdesc|spellcheck|translate|align|role|aria-labelledby|aria-atomic|aria-busy|aria-controls|aria-describedby|aria-disabled|aria-dropeffect|aria-flowto|aria-grabbed|aria-haspopup|aria-hidden|aria-invalid|aria-label|aria-labelledby|aria-live|aria-owns|aria-relevant|aria-autocomplete|aria-checked|aria-disabled|aria-expanded|aria-haspopup|aria-hidden|aria-invalid|aria-label|aria-level|aria-multiline|aria-multiselectable|aria-orientation|aria-pressed|aria-readonly|aria-required|aria-selected|aria-sort|aria-valuemax|aria-valuemin|aria-valuenow|aria-valuetext],iframe[id|data-media-type|title|src|width|height|name|align|style|class|sandbox|allowfullscreen|webkitallowfullscreen|mozallowfullscreen|allow],i[iclass],a[hidden|href|target|rel|media|hreflang|type|charset|name|rev|shape|coords|download|alt],#p,li[value],-ol[reversed|start|type|compact],pre[width],table[border|summary|width|frame|rules|cellspacing|cellpadding|bgcolor],tbody[char|charoff|valign],td[colspan|rowspan|headers|abbr|axis|scope|align|char|charoff|valign|nowrap|bgcolor|width|height],tfoot[char|charoff|valign],th[colspan|rowspan|headers|scope|abbr|axis|align|char|charoff|valign|nowrap|bgcolor|width|height],thead[char|charoff|valign],tr[char|charoff|valign|bgcolor],-ul[compact],video[name|src|allowfullscreen|muted|poster|width|height|controls|playsinline],audio[name|src|muted|controls],annotation[href|xref|definitionURL|encoding|cd|name|src],annotation-xml[href|xref|definitionURL|encoding|cd|name|src],maction[href|xref|mathcolor|mathbackground|actiontype|selection],maligngroup[href|xref|mathcolor|mathbackground|groupalign],malignmark[href|xref|mathcolor|mathbackground|edge],math[xmlns|href|xref|display|maxwidth|overflow|altimg|altimg-width|altimg-height|altimg-valign|alttext|cdgroup|mathcolor|mathbackground|scriptlevel|displaystyle|scriptsizemultiplier|scriptminsize|infixlinebreakstyle|decimalpoint|mathvariant|mathsize|width|height|valign|form|fence|separator|lspace|rspace|stretchy|symmetric|maxsize|minsize|largeop|movablelimits|accent|linebreak|lineleading|linebreakstyle|linebreakmultchar|indentalign|indentshift|indenttarget|indentalignfirst|indentshiftfirst|indentalignlast|indentshiftlast|depth|lquote|rquote|linethickness|munalign|denomalign|bevelled|voffset|open|close|separators|notation|subscriptshift|superscriptshift|accentunder|align|rowalign|columnalign|groupalign|alignmentscope|columnwidth|rowspacing|columnspacing|rowlines|columnlines|frame|framespacing|equalrows|equalcolumns|side|minlabelspacing|rowspan|columnspan|edge|stackalign|charalign|charspacing|longdivstyle|position|shift|location|crossout|length|leftoverhang|rightoverhang|mslinethickness|selection],menclose[href|xref|mathcolor|mathbackground|notation],merror[href|xref|mathcolor|mathbackground],mfenced[href|xref|mathcolor|mathbackground|open|close|separators],mfrac[href|xref|mathcolor|mathbackground|linethickness|munalign|denomalign|bevelled],mglyph[href|xref|mathcolor|mathbackground|src|alt|width|height|valign],mi[href|xref|mathcolor|mathbackground|mathvariant|mathsize],mlabeledtr[href|xref|mathcolor|mathbackground],mlongdiv[href|xref|mathcolor|mathbackground|longdivstyle|align|stackalign|charalign|charspacing],mmultiscripts[href|xref|mathcolor|mathbackground|subscriptshift|superscriptshift],mn[href|xref|mathcolor|mathbackground|mathvariant|mathsize],mo[href|xref|mathcolor|mathbackground|mathvariant|mathsize|form|fence|separator|lspace|rspace|stretchy|symmetric|maxsize|minsize|largeop|movablelimits|accent|linebreak|lineleading|linebreakstyle|linebreakmultchar|indentalign|indentshift|indenttarget|indentalignfirst|indentshiftfirst|indentalignlast|indentshiftlast],mover[href|xref|mathcolor|mathbackground|accent|align],mpadded[href|xref|mathcolor|mathbackground|height|depth|width|lspace|voffset],mphantom[href|xref|mathcolor|mathbackground],mprescripts[href|xref|mathcolor|mathbackground],mroot[href|xref|mathcolor|mathbackground],mrow[href|xref|mathcolor|mathbackground],ms[href|xref|mathcolor|mathbackground|mathvariant|mathsize|lquote|rquote],mscarries[href|xref|mathcolor|mathbackground|position|location|crossout|scriptsizemultiplier],mscarry[href|xref|mathcolor|mathbackground|location|crossout],msgroup[href|xref|mathcolor|mathbackground|position|shift],msline[href|xref|mathcolor|mathbackground|position|length|leftoverhang|rightoverhang|mslinethickness],mspace[href|xref|mathcolor|mathbackground|mathvariant|mathsize],msqrt[href|xref|mathcolor|mathbackground],msrow[href|xref|mathcolor|mathbackground|position],mstack[href|xref|mathcolor|mathbackground|align|stackalign|charalign|charspacing],mstyle[href|xref|mathcolor|mathbackground|scriptlevel|displaystyle|scriptsizemultiplier|scriptminsize|infixlinebreakstyle|decimalpoint|mathvariant|mathsize|width|height|valign|form|fence|separator|lspace|rspace|stretchy|symmetric|maxsize|minsize|largeop|movablelimits|accent|linebreak|lineleading|linebreakstyle|linebreakmultchar|indentalign|indentshift|indenttarget|indentalignfirst|indentshiftfirst|indentalignlast|indentshiftlast|depth|lquote|rquote|linethickness|munalign|denomalign|bevelled|voffset|open|close|separators|notation|subscriptshift|superscriptshift|accentunder|align|rowalign|columnalign|groupalign|alignmentscope|columnwidth|rowspacing|columnspacing|rowlines|columnlines|frame|framespacing|equalrows|equalcolumns|side|minlabelspacing|rowspan|columnspan|edge|stackalign|charalign|charspacing|longdivstyle|position|shift|location|crossout|length|leftoverhang|rightoverhang|mslinethickness|selection],msub[href|xref|mathcolor|mathbackground|subscriptshift],msubsup[href|xref|mathcolor|mathbackground|subscriptshift|superscriptshift],msup[href|xref|mathcolor|mathbackground|superscriptshift],mtable[href|xref|mathcolor|mathbackground|align|rowalign|columnalign|groupalign|alignmentscope|columnwidth|width|rowspacing|columnspacing|rowlines|columnlines|frame|framespacing|equalrows|equalcolumns|displaystyle|side|minlabelspacing],mtd[href|xref|mathcolor|mathbackground|rowspan|columnspan|rowalign|columnalign|groupalign],mtext[href|xref|mathcolor|mathbackground|mathvariant|mathsize|width|height|depth|linebreak],mtr[href|xref|mathcolor|mathbackground|rowalign|columnalign|groupalign],munder[href|xref|mathcolor|mathbackground|accentunder|align],munderover[href|xref|mathcolor|mathbackground|accent|accentunder|align],none[href|xref|mathcolor|mathbackground],semantics[href|xref|definitionURL|encoding]',\n\n      non_empty_elements:\n        'td th iframe video audio object script a i area base basefont br col frame hr img input isindex link meta param embed source wbr track',\n\n      content_css: window.ENV.url_to_what_gets_loaded_inside_the_tinymce_editor_css,\n      browser_spellcheck: true,\n      init_instance_callback: ed => {\n        $(`#${ed.id}`) // eslint-disable-line no-undef\n          .parent()\n          .css('visibility', 'visible')\n      },\n      // if kalturaSettings is missing, we have no kaltura to upload to\n      // if present, user may have chosen to hide the button anyway.\n      show_media_upload: !!INST.kalturaSettings && !INST.kalturaSettings.hide_rte_button\n    }\n  }\n\n  /**\n   * builds the configuration information that decides whether to clump\n   * up external buttons or not based on the number of extras we\n   * want to add.\n   *\n   * @private\n   * @return {String} comma delimited set of external buttons\n   */\n  external_buttons() {\n    let externals = ''\n    for (let idx = 0; this.extraButtons && idx < this.extraButtons.length; idx++) {\n      if (this.extraButtons.length <= this.maxButtons || idx < this.maxButtons - 1) {\n        externals = `${externals} instructure_external_button_${this.extraButtons[idx].id}`\n      } else if (!externals.match(/instructure_external_button_clump/)) {\n        externals += ' instructure_external_button_clump'\n      }\n    }\n    return externals\n  }\n\n  /**\n   * uses externally provided settings to decide which instructure\n   * plugin buttons to enable, and returns that string of button names.\n   *\n   * @private\n   * @return {String} comma delimited set of non-core buttons\n   */\n  buildInstructureButtons() {\n    let instructure_buttons = ` instructure_image instructure_equation${\n      window.ENV.use_rce_enhancements ? ' lti_tool_dropdown' : ''\n    }`\n    instructure_buttons += this.external_buttons()\n    if (\n      this.instConfig &&\n      this.instConfig.allowMediaComments &&\n      this.instConfig.kalturaSettings &&\n      !this.instConfig.kalturaSettings.hide_rte_button\n    ) {\n      instructure_buttons += ' instructure_record'\n    }\n    const equella_button =\n      this.instConfig && this.instConfig.equellaEnabled ? ' instructure_equella' : ''\n    instructure_buttons += equella_button\n    return instructure_buttons\n  }\n\n  /**\n   * groups of buttons that are always found together, so updating a config\n   * name doesn't need to happen 3 places or not work.\n   * @private\n   */\n  formatBtnGroup =\n    'bold italic underline forecolor backcolor removeformat alignleft aligncenter alignright'\n\n  positionBtnGroup = 'outdent indent superscript subscript bullist numlist'\n\n  fontBtnGroup = 'ltr rtl fontsizeselect formatselect check_a11y'\n\n  /**\n   * usese the width to decide how many lines of buttons to break\n   * up the toolbar over.\n   *\n   * @private\n   * @return {Array<String>} each element is a string of button names\n   *   representing the buttons to appear on the n-th line of the toolbar\n   */\n  balanceButtons(instructure_buttons) {\n    const instBtnGroup = `table media instructure_links unlink${instructure_buttons}`\n    let buttons1 = ''\n    let buttons2 = ''\n    let buttons3 = ''\n\n    if (this.viewportWidth < 359 && this.viewportWidth > 0) {\n      buttons1 = this.formatBtnGroup\n      buttons2 = `${this.positionBtnGroup} ${instBtnGroup}`\n      buttons3 = this.fontBtnGroup\n    } else if (this.viewportWidth < 1200) {\n      buttons1 = `${this.formatBtnGroup} ${this.positionBtnGroup}`\n      buttons2 = `${instBtnGroup} ${this.fontBtnGroup}`\n    } else {\n      buttons1 = `${this.formatBtnGroup} ${this.positionBtnGroup} ${instBtnGroup} ${this.fontBtnGroup}`\n    }\n    if (window.ENV.use_rce_enhancements) {\n      return [buttons1, buttons2, buttons3]\n    } else {\n      return [buttons1, buttons2, buttons3].map(b => b.split(' ').join(','))\n    }\n  }\n\n  /**\n   * builds the custom buttons, and hands them off to be munged\n   * in with the core buttons and balanced across the toolbar.\n   *\n   * @private\n   * @return {Array<String>} each element is a string of button names\n   *   representing the buttons to appear on the n-th line of the toolbar\n   */\n  toolbar() {\n    const instructure_buttons = this.buildInstructureButtons()\n    return this.balanceButtons(instructure_buttons)\n  }\n}\n","/*\n * Copyright (C) 2015 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport EditorConfig from 'tinymce.config'\nimport setupAndFocusTinyMCEConfig from 'setupAndFocusTinyMCEConfig'\nimport INST from 'INST'\n\nfunction editorOptions(width, id, tinyMCEInitOptions, enableBookmarkingOverride, tinymce) {\n  const editorConfig = new EditorConfig(tinymce, INST, width, id)\n\n  // RichContentEditor takes care of the autofocus functionality at a higher level\n  const autoFocus = undefined\n\n  return {\n    ...editorConfig.defaultConfig(),\n    ...setupAndFocusTinyMCEConfig(tinymce, autoFocus, enableBookmarkingOverride),\n    ...(tinyMCEInitOptions.tinyOptions || {})\n  }\n}\n\nexport default editorOptions\n","/*\n * Copyright (C) 2015 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery'\n\nexport default function setupAndFocusTinyMCEConfig(tinymce, autoFocus, enableBookmarkingOverride) {\n  if (enableBookmarkingOverride == undefined) {\n    var enableBookmarking = false\n  } else {\n    var enableBookmarking = enableBookmarkingOverride\n  }\n\n  return {\n    auto_focus: autoFocus,\n    setup(ed) {\n      const $editor = $('#' + ed.id)\n      // KeyboardShortcuts.coffee needs to listen to events\n      // fired from inside the editor, so we pass out\n      // keyup events to the document\n      ed.on('keyup', e => {\n        $(document).trigger('editorKeyUp', [e])\n      })\n\n      ed.on('change', () => {\n        $editor.trigger('change')\n      })\n\n      // no equivalent of \"onEvent\" in tinymce4\n      ed.on('keyup keydown click mousedown', () => {\n        if (enableBookmarking && ed.selection) {\n          $editor.data('last_bookmark', ed.selection.getBookmark(1))\n        }\n      })\n\n      if (!ENV.use_rce_enhancements) {\n        ed.on('init', () => {\n          const getDefault = mod => (mod.default ? mod.default : mod)\n          const EditorAccessibility = getDefault(require('compiled/editor/editorAccessibility'))\n          new EditorAccessibility(ed).accessiblize()\n        })\n      }\n\n      ed.on('init', () => {\n        $(window).triggerHandler('resize')\n\n        // this is a hack so that when you drag an image from the sidebar to the editor that it doesn't\n        // try to embed the thumbnail but rather the full size version of the image.\n        // so basically, to document why and how this works: in wiki_sidebar.js we add the\n        // _mce_src=\"http://path/to/the/fullsize/image\" to the images whose src=\"path/to/thumbnail/of/image/\"\n        // what this does is check to see if some DOM node that got inserted into the editor has the attribute _mce_src\n        // and if it does, use that instead.\n        $(ed.contentDocument).bind('DOMNodeInserted', e => {\n          let target = e.target,\n            mceSrc\n          if (\n            target.nodeType === 1 &&\n            target.nodeName === 'IMG' &&\n            (mceSrc = $(target).data('url'))\n          ) {\n            $(target).attr('src', tinymce.activeEditor.documentBaseURI.toAbsolute(mceSrc))\n          }\n        })\n\n        // tiny sets a focusout event handler, which only IE supports\n        // (Chrome/Safari/Opera support DOMFocusOut, FF supports neither)\n        // we attach a blur event that does the same thing (which in turn\n        // ensures the change callback fires)\n        // this fixes FF's broken behavior (http://www.tinymce.com/develop/bugtracker_view.php?id=4004 )\n        // as well as an issue in Safari where tiny didn't register some\n        // change events if the previously focused element was a numerical\n        // quiz input (something to do with changing its value in a change\n        // handler)\n        if (!('onfocusout' in ed.contentWindow)) {\n          $(ed.contentWindow).blur(e => {\n            if (!ed.removed && ed.undoManager.typing) {\n              ed.undoManager.typing = false\n              ed.undoManager.add()\n            }\n          })\n        }\n      })\n    } // function setup()\n  }\n}\n","// this file was auto-generated by rake i18n:generate_js.\n// you probably shouldn't edit it directly\nimport mergeI18nTranslations from 'mergeI18nTranslations';\n\n// we use JSON.parse here instead of just loading it as a javascript object literal\n// because according to https://v8.dev/blog/cost-of-javascript-2019#json that is faster\nmergeI18nTranslations(JSON.parse(\"{\\\"ar\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"مزيد من الأدوات الخارجية\\\"}},\\\"cy\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Mwy o Adnoddau Allanol\\\"}},\\\"da\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Flere eksterne værktøjer\\\"}},\\\"da-x-k12\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Flere eksterne værktøjer\\\"}},\\\"de\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Weitere externe Tools\\\"}},\\\"el\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Περισσότερα Εξωτερικά Εργαλεία\\\"}},\\\"en-AU\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"More External Tools\\\"}},\\\"en-CA\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"More External Tools\\\"}},\\\"en-GB\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"More external tools\\\"}},\\\"es\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Más herramientas externas\\\"}},\\\"fa\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"ابزارهای بیرونی دیگر\\\"}},\\\"fi\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Lisää ulkoisia työkaluja\\\"}},\\\"fr\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Plus d’outils externes\\\"}},\\\"fr-CA\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Plus d’outils externes\\\"}},\\\"he\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"כלים חיצוניים נוספים\\\"}},\\\"ht\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Plis Zouti Ekstèn\\\"}},\\\"hu\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"További külső eszközök\\\"}},\\\"hy\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Լրացուցիչ արտաքին գործիքներ\\\"}},\\\"is\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Fleiri ytri tæki\\\"}},\\\"it\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Altri strumenti esterni\\\"}},\\\"ja\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"その他の外部ツール\\\"}},\\\"ko\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"더 많은 외부 도구\\\"}},\\\"mi\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Ētahi atu Utauta waho\\\"}},\\\"nb\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Flere eksterne verktøy\\\"}},\\\"nb-x-k12\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Flere eksterne verktøy\\\"}},\\\"nl\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Meerdere externe tools\\\"}},\\\"nn\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Fleire eksterne verktøy\\\"}},\\\"pl\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Więcej zewnętrznych narzędzi\\\"}},\\\"pt\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Mais ferramentas externas\\\"}},\\\"pt-BR\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Mais ferramentas externas\\\"}},\\\"ru\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Больше внешних инструментов\\\"}},\\\"sv\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Fler externa verktyg\\\"}},\\\"sv-x-k12\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Fler externa verktyg\\\"}},\\\"tr\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"Daha Fazla Harici Araç\\\"}},\\\"zh-Hans\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"更多外部工具\\\"}},\\\"zh-Hant\\\":{\\\"ExternalToolsPlugin\\\":{\\\"more_external_tools\\\":\\\"更多外部工具\\\"}}}\"));\n","\n    import I18n from 'i18nObj';\n    \n      import 'translations/ExternalToolsPlugin';\n      import 'translations/_core';\n    \n    import 'translations/_core_en';\n\n    export default I18n.scoped('ExternalToolsPlugin');\n  ","/*\n * Copyright (C) 2011 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery'\n\n/**\n * TL;DR: Remove this file when possible.\n *\n * Please note that this file is considered very legacy.  All instances of it\n * should be evaluated and replaced with the newer and far better looking\n * KyleMenu.  The only other place that I've seen it in used is the file\n * attendance.js which is on the chopping block at some point in the future.\n * Once that file has been axed, then this file should be able to be removed.\n */\n\n// Simple dropdown list.  Takes the list of attributes specified in \"options\" and displays them\n// in a menu anchored to the selected element.\n$.fn.dropdownList = function(options) {\n  if (this.length) {\n    let $div = $('#instructure_dropdown_list')\n    if (\n      options == 'hide' ||\n      options == 'remove' ||\n      $div.data('current_dropdown_initiator') == this[0]\n    ) {\n      $div.remove().data('current_dropdown_initiator', null)\n      return\n    }\n    var options = $.extend({}, $.fn.dropdownList.defaults, options),\n      $list = $div.children('div.list')\n    if (!$list.length) {\n      $div = $(\n        \"<div id='instructure_dropdown_list'><div class='list ui-widget-content'></div></div>\"\n      ).appendTo('body')\n      $(document)\n        .mousedown(event => {\n          if (\n            $div.data('current_dropdown_initiator') &&\n            !$(event.target).closest('#instructure_dropdown_list').length\n          ) {\n            $div.hide().data('current_dropdown_initiator', null)\n          }\n        })\n        .mouseup(event => {\n          if (\n            $div.data('current_dropdown_initiator') &&\n            !$(event.target).closest('#instructure_dropdown_list').length\n          ) {\n            $div.hide()\n            setTimeout(() => {\n              $div.data('current_dropdown_initiator', null)\n            }, 100)\n          }\n        })\n        .add(this)\n        .add($div)\n        .keydown(event => {\n          if ($div.data('current_dropdown_initiator')) {\n            const $current = $div.find('.ui-state-hover,.ui-state-active')\n            if (event.keyCode == 38) {\n              // up\n              if ($current.length && $current.prev().length) {\n                $current\n                  .removeClass('ui-state-hover ui-state-active')\n                  .addClass('minimal')\n                  .prev()\n                  .addClass('ui-state-hover')\n                  .removeClass('minimal')\n                  .find('span')\n                  .focus()\n              } else {\n                $item.focus()\n              }\n              return false\n            } else if (event.keyCode == 40) {\n              // down\n              if (!$current.length) {\n                $div\n                  .find('.option:first')\n                  .addClass('ui-state-hover')\n                  .removeClass('minimal')\n                  .find('span')\n                  .focus()\n              } else if ($current.next().length) {\n                $current\n                  .removeClass('ui-state-hover ui-state-active')\n                  .addClass('minimal')\n                  .next()\n                  .addClass('ui-state-hover')\n                  .removeClass('minimal')\n                  .find('span')\n                  .focus()\n              }\n              return false\n            } else if (event.keyCode == 13 && $current.length) {\n              $current.click()\n              return false\n            } else {\n              $div.hide().data('current_dropdown_initiator', null)\n            }\n          }\n        })\n      $div\n        .find('.option')\n        .removeClass('ui-state-hover ui-state-active')\n        .addClass('minimal')\n      $div.click(event => {\n        $div.hide().data('current_dropdown_initiator', null)\n      })\n      $list = $div.children('div.list')\n    }\n    $div.data('current_dropdown_initiator', this[0])\n    if (options.width) {\n      $div.width(options.width)\n    }\n    if (options.height) {\n      $div.find('.list').css('maxHeight', options.height)\n    }\n    $list.empty()\n    $.each(options.options, (optionHtml, callback) => {\n      const $option = $(\n        \"<div class='option minimal' style='cursor: pointer; padding: 2px 5px; overflow: hidden; white-space: nowrap;'>\" +\n          \"  <span tabindex='-1'>\" +\n          optionHtml +\n          '</span>' +\n          '</div>'\n      ).appendTo($list)\n      function unhoverOtherOptions() {\n        $option\n          .parent()\n          .find('div.option')\n          .removeClass('ui-state-hover ui-state-active')\n          .addClass('minimal')\n      }\n      if ($.isFunction(callback)) {\n        $option.addClass('ui-state-default').bind({\n          mouseenter() {\n            unhoverOtherOptions()\n            $option.addClass('ui-state-hover').removeClass('minimal')\n          },\n          mouseleave: unhoverOtherOptions,\n          mousedown(event) {\n            event.preventDefault()\n            unhoverOtherOptions()\n            $option.addClass('ui-state-active').removeClass('minimal')\n          },\n          mouseup: unhoverOtherOptions,\n          click: callback\n        })\n      } else {\n        $option.addClass('ui-state-disabled').bind({\n          mousedown(event) {\n            event.preventDefault()\n          }\n        })\n      }\n    })\n    const offset = this.offset(),\n      height = this.outerHeight(),\n      width = this.outerWidth()\n\n    $div\n      .css({\n        whiteSpace: 'nowrap',\n        position: 'absolute',\n        top: offset.top + height,\n        left: offset.left + 5,\n        right: ''\n      })\n      .hide()\n      .show()\n\n    // this is a fix so that if the dropdown ends up being off the page then move it back in so that it is on the page.\n    if ($div.offset().left + $div.width() > $(window).width()) {\n      $div.css({left: '', right: 0})\n    }\n  }\n  return this\n}\n$.fn.dropdownList.defaults = {height: 250, width: 'auto'}\n","/*\n * Copyright (C) 2015 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport htmlEscape from '../../str/htmlEscape'\nimport '../../jquery.dropdownList'\nimport '../../jquery.instructure_misc_helpers'\n\n/**\n * A module for holding helper functions pulled out of the instructure_external_tools/plugin.\n *\n * This should make it easy to seperate and test logic as this evolves\n * without splitting out another module, and since the plugin gets\n * registered with tinymce rather than returned, we can return this\n * object at the end of the module definition as an export for unit testing.\n *\n * @exports\n */\n\nexport default {\n  /**\n   * build the TinyMCE configuration hash for each\n   * LTI button.  Call once for each button to add\n   * to the toolbar\n   *\n   * the \"widget\" and \"btn\" classes are what tinymce\n   * provides by default and the theme makes use of them,\n   * if you don't include them than our custom class\n   * overwrites the default classes and all the styles break\n   *\n   * @param {Hash (representing a button)} button a collection of name, id,\n   *   icon_url to use for building the right config for an external plugin\n   *\n   * @returns {Hash} appropriate configuration for a tinymce addButton call,\n   *   complete with title, cmd, image, and classes\n   */\n  buttonConfig(button, editor) {\n    const config = {\n      title: button.name,\n      classes: 'widget btn instructure_external_tool_button'\n    }\n    if (ENV.use_rce_enhancements) {\n      config.id = button.id\n      config.onAction = () => editor.execCommand(`instructureExternalButton${button.id}`)\n      config.description = button.description\n    } else {\n      config.cmd = `instructureExternalButton${button.id}`\n    }\n\n    if (button.canvas_icon_class) {\n      config.icon = `hack-to-avoid-mce-prefix ${button.canvas_icon_class}`\n    } else {\n      // default to image\n      config.image = button.icon_url\n    }\n\n    return config\n  },\n\n  /**\n   * convert the button clump configuration to\n   * an associative array where the key is an image tag\n   * with the name and the value is the thing to do\n   * when that button gets clicked.  This gives us\n   * a decent structure for mapping click events for\n   * each dynamically generated button in the button clump\n   * list.\n   *\n   * @param {Array<Hash (representing a button)>} clumpedButtons an array of\n   *   button configs, like the ones passed into \"buttonConfig\"\n   *   above as parameters\n   *\n   * @param {function(Hash), editor} onClickHandler the function that should get\n   *   called when this button gets clicked\n   *\n   * @returns {Hash<string,function(Hash)>} the hash we can use\n   *   for generating a dropdown list in jquery\n   */\n  clumpedButtonMapping(clumpedButtons, ed, onClickHandler) {\n    return clumpedButtons.reduce((items, button) => {\n      let key\n\n      // added  data-tool-id='\"+ button.id +\"' to make elements unique when the have the same name\n      if (button.canvas_icon_class) {\n        key = `<i class='${htmlEscape(button.canvas_icon_class)}' data-tool-id='${button.id}'></i>`\n      } else {\n        // icon_url is implied\n        key = `<img src='${htmlEscape(button.icon_url)}' data-tool-id='${button.id}'/>`\n      }\n      key += `&nbsp;${htmlEscape(button.name)}`\n      items[key] = function() {\n        onClickHandler(button, ed)\n      }\n      return items\n    }, {})\n  },\n\n  /**\n   * extend the dropdown menu for all the buttons\n   * clumped up into the \"externalButtonClump\", and attach\n   * an event to the editor so that whenever you click\n   * anywhere else on the editor the dropdown goes away.\n   *\n   * @param {jQuery Object} target the Dom element we're attaching\n   *   this dropdown list to\n   * @param {Hash<string,function(Hash)>} buttons the buttons to put\n   *   into the dropdown list, typically generated from 'clumpedButtonMapping'\n   * @param {tinymce.Editor} editor the relevant editor for this\n   *   dropdown list, to whom we will listen for any click events\n   *   outside the dropdown menu\n   */\n  attachClumpedDropdown(target, buttons, editor) {\n    target.dropdownList({options: buttons})\n    editor.on('click', () => {\n      target.dropdownList('hide')\n    })\n  }\n}\n","/*\n * Copyright (C) 2015 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery'\nimport {send} from 'jsx/shared/rce/RceCommandShim'\n\n/**\n * This is not yet a complete extraction, but the idea is to continue\n * moving direct interactions with the relevant tinymce editor\n * out of the link plugin itself and into this proxy object.\n *\n * The need first arose in response to an IE11 bug where some state\n * (specifically the currently selected content) needed to be extracted\n * and held onto at the time the link modal is generated, because IE11\n * loses the editor carat on a modal activation.  Rather than\n * use variables with very broad scope in the plugin itself to capture the\n * state at one point and use in another, this hides the temporary\n * persistance inside a kind of decorator.\n *\n * @param {tinymce.Editor} editor the tinymce instance we want\n *   to add links to\n * @param {jquery.Object} $editorEl an optional override for the editor target\n *   that can be found in normal circumstances by calling \"getEditor\"\n */\nconst LinkableEditor = function(editor, $editorEl) {\n  this.id = editor.id\n  this.selectedContent = editor.selection.getContent()\n  this.selectionDetails = {\n    node: editor.selection.getNode(),\n    range: editor.selection.getRng()\n  }\n  this.$editorEl = $editorEl\n\n  /**\n   * Builds a jquery object wrapping the target text area for the\n   * wrapped tinymce editor. Can be overridden in the constructor with\n   * an optional second parameter.\n   *\n   * @returns {jquery.Object}\n   */\n  this.getEditor = function() {\n    if (this.$editorEl !== undefined) {\n      return this.$editorEl\n    }\n    return $('#' + this.id)\n  }\n\n  /**\n   * proxies through a call to our jquery extension that puts new link\n   * html into an existing tinymce editor.  Specifically useful\n   * because of the \"selectedContent\" and \"selectedRange\" which are stored\n   * at the time the link creation dialog is created (this is important\n   * because in IE11 that information is lost as soon as the modal dialog\n   * comes up)\n   *\n   * @param {String} text the interior content for the a tag\n   * @param {String} classes any css classes to apply to the new link\n   * @param {Object} [dataAttrs] key value pairs for link data attributes\n   */\n  this.createLink = function(text, classes, dataAttrs) {\n    send(this.getEditor(), 'create_link', {\n      url: text,\n      classes,\n      selectedContent: this.selectedContent,\n      dataAttributes: dataAttrs,\n      selectionDetails: this.selectionDetails\n    })\n  }\n}\n\nexport default LinkableEditor\n","/*\n * Copyright (C) 2017 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery'\n\nexport default class YouTubeApi {\n  fetchYouTubeTitle(id, cb) {\n    const jwt = ENV.JWT\n    const appHost = ENV.RICH_CONTENT_APP_HOST\n    const url = `//${appHost}/api/youtube_title?vid_id=${id}`\n    $.ajax({\n      headers: {Authorization: `Bearer ${jwt}`},\n      url\n    })\n      .success(data => {\n        if (data.id === id) {\n          cb(data.title)\n        }\n      })\n      .error(err => {\n        cb(null, err)\n      })\n  }\n\n  titleYouTubeText($link) {\n    const id = $.youTubeID($link.attr('href'))\n    this.fetchYouTubeTitle(id, (vidTitle, err) => {\n      if (err) {\n        console.error(`failed to get video title from youtube for \"${id}\":`, err.responseText)\n        const yttFailCnt = (+$link.attr('data-ytt-failcnt') || 0) + 1\n        $link.attr('data-ytt-failcnt', yttFailCnt)\n      } else {\n        $link.text(vidTitle)\n        $link.attr('data-preview-alt', vidTitle)\n      }\n    })\n  }\n}\n","/*\n * Copyright (C) 2017 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery'\nimport htmlEscape from '../../str/htmlEscape'\nimport LinkableEditor from './linkable_editor'\nimport {send} from 'jsx/shared/rce/RceCommandShim'\nimport {findLinkForService, getUserServices} from '../../findLinkForService'\nimport '../../jquery.instructure_misc_helpers'\nimport 'jqueryui/dialog'\nimport '../../jquery.instructure_misc_plugins'\nimport YouTubeApi from './youtube_api'\n\n// TODO: Allow disabling of inline media as well.  Right now\n// the link is just '#' so disabling it actually ruins it.  It'd\n// be nice if the link were a URL to download the media file.\nconst inlineContentClasses = ['instructure_scribd_file']\n// Only allow non-intrusive types to be auto-opened (i.e. don't\n// allow auto-playing of video files on page load)\nconst autoShowContentClasses = ['instructure_scribd_file']\n\nconst initializedEditors = new WeakMap()\n\n/**\n * Finds the closest img tag and extracts the 'src' attribute,\n * which then gets pulled into a new string as the src attribute\n * for an img tag to be written through into a tinymce IFrame editor.\n *\n * @param {JQuery Object} target the dom element to grab the nearest img to\n *\n * @returns {string} an image tag string with the src pulled in\n */\nfunction buttonToImg(target) {\n  const src = target.closest('img').attr('src')\n  return \"<img src='\" + htmlEscape(src) + \"'/>\"\n}\n\n/**\n * snapshots the current state of the editor (nodeChanged) so that a refocus\n * later will git the right selection involved, then wraps the editor\n * in a linkable editor which knows some of the selection state\n * at the time of link activation and can proxy the actual link call\n * through to our custom linkification method in tinymce.editor_box\n *\n * @param {tinymce.Editor} editor the instance we want to linkify something\n *   within\n *\n * @returns {LinkableEditor}\n */\nfunction prepEditorForDialog(editor) {\n  editor.nodeChanged()\n  return new LinkableEditor(editor)\n}\n\n/**\n * When inserting a link into the editor, we only want to have control\n * classes on them if they've been explicitly asked for through\n * the UI checkboxes.  This function is used to transform\n * link attributes at the time of edit/insertion. It strips off any\n * control classes that are prexisting, and then only adds them on\n * if the checkboxes are populated.\n *\n * @param {String} priorClasses existing class list from the link\n *   element (which would be empty for new links, populated for editing\n *   links)\n *\n * @param {JQuery Object} box the dialog box the UI for creating a link\n *   is within\n *\n * @returns {String} a transformed class list based on the rules listed\n *   above\n */\nfunction buildLinkClasses(priorClasses, $box) {\n  let classes = priorClasses.replace(/(auto_open|inline_disabled)/g, '')\n  if ($box.find('.auto_show_inline_content').attr('checked')) {\n    classes += ' auto_open'\n  }\n  if ($box.find('.disable_inline_content').attr('checked')) {\n    classes += ' inline_disabled'\n  }\n  return classes\n}\n\n/**\n * this takes the dialog box that provides the form for inputting\n * a link target, clears off any submit callbacks that are currently\n * attached to it, and attaches a *new* submit callback to populate\n * link data into the correct editor.\n *\n * @param {JQuery Object} box this is the dialog box div we want to address\n *\n * @param {LinkableEditor} linkableEditor the wrapped editor that knows how\n *  to attach links to selected content\n *\n * @param {function} fetchClasses I hate that we need this parameter.\n *   the priorClasses state is maintained in a pseudo-global string\n *   that gets modulated throughout the life of this plugin.  That\n *   means just passing it in at the time we do the binding gives us\n *   a blank value.  The callback delays the query until the submit\n *   button fires, by which time priorClasses might be populated.  The\n *   real solution here is to de-global-ify the priorClasses variable,\n *   but that refactor is for another day.\n *\n * @param {function} done any behavior you want to happen after the link\n *   has been inserted into the editor\n */\nfunction bindLinkSubmit($box, linkableEditor, fetchClasses, done) {\n  const $form = $box.find('#instructure_link_prompt_form')\n  $form.off('submit')\n  $form.on('submit', function(event) {\n    event.preventDefault()\n    event.stopPropagation()\n    const $editor = $box.data('editor')\n    const text = $(this)\n      .find('.prompt')\n      .val()\n    const alt = $box.find('.inst-link-preview-alt input').val()\n    const classes = buildLinkClasses(fetchClasses.call(), $box)\n    const dataAttrs = {'preview-alt': alt}\n    $box.dialog('close')\n    linkableEditor.createLink(text, classes, dataAttrs)\n    done.call()\n  })\n}\n\nfunction renderDialog(ed) {\n  const linkableEditor = prepEditorForDialog(ed)\n  const $editor = linkableEditor.getEditor()\n  var $box = $('#instructure_link_prompt')\n  let priorClasses = ''\n  $box\n    .removeClass('for_inline_content')\n    .find('.disable_enhancement')\n    .hide()\n    .end()\n    .find('.auto_show')\n    .hide()\n    .end()\n    .find('.insert_button')\n    .text('Insert Link')\n    .end()\n    .find('.disable_inline_content')\n    .attr('checked', false)\n    .end()\n    .find('.auto_show_inline_content')\n    .attr('checked', false)\n  if ($box.length == 0) {\n    var $box = $(document.createElement('div'))\n    getUserServices('BookmarkService', function(data) {\n      const $editor = $box.data('editor')\n      const $services = $(\"<div style='text-align: left; margin-left: 20px;'/>\")\n      let service, $service\n      for (const idx in data) {\n        service = data[idx].user_service\n        if (service) {\n          $service = $(\"<a href='#' class='bookmark_service no-hover'/>\")\n          $service.addClass(service.service)\n          $service.data('service', service)\n          $service.attr('title', 'Find links using ' + service.service)\n          const $img = $('<img/>')\n          $img.attr('src', '/images/' + service.service + '_small_icon.png')\n          $service.append($img)\n          $service.click(function(event) {\n            event.preventDefault()\n            $('#instructure_link_prompt').dialog('close')\n            findLinkForService($(this).data('service').service, data => {\n              $('#instructure_link_prompt').dialog('close')\n              send($editor, 'create_link', {\n                title: data.title,\n                url: data.url,\n                classes: priorClasses\n              })\n            })\n          })\n          $services.append($service)\n          $services.append('&nbsp;&nbsp;')\n        }\n      }\n      $box.find('#instructure_link_prompt_form').after($services)\n    })\n    $box\n      .append(\n        \"<p><em>This will make the selected text a link, or insert a new link if nothing is selected.</em></p> <label for='instructure_link_prompt_form_input'>Paste or type a url or wiki page in the box below:</label><form id='instructure_link_prompt_form' class='form-inline'><input type='text' id='instructure_link_prompt_form_input' class='prompt' class='btn' value='http://'/> <button type='submit' class='insert_button btn'>Insert Link</button></form>\"\n      )\n      .append(\"<div class='actions'></div><div class='clear'></div>\")\n      .append(\n        '<div class=\"inst-link-preview-alt\" style=\"display: none;\"><label>Alt text for inline preview: <input type=\"text\" style=\"display: block;\" /></label></div>'\n      )\n      .append(\n        \"<div class='disable_enhancement' style='display: none;'><input type='checkbox' class='disable_inline_content' id='disable_inline_content'/><label for='disable_inline_content'> Disable inline previews for this link</label></div>\"\n      )\n      .append(\n        \"<div class='auto_show' style='display: none;'><input type='checkbox' class='auto_show_inline_content' id='auto_show_inline_content'/><label for='auto_show_inline_content'> Auto-open the inline preview for this link</label></div>\"\n      )\n\n    $box.find('.disable_inline_content').change(function() {\n      if ($(this).attr('checked')) {\n        $box.find('.auto_show_inline_content').attr('checked', false)\n      }\n      $box\n        .find('.auto_show')\n        .showIf(!$(this).attr('checked') && $box.hasClass('for_inline_content_can_auto_show'))\n    })\n    $box.find('.actions').delegate('.embed_image_link', 'click', event => {\n      const $editor = $box.data('editor')\n      const $target = $(event.target)\n      event.preventDefault()\n      send($editor, 'insert_code', buttonToImg($target))\n      $box.dialog('close')\n    })\n    // http://img.youtube.com/vi/BOegH4uYe-c/3.jpg\n    $box.find('.actions').delegate('.embed_youtube_link', 'click', event => {\n      event.preventDefault()\n      $box.find('#instructure_link_prompt_form').triggerHandler('submit')\n    })\n    $box.find('#instructure_link_prompt_form .prompt').bind('change keyup', function() {\n      const $alt = $box.find('.inst-link-preview-alt')\n      $alt.hide()\n      $('#instructure_link_prompt .actions').empty()\n      const val = $(this).val()\n      // If the user changes the link then it should no longer\n      // have inline content classes or be configurable\n      const data = $box.data('original_data')\n      if (!data || val != data.url) {\n        $box.removeClass('for_inline_content').removeClass('for_inline_content_can_auto_show')\n        const re = new RegExp('(' + inlineContentClasses.join('|') + ')', 'g')\n        priorClasses = priorClasses.replace(re, '')\n      } else {\n        $box\n          .toggleClass('for_inline_content', data.for_inline_content)\n          .toggleClass('for_inline_content_can_auto_show', data.for_inline_content_can_auto_show)\n          .find('.disable_enhancement')\n          .showIf(data.for_inline_content)\n          .end()\n          .find('.auto_show')\n          .showIf(data.for_inline_content_can_auto_show)\n        priorClasses = data.prior_classes\n      }\n      let hideDisableEnhancement = !$box.hasClass('for_inline_content')\n      const hideShowInline = !$box.hasClass('for_inline_content_can_auto_show')\n\n      if (val.match(/\\.(gif|png|jpg|jpeg)$/)) {\n        var $div = $(document.createElement('div'))\n        $div.css('textAlign', 'center')\n        var $img = $(document.createElement('img'))\n        $img.attr('src', val)\n        $img.addClass('embed_image_link')\n        $img.css('cursor', 'pointer')\n        const img = new Image()\n        img.src = val\n        var checkCompletion = function() {\n          if (img.complete) {\n            if (img.height < 100 || (img.height > 100 && img.height < 200)) {\n              $img.height(img.height)\n            }\n          } else {\n            setTimeout(checkCompletion, 500)\n          }\n        }\n        setTimeout(checkCompletion, 500)\n        $img.height(100)\n        $img.attr('title', 'Click to Embed the Image')\n        $div.append($img)\n        $('#instructure_link_prompt .actions').append($div)\n      } else if (val.match(INST.youTubeRegEx)) {\n        $alt.show()\n        const id = $.youTubeID(val) // val.match(INST.youTubeRegEx)[2];\n        var $div = $(document.createElement('div'))\n        $div.css('textAlign', 'center')\n        if (\n          !$box.find('.disable_inline_content').attr('checked') &&\n          $box.hasClass('for_inline_content_can_auto_show')\n        ) {\n          $box.find('.auto_show').show()\n        }\n        hideDisableEnhancement = false\n        $box.find('.disable_enhancement').show()\n        var $img = $(document.createElement('img'))\n        $img.attr('src', 'http://img.youtube.com/vi/' + id + '/2.jpg')\n        $img.css({\n          paddingLeft: 100,\n          background: 'url(/images/youtube_logo.png) no-repeat left center',\n          height: 90,\n          display: 'inline-block'\n        })\n        $img.attr('alt', val)\n        $img.addClass('embed_youtube_link')\n        $img.css('cursor', 'pointer')\n        $img.attr('title', 'Click to Embed YouTube Video')\n        $div.append($img)\n        $('#instructure_link_prompt .actions').append($div)\n      }\n      if (hideDisableEnhancement) {\n        $box.find('.disable_enhancement').hide()\n        $box.find('.disable_inline_content').attr('checked', false)\n      }\n      if (hideShowInline) {\n        $box.find('.auto_show').hide()\n        $box.find('.auto_show_inline_content').attr('checked', false)\n      }\n    })\n    $box.attr('id', 'instructure_link_prompt')\n    $('body').append($box)\n  } // END of if($box.length == 0), everything above only happens once\n\n  // Bind in the callback to fire when the user has entered\n  // the link target they want and hit \"submit\"\n  const fetchClasses = function() {\n    return priorClasses\n  }\n  const done = function() {\n    updateLinks(ed, true)\n  }\n  bindLinkSubmit($box, linkableEditor, fetchClasses, done)\n\n  $box.data('editor', $editor)\n  $box.data('original_data', null)\n  let e = ed.selection.getNode()\n  while (e.nodeName != 'A' && e.nodeName != 'BODY' && e.parentNode) {\n    e = e.parentNode\n  }\n  const $a = e.nodeName == 'A' ? $(e) : null\n  if ($a) {\n    $box\n      .find('.prompt')\n      .val($a.attr('href'))\n      .change()\n    $box.find('.inst-link-preview-alt input').val($a.data('preview-alt'))\n    priorClasses = ($a.attr('class') || '').replace(/youtube_link_to_box/, '')\n    var re = new RegExp('(' + inlineContentClasses.join('|') + ')')\n    if (($a.attr('class') || '').match(re)) {\n      $box\n        .addClass('for_inline_content')\n        .find('.disable_enhancement')\n        .show()\n    }\n    var re = new RegExp('(' + autoShowContentClasses.join('|') + ')')\n    if (($a.attr('class') || '').match(re)) {\n      $box\n        .addClass('for_inline_content_can_auto_show')\n        .find('.auto_show')\n        .show()\n    }\n    $box.data('original_data', {\n      url: $a.attr('href'),\n      for_inline_content: $box.hasClass('for_inline_content'),\n      for_inline_content_can_auto_show: $box.hasClass('for_inline_content_can_auto_show'),\n      prior_classes: priorClasses,\n      preview_alt: $a.data('preview-alt')\n    })\n    $box\n      .find('.disable_inline_content')\n      .attr('checked', $a.hasClass('inline_disabled'))\n      .triggerHandler('change')\n    $box\n      .find('.auto_show_inline_content')\n      .attr('checked', $a.hasClass('auto_open'))\n      .triggerHandler('change')\n    $box.find('.insert_button').text('Update Link')\n  } else {\n    $box\n      .find('.prompt')\n      .val('')\n      .change()\n  }\n  $box.dialog({\n    width: 425,\n    height: 'auto',\n    title: 'Link to Website URL',\n    open() {\n      $(this)\n        .find('.prompt')\n        .focus()\n        .select()\n    }\n  })\n}\n\nfunction updateLinks(ed, arg) {\n  updateLinks.counter = updateLinks.counter || 0\n  if (arg == true && updateLinks.counter != 0) {\n    updateLinks.counter = (updateLinks.counter + 1) % 5\n  } else {\n    $(ed.getBody())\n      .find('a')\n      .each(function() {\n        const yt_api = new YouTubeApi()\n        const $link = $(this)\n        if (\n          $link.attr('href') &&\n          !$link.hasClass('inline_disabled') &&\n          $link.attr('href').match(INST.youTubeRegEx)\n        ) {\n          const yttFailCnt = +$link.attr('data-ytt-failcnt') || 0\n          $link.addClass('youtube_link_to_box')\n          if ($link.text() === $link.attr('href') && yttFailCnt < 1) {\n            yt_api.titleYouTubeText($link)\n          }\n        }\n      })\n  }\n}\n\nfunction initEditor(ed) {\n  if (initializedEditors.get(ed) || ed.on === undefined) {\n    return\n  }\n  ed.on('PreProcess', function(event) {\n    $(event.node)\n      .find('a.youtube_link_to_box')\n      .removeClass('youtube_link_to_box')\n    $(event.node)\n      .find('img.iframe_placeholder')\n      .each(function() {\n        const $holder = $(this)\n        const $frame = $('<iframe/>')\n        const height = $holder.attr('height') || $holder.css('height')\n        const width = $holder.hasClass('fullWidth')\n          ? '100%'\n          : $holder.attr('width') || $holder.css('width')\n\n        $holder.attr('width', width)\n        $holder.css('width', width)\n        $frame.attr('src', $holder.attr('rel'))\n        $frame.attr('style', $holder.attr('_iframe_style'))\n        if (!$frame[0].style.height.length) {\n          $frame.attr('height', height)\n          $frame.css('height', height)\n        }\n        if (!$frame[0].style.width.length) {\n          $frame.attr('width', width)\n          $frame.css('width', width)\n        }\n        $(this).after($frame)\n        $(this).remove()\n      })\n  })\n  ed.on('change', () => {\n    updateLinks(ed)\n  })\n  ed.on('SetContent', () => {\n    updateLinks(ed, 'contentJustSet')\n  })\n  initializedEditors.set(ed, true)\n}\n\nexport default {\n  buttonToImg,\n  prepEditorForDialog,\n  buildLinkClasses,\n  bindLinkSubmit,\n  renderDialog,\n  updateLinks,\n  initEditor\n}\n","/*\n * Copyright (C) 2015 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport I18n from 'i18n!ExternalToolsPlugin'\nimport $ from 'jquery'\nimport htmlEscape from '../../str/htmlEscape'\nimport ExternalToolsHelper from './ExternalToolsHelper'\nimport iframeAllowances from 'jsx/external_apps/lib/iframeAllowances'\nimport Links from '../instructure_links/links'\nimport React from 'react'\nimport ReactDOM from 'react-dom'\n\nconst TRANSLATIONS = {\n  get more_external_tools() {\n    return htmlEscape(I18n.t('more_external_tools', 'More External Tools'))\n  }\n}\n\nconst ExternalToolsPlugin = {\n  init(ed, url, _INST) {\n    Links.initEditor(ed)\n    if (!_INST || !_INST.editorButtons || !_INST.editorButtons.length) {\n      return\n    }\n\n    let dialog = {\n      // if somehow open gets called early, keep trying until it is ready\n      open: (...args) => setTimeout(() => dialog.open(...args), 50)\n    }\n    import('jsx/editor/ExternalToolDialog').then(({default: ExternalToolDialog}) => {\n      const dialogContainer = document.createElement('div')\n      document.body.appendChild(dialogContainer)\n      ReactDOM.render(\n        <ExternalToolDialog\n          win={window}\n          editor={ed}\n          contextAssetString={ENV.context_asset_string}\n          iframeAllowances={iframeAllowances()}\n          resourceSelectionUrl={$('#context_external_tool_resource_selection_url').attr('href')}\n          deepLinkingOrigin={ENV.DEEP_LINKING_POST_MESSAGE_ORIGIN}\n        />,\n        dialogContainer,\n        function() {\n          dialog = this\n        }\n      )\n    })\n\n    const clumpedButtons = []\n    const ltiButtons = []\n    for (let idx = 0; _INST.editorButtons && idx < _INST.editorButtons.length; idx++) {\n      const current_button = _INST.editorButtons[idx]\n      // eslint-disable-next-line no-loop-func\n      const openDialog = () => dialog.open(current_button)\n      if (ENV.use_rce_enhancements) {\n        ltiButtons.push(ExternalToolsHelper.buttonConfig(current_button, ed))\n        ed.addCommand(`instructureExternalButton${current_button.id}`, openDialog)\n      } else if (\n        _INST.editorButtons.length > _INST.maxVisibleEditorButtons &&\n        idx >= _INST.maxVisibleEditorButtons - 1\n      ) {\n        clumpedButtons.push(current_button)\n      } else {\n        ed.addCommand(`instructureExternalButton${current_button.id}`, openDialog)\n        ed.addButton(\n          `instructure_external_button_${current_button.id}`,\n          ExternalToolsHelper.buttonConfig(current_button, ed)\n        )\n      }\n    }\n    if (ltiButtons.length && ENV.use_rce_enhancements) {\n      ed.ui.registry.addButton('lti_tool_dropdown', {\n        onAction: () => {\n          const ev = new CustomEvent('tinyRCE/onExternalTools', {detail: {ltiButtons}})\n          document.dispatchEvent(ev)\n        },\n        icon: 'lti',\n        tooltip: 'Apps'\n      })\n    }\n    if (clumpedButtons.length) {\n      const handleClick = function() {\n        const items = ExternalToolsHelper.clumpedButtonMapping(clumpedButtons, ed, button =>\n          dialog.open(button)\n        )\n        ExternalToolsHelper.attachClumpedDropdown($(`#${this._id}`), items, ed)\n      }\n\n      if (ENV.use_rce_enhancements) {\n        ed.ui.registry.addButton('instructure_external_button_clump', {\n          title: TRANSLATIONS.more_external_tools,\n          image: '/images/downtick.png',\n          onAction: handleClick\n        })\n      } else {\n        ed.addButton('instructure_external_button_clump', {\n          title: TRANSLATIONS.more_external_tools,\n          image: '/images/downtick.png',\n          onkeyup(event) {\n            if (event.keyCode === 32 || event.keyCode === 13) {\n              event.stopPropagation()\n              handleClick.call(this)\n            }\n          },\n          onclick: handleClick\n        })\n      }\n    }\n  }\n}\n\nexport default ExternalToolsPlugin\n","/*\n * Copyright (C) 2016 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nconst editorExtensions = {\n  call(methodName, ...args) {\n    // since exists? has a ? and cant be a regular function (yet we want\n    // the same signature as editorbox) just return true rather than\n    // calling as a fn on the editor\n    if (methodName === 'exists?') {\n      return true\n    }\n    return this[methodName](...args)\n  },\n\n  focus() {\n    if (tinymce !== undefined) {\n      const editor = tinymce.get(this._textareaEl.id)\n      editor && editor.focus(true)\n    }\n  }\n}\n\nconst sidebarExtensions = {\n  show() {\n    // TODO generalize/adapt this once in service\n    $('#editor_tabs').show()\n  },\n\n  hide() {\n    // TODO generalize/adapt this once in service\n    $('#editor_tabs').hide()\n  }\n}\n\nconst polyfill = {\n  wrapEditor(editor) {\n    const extensions = {...editorExtensions, ...editor}\n    return Object.assign(editor, extensions)\n  },\n\n  wrapSidebar(sidebar) {\n    const extensions = {...sidebarExtensions, ...sidebar}\n    return Object.assign(sidebar, extensions)\n  }\n}\n\nexport default polyfill\n","/*\n * Copyright (C) 2015 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery'\nimport _ from 'underscore'\nimport {refreshFn as refreshToken} from '../jwt'\nimport editorOptions from './editorOptions'\nimport loadEventListeners from './loadEventListeners'\nimport polyfill from './polyfill'\nimport splitAssetString from 'compiled/str/splitAssetString'\nimport closedCaptionLanguages from '../closedCaptionLanguages'\n\nasync function getTinyInstance(remoteEditor) {\n  // eslint-disable-next-line no-unused-vars\n  return new Promise((resolve, reject) => {\n    let ed = remoteEditor.mceInstance()\n    if (ed) {\n      resolve(ed)\n    } else {\n      const iid = setInterval(() => {\n        ed = remoteEditor.mceInstance()\n        if (ed) {\n          clearInterval(iid)\n          resolve(ed)\n        }\n      }, 1000)\n    }\n  })\n}\n\nfunction getTrayProps() {\n  if (!ENV.context_asset_string) {\n    return null\n  }\n  let contextType, contextId\n  const userId = ENV.current_user_id\n\n  // set in rich_content.rb if user has :manage_files right\n  // though comment says it may (eventually) be in the jwt\n  // TODO: look into that.\n  if (ENV.use_rce_enhancements && !ENV.RICH_CONTENT_CAN_UPLOAD_FILES) {\n    contextId = userId\n    contextType = 'user'\n  } else {\n    ;[contextType, contextId] = splitAssetString(ENV.context_asset_string, false)\n  }\n\n  return {\n    canUploadFiles: ENV.RICH_CONTENT_CAN_UPLOAD_FILES,\n    containingContext: {contextType, contextId, userId}, // this will remain constant\n    contextType, // these will change via the UI\n    contextId,\n    filesTabDisabled: ENV.RICH_CONTENT_FILES_TAB_DISABLED,\n    host: ENV.RICH_CONTENT_APP_HOST,\n    jwt: ENV.JWT,\n    refreshToken: refreshToken(ENV.JWT),\n    themeUrl: ENV.active_brand_config_json_url,\n    liveRegion: () => document.getElementById('flash_screenreader_holder')\n  }\n}\n\nlet loadingPromise\n\nconst RCELoader = {\n  preload(cb) {\n    // since we are just preloading, let other stuff waiting to run go first so we don't slow pageload\n    ;(window.requestIdleCallback || window.setTimeout)(() => this.loadRCE(cb))\n  },\n\n  loadOnTarget(target, tinyMCEInitOptions, callback) {\n    const textarea = this.getTargetTextarea(target)\n    const renderingTarget = this.getRenderingTarget(textarea, tinyMCEInitOptions.getRenderingTarget)\n    const propsForRCE = this.createRCEProps(textarea, tinyMCEInitOptions)\n\n    if (ENV?.FEATURES?.la_620_old_rce_init_fix) {\n      // in the old rce using an old tinymce, it's possible renderIntoDiv's callback is called\n      // before tinymce adds the new editor to its internal list, and remoteEditor.mceInstance()\n      // wil return null. Waiting on getTinyInstance works around that.\n      // Put it back to the simple `else` case once the old rce is no longer used\n      this.loadRCE(RCE => {\n        RCE.renderIntoDiv(renderingTarget, propsForRCE, async remoteEditor => {\n          const tinyed = await getTinyInstance(remoteEditor)\n          tinyed.on('init', () => callback(textarea, polyfill.wrapEditor(remoteEditor)))\n        })\n      })\n    } else {\n      this.loadRCE(RCE => {\n        RCE.renderIntoDiv(renderingTarget, propsForRCE, remoteEditor => {\n          remoteEditor\n            .mceInstance()\n            .on('init', () => callback(textarea, polyfill.wrapEditor(remoteEditor)))\n        })\n      })\n    }\n  },\n\n  loadSidebarOnTarget(target, callback) {\n    if (ENV.RICH_CONTENT_SKIP_SIDEBAR) {\n      return\n    }\n\n    const props = getTrayProps()\n\n    this.loadRCE(RCE => {\n      RCE.renderSidebarIntoDiv(target, props, remoteSidebar => {\n        callback(polyfill.wrapSidebar(remoteSidebar))\n      })\n    })\n  },\n\n  /**\n   * properties for managing several requests to load\n   * the module from various pieces of canvas code.\n   *\n   * @private\n   */\n  loadingCallbacks: [],\n  RCE: null,\n\n  /**\n   * handle accepting new load requests depending on the current state\n   * of the load/cache cycle.\n   *\n   * @return {Promise}\n   * @private\n   */\n  loadRCE(cb = () => {}) {\n    if (!loadingPromise) {\n      loadingPromise = (window.ENV.use_rce_enhancements\n        ? import(/* webpackChunkName: \"canvas-rce-async-chunk\" */ './canvas-rce-and-a11y-checker')\n        : import(\n            /* webpackChunkName: \"canvas-rce-old-async-chunk\" */ './canvas-rce-old-and-a11y-checker'\n          )\n      ).then(RCE => {\n        this.RCE = RCE\n        loadEventListeners()\n        return RCE\n      })\n    }\n    return loadingPromise.then(() => {\n      this.loadingCallbacks.forEach(loadingCallback => loadingCallback(this.RCE))\n      this.loadingCallbacks = []\n      cb(this.RCE)\n    })\n  },\n\n  /**\n   * sometimes we get passed a container that has the\n   * textarea nested within it, we want to normalize to\n   * just using whatever textarea is going to be bound to\n   * the editor\n   *\n   * @private\n   * @return {Element} the textarea\n   */\n  getTargetTextarea(initialTarget) {\n    return $(initialTarget).get(0).type === 'textarea'\n      ? $(initialTarget).get(0)\n      : $(initialTarget)\n          .find('textarea')\n          .get(0)\n  },\n\n  /**\n   * the immediate parent of the textarea is the container\n   * we want to render the remote react component inside, so it's\n   * a sibiling with the actual form element being populated.\n   *\n   * @private\n   * @return {Element} container element for rendering remote editor\n   */\n  getRenderingTarget(textarea, getTargetFn = undefined) {\n    let renderingTarget\n\n    if (typeof getTargetFn === 'undefined') {\n      renderingTarget = $(textarea)\n        .parent()\n        .get(0)\n    } else {\n      renderingTarget = getTargetFn(textarea)\n    }\n    $(renderingTarget).addClass('ic-RichContentEditor')\n\n    return renderingTarget\n  },\n\n  /**\n   * anything that canvas needs to later find this\n   * editor/textarea should be mirrored here so we\n   * dont have to change too much canvas code\n   *\n   * @private\n   * @return {Hash}\n   */\n  _attrsToMirror(textarea) {\n    const validAttrs = ['name']\n    const attrs = _.reduce(\n      textarea.attributes,\n      (memo, attr) => {\n        memo[attr.name] = attr.value\n        return memo\n      },\n      {}\n    )\n\n    return _.pick(attrs, validAttrs)\n  },\n\n  /**\n   * merges options provided by consuming code with some\n   * intelligent defaults so that simple use cases can not\n   * worry about providing repetitive options hashes.\n   *\n   * @private\n   * @return {Hash} ready-to-use options hash to use as react props\n   */\n  createRCEProps(textarea, tinyMCEInitOptions) {\n    const width = textarea.offsetWidth\n    const height = textarea.offsetHeight\n\n    if (height) {\n      tinyMCEInitOptions.tinyOptions = {\n        height,\n        ...(tinyMCEInitOptions.tinyOptions || {})\n      }\n    }\n\n    const myLanguage = ENV.LOCALE\n    const languages = Object.keys(closedCaptionLanguages)\n      .map(locale => {\n        return {id: locale, label: closedCaptionLanguages[locale]}\n      })\n      .sort((a, b) => {\n        if (a.id === myLanguage) {\n          return -1\n        } else if (b.id === myLanguage) {\n          return 1\n        } else {\n          return a.label.localeCompare(b.label, myLanguage)\n        }\n      })\n\n    // when rce_auto_save flag is removed, remember to default\n    // the autosave property in RCEWrapper to reasonable values\n    const autosave = {\n      enabled: ENV.use_rce_enhancements && ENV.rce_auto_save,\n      rce_auto_save_max_age_ms: Number.isNaN(ENV.rce_auto_save_max_age_ms)\n        ? 3600000\n        : ENV.rce_auto_save_max_age_ms\n    }\n\n    return {\n      defaultContent: textarea.value || tinyMCEInitOptions.defaultContent,\n      editorOptions: editorOptions.bind(null, width, textarea.id, tinyMCEInitOptions, null),\n      language: ENV.LOCALE,\n      mirroredAttrs: this._attrsToMirror(textarea),\n      onFocus: tinyMCEInitOptions.onFocus,\n      onBlur: tinyMCEInitOptions.onBlur,\n      textareaClassName: textarea.className,\n      textareaId: textarea.id,\n      trayProps: getTrayProps(),\n      languages,\n      autosave\n    }\n  }\n}\n\nexport default RCELoader\n","/*\n * Copyright (C) 2015 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nimport initializeExternalTools from 'tinymce_plugins/instructure_external_tools/initializeExternalTools'\nimport INST from 'INST'\nimport Links from 'tinymce_plugins/instructure_links/links'\n\nexport default function loadEventListeners(callbacks = {}) {\n  const validCallbacks = [\n    'equationCB',\n    'linksCB',\n    'imagePickerCB',\n    'equellaCB',\n    'externalToolCB',\n    'recordCB'\n  ]\n\n  validCallbacks.forEach(cbName => {\n    if (callbacks[cbName] === undefined) {\n      callbacks[cbName] = function() {\n        /* no-op */\n      }\n    }\n  })\n\n  document.addEventListener('tinyRCE/initEquation', ({detail}) => {\n    import('compiled/views/tinymce/EquationEditorView').then(({default: EquationEditorView}) => {\n      const view = new EquationEditorView(detail.ed)\n      callbacks.equationCB(view)\n    })\n  })\n\n  document.addEventListener('tinyRCE/initLinks', ({detail}) => {\n    Links.renderDialog(detail.ed)\n    callbacks.linksCB()\n  })\n\n  document.addEventListener('tinyRCE/initImagePicker', e => {\n    import('compiled/views/tinymce/InsertUpdateImageView').then(\n      ({default: InsertUpdateImageView}) => {\n        const view = new InsertUpdateImageView(e.detail.ed, e.detail.selectedNode)\n        callbacks.imagePickerCB(view)\n      }\n    )\n  })\n\n  document.addEventListener('tinyRCE/initEquella', e => {\n    import('tinymce_plugins/instructure_equella/initializeEquella').then(\n      ({default: initializeEquella}) => {\n        initializeEquella(e.detail.ed)\n        callbacks.equellaCB()\n      }\n    )\n  })\n\n  document.addEventListener('tinyRCE/initExternalTools', e => {\n    initializeExternalTools.init(e.detail.ed, e.detail.url, INST)\n    callbacks.externalToolCB()\n  })\n\n  document.addEventListener('tinyRCE/initRecord', e => {\n    import('tinymce_plugins/instructure_record/mediaEditorLoader').then(\n      ({default: mediaEditorLoader}) => {\n        mediaEditorLoader.insertEditor(e.detail.ed)\n        callbacks.recordCB()\n      }\n    )\n  })\n}\n"],"sourceRoot":""}