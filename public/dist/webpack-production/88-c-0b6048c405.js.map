{"version":3,"sources":["webpack:///./packages/k5uploader/es/md5.js","webpack:///./packages/k5uploader/es/messenger.js","webpack:///./packages/k5uploader/es/message_bus.js","webpack:///./packages/k5uploader/es/xml_parser.js","webpack:///./packages/k5uploader/es/upload_result.js","webpack:///./packages/k5uploader/es/signature_builder.js","webpack:///./packages/k5uploader/es/url_params.js","webpack:///./packages/k5uploader/es/defaults.js","webpack:///./packages/k5uploader/es/k5_options.js","webpack:///./packages/k5uploader/es/kaltura_request_builder.js","webpack:///./packages/k5uploader/es/uploader.js","webpack:///./packages/k5uploader/es/kaltura_session.js","webpack:///./packages/k5uploader/es/session_manager.js","webpack:///./packages/k5uploader/es/entry_service.js","webpack:///./packages/k5uploader/es/object_merge.js","webpack:///./packages/k5uploader/es/ui_config.js","webpack:///./packages/k5uploader/es/file_filter.js","webpack:///./packages/k5uploader/es/ui_config_from_node.js","webpack:///./packages/k5uploader/es/filter_from_node.js","webpack:///./packages/k5uploader/es/uiconf_service.js","webpack:///./packages/k5uploader/es/k5uploader.js"],"names":["hexcase","hex_md5","s","rstr2hex","rstr_md5","str2rstr_utf8","binl2rstr","binl_md5","rstr2binl","length","input","hex_tab","x","output","i","charCodeAt","charAt","y","String","fromCharCode","Array","len","a","b","c","d","olda","oldb","oldc","oldd","md5_ff","md5_gg","md5_hh","md5_ii","safe_add","md5_cmn","q","t","num","cnt","lsw","module","exports","encrypt","Messenger","this","events","decorate","instance","messenger","addEventListener","eventName","method","dispatchEvent","data","context","removeEventListener","targetMethod","prototype","killAllListeners","destroy","forEach","eventHandler","call","push","eventHandlers","removalQueue","index","element","splice","XmlParser","parseXML","xml","$xml","$","determineError","isError","find","children","nodeName","findRecursive","nodes","split","found","currentNode","l","nodeText","name","node","asNumber","res","text","parseFloat","UploadResult","token","filename","fileId","xmlParser","pullData","$resultOk","asEntryParams","entry1_name","entry1_filename","entry1_realFilename","names","prop","params","sort","queryUrl","encodeURIComponent","substring","passed","isPresent","options","K5Options","setOptions","mergeDefaults","allowedMediaTypes","sessionUrl","uploadUrl","entryUrl","uiconfUrl","entryDefaults","partnerData","conversionProfile","source","kshow_id","quick_edit","defaults","entry1_partnerData","entry1_conversionProfile","entry1_source","KalturaRequestBuilder","settings","file","xhr","id","createRequest","XMLHttpRequest","open","createUrl","responseType","createFormData","formData","FormData","append","createFileId","Date","now","toString","config","getSession","kalsig","createSignature","buildRequest","getFile","getSettings","Uploader","uploadResult","isAvailable","upload","send","session","kRequest","addEventListeners","eventProxy","bind","onload","event","response","resultStatus","type","KalturaSession","ks","subp_id","partner_id","uid","serverTime","setSession","obj","ui_conf_id","SessionManager","sessionData","loadSession","onSessionLoaded","e","target","status","EntryService","addEntry","allParams","objs","combined","reverse","createEntryRequest","requestType","onEntryRequestLoaded","ent","title","context_code","mediaType","entryId","userTitle","UiConfig","fileFilters","maxUploads","maxFileSize","maxTotalSize","addFileFilter","fileFilter","filterFor","fileName","filter","f","extension","pop","includesExtension","toParams","acceptableFileSize","fileSize","acceptableFileType","types","currentFilter","indexOf","acceptableFile","size","FileFilter","extensions","parseExtensions","description","entryType","extString","map","ext","toLowerCase","entry1_type","entry1_mediaType","limits","attr","filters","getAttribute","UiconfService","load","sessionSettings","onXhrLoad","createUiConfig","conf","first","K5Uploader","buildDependencies","addListeners","kaltura_session","loadUiConf","entryService","uiconfService","onUiConfError","onUiConfComplete","onUploadError","onUploadSuccess","onProgress","onEntrySuccess","onEntryFail","result","uiconfig","uploadFile","includes","uploader","details"],"mappings":"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","file":"88-c-0b6048c405.js","sourcesContent":["/*\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\n * Digest Algorithm, as defined in RFC 1321.\n * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for more info.\n */\n\n/*\n * Configurable variables. You may need to tweak these to be compatible with\n * the server-side, but the defaults work in most cases.\n */\nlet hexcase = 0;\n/* hex output format. 0 - lowercase; 1 - uppercase        */\n\nlet b64pad = '';\n/* base-64 pad character. \"=\" for strict RFC compliance   */\n\n/*\n * These are the functions you'll usually want to call\n * They take string arguments and return either hex or base-64 encoded strings\n */\n\nfunction hex_md5(s) {\n  return rstr2hex(rstr_md5(str2rstr_utf8(s)));\n}\n\nfunction b64_md5(s) {\n  return rstr2b64(rstr_md5(str2rstr_utf8(s)));\n}\n\nfunction any_md5(s, e) {\n  return rstr2any(rstr_md5(str2rstr_utf8(s)), e);\n}\n\nfunction hex_hmac_md5(k, d) {\n  return rstr2hex(rstr_hmac_md5(str2rstr_utf8(k), str2rstr_utf8(d)));\n}\n\nfunction b64_hmac_md5(k, d) {\n  return rstr2b64(rstr_hmac_md5(str2rstr_utf8(k), str2rstr_utf8(d)));\n}\n\nfunction any_hmac_md5(k, d, e) {\n  return rstr2any(rstr_hmac_md5(str2rstr_utf8(k), str2rstr_utf8(d)), e);\n}\n/*\n * Perform a simple self-test to see if the VM is working\n */\n\n\nfunction md5_vm_test() {\n  return hex_md5('abc').toLowerCase() == '900150983cd24fb0d6963f7d28e17f72';\n}\n/*\n * Calculate the MD5 of a raw string\n */\n\n\nfunction rstr_md5(s) {\n  return binl2rstr(binl_md5(rstr2binl(s), s.length * 8));\n}\n/*\n * Calculate the HMAC-MD5, of a key and some data (raw strings)\n */\n\n\nfunction rstr_hmac_md5(key, data) {\n  let bkey = rstr2binl(key);\n  if (bkey.length > 16) bkey = binl_md5(bkey, key.length * 8);\n  const ipad = Array(16),\n        opad = Array(16);\n\n  for (let i = 0; i < 16; i++) {\n    ipad[i] = bkey[i] ^ 0x36363636;\n    opad[i] = bkey[i] ^ 0x5c5c5c5c;\n  }\n\n  const hash = binl_md5(ipad.concat(rstr2binl(data)), 512 + data.length * 8);\n  return binl2rstr(binl_md5(opad.concat(hash), 512 + 128));\n}\n/*\n * Convert a raw string to a hex string\n */\n\n\nfunction rstr2hex(input) {\n  try {\n    hexcase;\n  } catch (e) {\n    hexcase = 0;\n  }\n\n  const hex_tab = hexcase ? '0123456789ABCDEF' : '0123456789abcdef';\n  let output = '';\n  let x;\n\n  for (let i = 0; i < input.length; i++) {\n    x = input.charCodeAt(i);\n    output += hex_tab.charAt(x >>> 4 & 0x0f) + hex_tab.charAt(x & 0x0f);\n  }\n\n  return output;\n}\n/*\n * Convert a raw string to a base-64 string\n */\n\n\nfunction rstr2b64(input) {\n  try {\n    b64pad;\n  } catch (e) {\n    b64pad = '';\n  }\n\n  const tab = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n  let output = '';\n  const len = input.length;\n\n  for (let i = 0; i < len; i += 3) {\n    const triplet = input.charCodeAt(i) << 16 | (i + 1 < len ? input.charCodeAt(i + 1) << 8 : 0) | (i + 2 < len ? input.charCodeAt(i + 2) : 0);\n\n    for (let j = 0; j < 4; j++) {\n      if (i * 8 + j * 6 > input.length * 8) output += b64pad;else output += tab.charAt(triplet >>> 6 * (3 - j) & 0x3f);\n    }\n  }\n\n  return output;\n}\n/*\n * Convert a raw string to an arbitrary string encoding\n */\n\n\nfunction rstr2any(input, encoding) {\n  const divisor = encoding.length;\n  let i, j, q, x, quotient;\n  /* Convert to an array of 16-bit big-endian values, forming the dividend */\n\n  let dividend = Array(Math.ceil(input.length / 2));\n\n  for (i = 0; i < dividend.length; i++) {\n    dividend[i] = input.charCodeAt(i * 2) << 8 | input.charCodeAt(i * 2 + 1);\n  }\n  /*\n   * Repeatedly perform a long division. The binary array forms the dividend,\n   * the length of the encoding is the divisor. Once computed, the quotient\n   * forms the dividend for the next step. All remainders are stored for later\n   * use.\n   */\n\n\n  const full_length = Math.ceil(input.length * 8 / (Math.log(encoding.length) / Math.log(2)));\n  const remainders = Array(full_length);\n\n  for (j = 0; j < full_length; j++) {\n    quotient = Array();\n    x = 0;\n\n    for (i = 0; i < dividend.length; i++) {\n      x = (x << 16) + dividend[i];\n      q = Math.floor(x / divisor);\n      x -= q * divisor;\n      if (quotient.length > 0 || q > 0) quotient[quotient.length] = q;\n    }\n\n    remainders[j] = x;\n    dividend = quotient;\n  }\n  /* Convert the remainders to the output string */\n\n\n  let output = '';\n\n  for (i = remainders.length - 1; i >= 0; i--) output += encoding.charAt(remainders[i]);\n\n  return output;\n}\n/*\n * Encode a string as utf-8.\n * For efficiency, this assumes the input is valid utf-16.\n */\n\n\nfunction str2rstr_utf8(input) {\n  let output = '';\n  let i = -1;\n  let x, y;\n\n  while (++i < input.length) {\n    /* Decode utf-16 surrogate pairs */\n    x = input.charCodeAt(i);\n    y = i + 1 < input.length ? input.charCodeAt(i + 1) : 0;\n\n    if (x >= 0xd800 && x <= 0xdbff && y >= 0xdc00 && y <= 0xdfff) {\n      x = 0x10000 + ((x & 0x03ff) << 10) + (y & 0x03ff);\n      i++;\n    }\n    /* Encode output as utf-8 */\n\n\n    if (x <= 0x7f) output += String.fromCharCode(x);else if (x <= 0x7ff) output += String.fromCharCode(0xc0 | x >>> 6 & 0x1f, 0x80 | x & 0x3f);else if (x <= 0xffff) output += String.fromCharCode(0xe0 | x >>> 12 & 0x0f, 0x80 | x >>> 6 & 0x3f, 0x80 | x & 0x3f);else if (x <= 0x1fffff) output += String.fromCharCode(0xf0 | x >>> 18 & 0x07, 0x80 | x >>> 12 & 0x3f, 0x80 | x >>> 6 & 0x3f, 0x80 | x & 0x3f);\n  }\n\n  return output;\n}\n/*\n * Encode a string as utf-16\n */\n\n\nfunction str2rstr_utf16le(input) {\n  let output = '';\n\n  for (let i = 0; i < input.length; i++) output += String.fromCharCode(input.charCodeAt(i) & 0xff, input.charCodeAt(i) >>> 8 & 0xff);\n\n  return output;\n}\n\nfunction str2rstr_utf16be(input) {\n  let output = '';\n\n  for (let i = 0; i < input.length; i++) output += String.fromCharCode(input.charCodeAt(i) >>> 8 & 0xff, input.charCodeAt(i) & 0xff);\n\n  return output;\n}\n/*\n * Convert a raw string to an array of little-endian words\n * Characters >255 have their high-byte silently ignored.\n */\n\n\nfunction rstr2binl(input) {\n  const output = Array(input.length >> 2);\n\n  for (var i = 0; i < output.length; i++) output[i] = 0;\n\n  for (var i = 0; i < input.length * 8; i += 8) output[i >> 5] |= (input.charCodeAt(i / 8) & 0xff) << i % 32;\n\n  return output;\n}\n/*\n * Convert an array of little-endian words to a string\n */\n\n\nfunction binl2rstr(input) {\n  let output = '';\n\n  for (let i = 0; i < input.length * 32; i += 8) output += String.fromCharCode(input[i >> 5] >>> i % 32 & 0xff);\n\n  return output;\n}\n/*\n * Calculate the MD5 of an array of little-endian words, and a bit length.\n */\n\n\nfunction binl_md5(x, len) {\n  /* append padding */\n  x[len >> 5] |= 0x80 << len % 32;\n  x[(len + 64 >>> 9 << 4) + 14] = len;\n  let a = 1732584193;\n  let b = -271733879;\n  let c = -1732584194;\n  let d = 271733878;\n\n  for (let i = 0; i < x.length; i += 16) {\n    const olda = a;\n    const oldb = b;\n    const oldc = c;\n    const oldd = d;\n    a = md5_ff(a, b, c, d, x[i + 0], 7, -680876936);\n    d = md5_ff(d, a, b, c, x[i + 1], 12, -389564586);\n    c = md5_ff(c, d, a, b, x[i + 2], 17, 606105819);\n    b = md5_ff(b, c, d, a, x[i + 3], 22, -1044525330);\n    a = md5_ff(a, b, c, d, x[i + 4], 7, -176418897);\n    d = md5_ff(d, a, b, c, x[i + 5], 12, 1200080426);\n    c = md5_ff(c, d, a, b, x[i + 6], 17, -1473231341);\n    b = md5_ff(b, c, d, a, x[i + 7], 22, -45705983);\n    a = md5_ff(a, b, c, d, x[i + 8], 7, 1770035416);\n    d = md5_ff(d, a, b, c, x[i + 9], 12, -1958414417);\n    c = md5_ff(c, d, a, b, x[i + 10], 17, -42063);\n    b = md5_ff(b, c, d, a, x[i + 11], 22, -1990404162);\n    a = md5_ff(a, b, c, d, x[i + 12], 7, 1804603682);\n    d = md5_ff(d, a, b, c, x[i + 13], 12, -40341101);\n    c = md5_ff(c, d, a, b, x[i + 14], 17, -1502002290);\n    b = md5_ff(b, c, d, a, x[i + 15], 22, 1236535329);\n    a = md5_gg(a, b, c, d, x[i + 1], 5, -165796510);\n    d = md5_gg(d, a, b, c, x[i + 6], 9, -1069501632);\n    c = md5_gg(c, d, a, b, x[i + 11], 14, 643717713);\n    b = md5_gg(b, c, d, a, x[i + 0], 20, -373897302);\n    a = md5_gg(a, b, c, d, x[i + 5], 5, -701558691);\n    d = md5_gg(d, a, b, c, x[i + 10], 9, 38016083);\n    c = md5_gg(c, d, a, b, x[i + 15], 14, -660478335);\n    b = md5_gg(b, c, d, a, x[i + 4], 20, -405537848);\n    a = md5_gg(a, b, c, d, x[i + 9], 5, 568446438);\n    d = md5_gg(d, a, b, c, x[i + 14], 9, -1019803690);\n    c = md5_gg(c, d, a, b, x[i + 3], 14, -187363961);\n    b = md5_gg(b, c, d, a, x[i + 8], 20, 1163531501);\n    a = md5_gg(a, b, c, d, x[i + 13], 5, -1444681467);\n    d = md5_gg(d, a, b, c, x[i + 2], 9, -51403784);\n    c = md5_gg(c, d, a, b, x[i + 7], 14, 1735328473);\n    b = md5_gg(b, c, d, a, x[i + 12], 20, -1926607734);\n    a = md5_hh(a, b, c, d, x[i + 5], 4, -378558);\n    d = md5_hh(d, a, b, c, x[i + 8], 11, -2022574463);\n    c = md5_hh(c, d, a, b, x[i + 11], 16, 1839030562);\n    b = md5_hh(b, c, d, a, x[i + 14], 23, -35309556);\n    a = md5_hh(a, b, c, d, x[i + 1], 4, -1530992060);\n    d = md5_hh(d, a, b, c, x[i + 4], 11, 1272893353);\n    c = md5_hh(c, d, a, b, x[i + 7], 16, -155497632);\n    b = md5_hh(b, c, d, a, x[i + 10], 23, -1094730640);\n    a = md5_hh(a, b, c, d, x[i + 13], 4, 681279174);\n    d = md5_hh(d, a, b, c, x[i + 0], 11, -358537222);\n    c = md5_hh(c, d, a, b, x[i + 3], 16, -722521979);\n    b = md5_hh(b, c, d, a, x[i + 6], 23, 76029189);\n    a = md5_hh(a, b, c, d, x[i + 9], 4, -640364487);\n    d = md5_hh(d, a, b, c, x[i + 12], 11, -421815835);\n    c = md5_hh(c, d, a, b, x[i + 15], 16, 530742520);\n    b = md5_hh(b, c, d, a, x[i + 2], 23, -995338651);\n    a = md5_ii(a, b, c, d, x[i + 0], 6, -198630844);\n    d = md5_ii(d, a, b, c, x[i + 7], 10, 1126891415);\n    c = md5_ii(c, d, a, b, x[i + 14], 15, -1416354905);\n    b = md5_ii(b, c, d, a, x[i + 5], 21, -57434055);\n    a = md5_ii(a, b, c, d, x[i + 12], 6, 1700485571);\n    d = md5_ii(d, a, b, c, x[i + 3], 10, -1894986606);\n    c = md5_ii(c, d, a, b, x[i + 10], 15, -1051523);\n    b = md5_ii(b, c, d, a, x[i + 1], 21, -2054922799);\n    a = md5_ii(a, b, c, d, x[i + 8], 6, 1873313359);\n    d = md5_ii(d, a, b, c, x[i + 15], 10, -30611744);\n    c = md5_ii(c, d, a, b, x[i + 6], 15, -1560198380);\n    b = md5_ii(b, c, d, a, x[i + 13], 21, 1309151649);\n    a = md5_ii(a, b, c, d, x[i + 4], 6, -145523070);\n    d = md5_ii(d, a, b, c, x[i + 11], 10, -1120210379);\n    c = md5_ii(c, d, a, b, x[i + 2], 15, 718787259);\n    b = md5_ii(b, c, d, a, x[i + 9], 21, -343485551);\n    a = safe_add(a, olda);\n    b = safe_add(b, oldb);\n    c = safe_add(c, oldc);\n    d = safe_add(d, oldd);\n  }\n\n  return Array(a, b, c, d);\n}\n/*\n * These functions implement the four basic operations the algorithm uses.\n */\n\n\nfunction md5_cmn(q, a, b, x, s, t) {\n  return safe_add(bit_rol(safe_add(safe_add(a, q), safe_add(x, t)), s), b);\n}\n\nfunction md5_ff(a, b, c, d, x, s, t) {\n  return md5_cmn(b & c | ~b & d, a, b, x, s, t);\n}\n\nfunction md5_gg(a, b, c, d, x, s, t) {\n  return md5_cmn(b & d | c & ~d, a, b, x, s, t);\n}\n\nfunction md5_hh(a, b, c, d, x, s, t) {\n  return md5_cmn(b ^ c ^ d, a, b, x, s, t);\n}\n\nfunction md5_ii(a, b, c, d, x, s, t) {\n  return md5_cmn(c ^ (b | ~d), a, b, x, s, t);\n}\n/*\n * Add integers, wrapping at 2^32. This uses 16-bit operations internally\n * to work around bugs in some JS interpreters.\n */\n\n\nfunction safe_add(x, y) {\n  const lsw = (x & 0xffff) + (y & 0xffff);\n  const msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n  return msw << 16 | lsw & 0xffff;\n}\n/*\n * Bitwise rotate a 32-bit number to the left.\n */\n\n\nfunction bit_rol(num, cnt) {\n  return num << cnt | num >>> 32 - cnt;\n}\n\nmodule.exports = {\n  encrypt: hex_md5\n};","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nMessenger.decorate = function (instance) {\n  instance.messenger = new Messenger();\n\n  instance.addEventListener = function (eventName, method) {\n    instance.messenger.addEventListener(eventName, method);\n  };\n\n  instance.dispatchEvent = function (eventName, data, context) {\n    instance.messenger.dispatchEvent(eventName, data, context);\n  };\n\n  instance.removeEventListener = function (eventName, targetMethod) {\n    instance.messenger.removeEventListener(eventName, targetMethod);\n  };\n};\n\nfunction Messenger() {\n  this.events = {};\n}\n\nMessenger.prototype.killAllListeners = function (eventName) {\n  if (this.events[eventName]) {\n    this.events[eventName] = [];\n  } else {\n    return false;\n  }\n};\n\nMessenger.prototype.destroy = function () {\n  this.events = {};\n};\n\nMessenger.prototype.dispatchEvent = function (eventName, data, context) {\n  if (this.events[eventName]) {\n    this.events[eventName].forEach(eventHandler => {\n      eventHandler.call(context, data);\n    });\n  }\n};\n\nMessenger.prototype.addEventListener = function (eventName, method) {\n  if (!method) {\n    return false;\n  }\n\n  if (!this.events[eventName]) {\n    this.events[eventName] = [];\n  }\n\n  this.events[eventName].push(method);\n  return method;\n};\n\nMessenger.prototype.removeEventListener = function (eventName, targetMethod) {\n  if (this.events[eventName]) {\n    const eventHandlers = this.events[eventName];\n    const removalQueue = [];\n    this.events[eventName].forEach((eventHandler, index) => {\n      if (eventHandler === targetMethod) {\n        removalQueue.push(index);\n      }\n    });\n\n    if (removalQueue.length > 0) {\n      removalQueue.forEach(element => {\n        eventHandlers.splice(element, 1);\n      });\n    }\n  }\n};\n\nexport default Messenger;","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nimport Messenger from './messenger';\nexport default new Messenger();","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nfunction XmlParser() {}\n\nXmlParser.prototype.parseXML = function (xml) {\n  this.$xml = $(xml);\n  this.determineError();\n  return this.$xml;\n};\n\nXmlParser.prototype.determineError = function () {\n  this.isError = !!this.find('error').children().length;\n};\n\nXmlParser.prototype.find = function (nodeName) {\n  return this.$xml.find(nodeName);\n};\n\nXmlParser.prototype.findRecursive = function (nodes) {\n  var nodes = nodes.split(':');\n  let currentNode = this.$xml;\n  let found;\n\n  for (let i = 0, l = nodes.length; i < l; i++) {\n    found = currentNode.find(nodes[i])[0];\n\n    if (!found) {\n      currentNode = void 0;\n      break;\n    } else {\n      currentNode = $(found);\n    }\n  }\n\n  return currentNode;\n};\n\nXmlParser.prototype.nodeText = function (name, node, asNumber) {\n  let res;\n\n  if (node.find(name).text() != '') {\n    res = node.find(name).text();\n\n    if (asNumber === true) {\n      res = parseFloat(res);\n    }\n  }\n\n  return res;\n};\n\nexport default XmlParser;","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nimport XmlParser from './xml_parser';\n\nfunction UploadResult() {\n  this.xml = void 0;\n  this.isError = true;\n  this.token = void 0;\n  this.filename = '';\n  this.fileId = -1;\n  this.xmlParser = new XmlParser();\n}\n\nUploadResult.prototype.parseXML = function (xml) {\n  const $xml = this.xmlParser.parseXML(xml);\n  this.isError = this.xmlParser.isError;\n\n  if (!this.xmlParser.isError) {\n    this.pullData();\n  }\n};\n\nUploadResult.prototype.pullData = function () {\n  const $resultOk = this.xmlParser.find('result_ok');\n  this.token = this.xmlParser.nodeText('token', $resultOk, true);\n  this.fileId = this.xmlParser.nodeText('filename', $resultOk, true);\n  this.filename = this.xmlParser.nodeText('origFilename', $resultOk);\n};\n\nUploadResult.prototype.asEntryParams = function () {\n  return {\n    entry1_name: this.filename,\n    entry1_filename: this.fileId,\n    entry1_realFilename: this.filename\n  };\n};\n\nexport default UploadResult;","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nimport MD5 from './md5';\nexport default function (params) {\n  let names = [];\n\n  for (const prop in params) {\n    names.push(prop);\n  }\n\n  names = names.sort();\n  let s = '';\n  names.forEach(element => {\n    s += element;\n    s += params[element];\n  });\n  return MD5.encrypt(s);\n}","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nexport default function (params) {\n  let queryUrl = '?';\n\n  for (const prop in params) {\n    queryUrl += prop + '=' + encodeURIComponent(params[prop]) + '&';\n  }\n\n  queryUrl = queryUrl.substring(0, queryUrl.length - 1);\n  return queryUrl;\n}","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nfunction isPresent(passed, name) {\n  return passed && passed[name] !== void 0;\n}\n\nexport default function (name, options, passed) {\n  if (isPresent(passed, name)) {\n    options[name] = passed[name];\n  }\n}","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nimport defaults from './defaults';\n\nfunction K5Options() {}\n\nK5Options.prototype.setOptions = function (options) {\n  this.mergeDefaults(options);\n};\n\nK5Options.prototype.mergeDefaults = function (options) {\n  this.allowedMediaTypes = ['video', 'audio'];\n  this.sessionUrl = '/api/v1/services/kaltura_session';\n  this.uploadUrl = '';\n  this.entryUrl = '';\n  this.uiconfUrl = '';\n  this.entryDefaults = {\n    partnerData: \"{'context_code': 'some_course_num', 'root_account'_id':1}\",\n    conversionProfile: 2,\n    source: 1,\n    kshow_id: -1,\n    quick_edit: true\n  };\n  defaults('allowedMediaTypes', this, options);\n  defaults('sessionUrl', this, options);\n  defaults('uploadUrl', this, options);\n  defaults('entryUrl', this, options);\n  defaults('uiconfUrl', this, options);\n  defaults('partnerData', this.entryDefaults, options.entryDefaults);\n  defaults('conversionProfile', this.entryDefaults, options.entryDefaults);\n  defaults('source', this.entryDefaults, options.entryDefaults);\n  defaults('kshow_id', this.entryDefaults, options.entryDefaults);\n  defaults('quick_edit', this.entryDefaults, options.entryDefaults);\n};\n\nK5Options.prototype.asEntryParams = function () {\n  return {\n    entry1_partnerData: this.entryDefaults.partnerData,\n    entry1_conversionProfile: this.entryDefaults.conversionProfile,\n    entry1_source: this.entryDefaults.source,\n    kshow_id: this.entryDefaults.kshow_id,\n    quick_edit: this.entryDefaults.quick_edit\n  };\n};\n\nexport default new K5Options();","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nimport signatureBuilder from './signature_builder';\nimport urlParams from './url_params';\nimport k5Options from './k5_options';\n\nfunction KalturaRequestBuilder() {\n  this.settings, this.file;\n  this.xhr;\n}\n\nKalturaRequestBuilder.id = 1;\n\nKalturaRequestBuilder.prototype.createRequest = function () {\n  const xhr = new XMLHttpRequest();\n  xhr.open('POST', this.createUrl());\n  xhr.responseType = 'xml';\n  return xhr;\n};\n\nKalturaRequestBuilder.prototype.createFormData = function () {\n  const formData = new FormData();\n  formData.append('Filename', this.file.name);\n  formData.append('Filedata', this.file);\n  formData.append('Upload', 'Submit Query');\n  return formData;\n};\n\nKalturaRequestBuilder.prototype.createFileId = function () {\n  KalturaRequestBuilder.id += 1;\n  return Date.now().toString() + KalturaRequestBuilder.id.toString();\n}; // flash uploader sends these as GET query params\n// and file data as POST\n\n\nKalturaRequestBuilder.prototype.createUrl = function () {\n  const config = this.settings.getSession();\n  config.filename = this.createFileId();\n  config.kalsig = this.createSignature();\n  return k5Options.uploadUrl + urlParams(config);\n};\n\nKalturaRequestBuilder.prototype.createSignature = function () {\n  return signatureBuilder(this.settings.getSession());\n};\n\nKalturaRequestBuilder.prototype.buildRequest = function (settings, file) {\n  this.settings = settings;\n  this.file = file;\n  return this.createRequest();\n};\n\nKalturaRequestBuilder.prototype.getFile = function () {\n  return this.file;\n};\n\nKalturaRequestBuilder.prototype.getSettings = function () {\n  return this.settings;\n};\n\nexport default KalturaRequestBuilder;","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nimport mBus from './message_bus';\nimport UploadResult from './upload_result';\nimport KalturaRequestBuilder from './kaltura_request_builder';\n\nfunction Uploader() {\n  this.xhr = new XMLHttpRequest();\n  this.uploadResult = new UploadResult();\n}\n\nUploader.prototype.isAvailable = function () {\n  return !!this.xhr.upload;\n};\n\nUploader.prototype.send = function (session, file) {\n  const kRequest = new KalturaRequestBuilder();\n  this.xhr = kRequest.buildRequest(session, file);\n  this.addEventListeners();\n  this.xhr.send(kRequest.createFormData());\n};\n\nUploader.prototype.addEventListeners = function () {\n  this.xhr.upload.addEventListener('progress', this.eventProxy.bind(this.xhr));\n  this.xhr.upload.addEventListener('load', this.eventProxy.bind(this.xhr));\n  this.xhr.upload.addEventListener('error', this.eventProxy.bind(this.xhr));\n  this.xhr.upload.addEventListener('abort', this.eventProxy.bind(this.xhr));\n  this.xhr.onload = this.onload.bind(this);\n};\n\nUploader.prototype.onload = function (event) {\n  this.uploadResult.parseXML(this.xhr.response);\n  const resultStatus = this.uploadResult.isError ? 'error' : 'success';\n  mBus.dispatchEvent('Uploader.' + resultStatus, this.uploadResult);\n};\n\nUploader.prototype.eventProxy = function (event) {\n  const name = 'Uploader.' + event.type;\n  mBus.dispatchEvent(name, event, this);\n};\n\nexport default Uploader;","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nimport defaults from './defaults';\n\nfunction KalturaSession() {\n  this.ks = '';\n  this.subp_id = '';\n  this.partner_id = '';\n  this.uid = '';\n  this.serverTime = 0;\n}\n\nKalturaSession.prototype.setSession = function (obj) {\n  if (obj) {\n    defaults('ks', this, obj);\n    defaults('subp_id', this, obj);\n    defaults('partner_id', this, obj);\n    defaults('uid', this, obj);\n    defaults('serverTime', this, obj);\n    defaults('ui_conf_id', this, obj);\n  }\n};\n\nKalturaSession.prototype.getSession = function () {\n  return {\n    ks: this.ks,\n    subp_id: this.subp_id,\n    partner_id: this.partner_id,\n    uid: this.uid,\n    serverTime: this.serverTime,\n    ui_conf_id: this.ui_conf_id\n  };\n};\n\nKalturaSession.prototype.asEntryParams = function () {\n  return this.getSession();\n};\n\nexport default KalturaSession;","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nimport messageBus from './message_bus';\nimport k5Options from './k5_options';\nimport KalturaSession from './kaltura_session';\n\nfunction SessionManager() {\n  this.sessionData = new KalturaSession();\n}\n\nSessionManager.prototype.loadSession = function () {\n  const xhr = new XMLHttpRequest();\n  xhr.open('POST', k5Options.sessionUrl, true);\n  xhr.responseType = 'json';\n  xhr.onload = this.onSessionLoaded.bind(this);\n  xhr.send();\n};\n\nSessionManager.prototype.onSessionLoaded = function (e) {\n  const xhr = e.target;\n\n  if (xhr.status == 200) {\n    this.sessionData.setSession(xhr.response);\n    messageBus.dispatchEvent('SessionManager.complete', this.sessionData, this);\n  } else {\n    messageBus.dispatchEvent('SessionManager.error');\n  }\n};\n\nSessionManager.prototype.getSession = function () {\n  return this.sessionData;\n};\n\nexport default SessionManager;","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nimport signatureBuilder from './signature_builder';\nimport urlParams from './url_params';\nimport mBus from './message_bus';\nimport XmlParser from './xml_parser';\nimport objectMerge from './object_merge';\nimport k5Options from './k5_options';\n\nfunction EntryService() {\n  this.xmlParser = new XmlParser();\n}\n\nEntryService.prototype.addEntry = function (allParams) {\n  this.formData = objectMerge(allParams);\n  this.createEntryRequest();\n};\n\nEntryService.prototype.createEntryRequest = function () {\n  const data = this.formData;\n  data.kalsig = signatureBuilder(data);\n  this.xhr = new XMLHttpRequest();\n  this.xhr.open('GET', k5Options.entryUrl + urlParams(data));\n  this.xhr.requestType = 'xml';\n  this.xhr.onload = this.onEntryRequestLoaded.bind(this);\n  this.xhr.send(data);\n};\n\nEntryService.prototype.onEntryRequestLoaded = function (e) {\n  this.xmlParser.parseXML(this.xhr.response);\n  var ent = this.xmlParser.findRecursive('result:entries:entry1_');\n\n  if (ent) {\n    var ent = {\n      id: ent.find('id').text(),\n      type: ent.find('type').text(),\n      title: ent.find('name').text(),\n      context_code: ent.find('partnerData').text(),\n      mediaType: ent.find('mediatype').text(),\n      entryId: ent.find('id').text(),\n      userTitle: void 0\n    };\n    mBus.dispatchEvent('Entry.success', ent, this);\n  } else {\n    mBus.dispatchEvent('Entry.fail', this.xhr.response, this);\n  }\n};\n\nexport default EntryService;","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nexport default function (objs) {\n  if (!objs) {\n    return objs;\n  }\n\n  const combined = {};\n  objs = objs.reverse();\n  objs.forEach(obj => {\n    for (const prop in obj) {\n      combined[prop] = obj[prop];\n    }\n  });\n  return combined;\n}","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nfunction UiConfig(params) {\n  this.fileFilters = [];\n  this.maxUploads = params.maxUploads;\n  this.maxFileSize = params.maxFileSize;\n  this.maxTotalSize = params.maxTotalSize;\n}\n\nUiConfig.prototype.addFileFilter = function (fileFilter) {\n  this.fileFilters.push(fileFilter);\n};\n\nUiConfig.prototype.filterFor = function (fileName) {\n  let filter, f;\n  const extension = fileName.split('.').pop();\n\n  for (let i = 0, len = this.fileFilters.length; i < len; i++) {\n    f = this.fileFilters[i];\n\n    if (f.includesExtension(extension)) {\n      filter = f;\n      break;\n    }\n  }\n\n  return filter;\n};\n\nUiConfig.prototype.asEntryParams = function (fileName) {\n  const currentFilter = this.filterFor(fileName);\n  return currentFilter.toParams();\n};\n\nUiConfig.prototype.acceptableFileSize = function (fileSize) {\n  return this.maxFileSize * 1024 * 1024 > fileSize;\n};\n\nUiConfig.prototype.acceptableFileType = function (fileName, types) {\n  const currentFilter = this.filterFor(fileName);\n\n  if (!currentFilter) {\n    return false;\n  }\n\n  return types.indexOf(currentFilter.id) !== -1;\n};\n\nUiConfig.prototype.acceptableFile = function (file, types) {\n  const type = this.acceptableFileType(file.name, types);\n  const size = this.acceptableFileSize(file.size);\n  return type && size;\n};\n\nexport default UiConfig;","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nfunction FileFilter(params) {\n  this.extensions = this.parseExtensions(params.extensions);\n  this.id = params.id;\n  this.description = params.description;\n  this.entryType = params.entryType;\n  this.mediaType = params.mediaType;\n  this.type = params.type;\n}\n\nFileFilter.prototype.parseExtensions = function (extString) {\n  return extString.split(';').map(ext => ext.substring(2));\n};\n\nFileFilter.prototype.includesExtension = function (extension) {\n  return this.extensions.indexOf(extension.toLowerCase()) !== -1;\n};\n\nFileFilter.prototype.toParams = function () {\n  const params = {\n    entry1_type: this.entryType,\n    entry1_mediaType: this.mediaType\n  };\n  return params;\n};\n\nexport default FileFilter;","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nimport UiConfig from './ui_config';\nimport filterFromNode from './filter_from_node';\nexport default function (xml) {\n  const limits = xml.find('limits');\n  const config = new UiConfig({\n    maxUploads: limits.attr('maxUploads'),\n    maxFileSize: limits.attr('maxFileSize'),\n    maxTotalSize: limits.attr('maxTotalSize')\n  });\n  const filters = xml.find('fileFilters').children();\n\n  for (let i = 0, l = filters.length; i < l; i++) {\n    const filter = filterFromNode(filters[i]);\n    config.addFileFilter(filter);\n  }\n\n  return config;\n}","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nimport FileFilter from './file_filter';\nexport default function (node) {\n  return new FileFilter({\n    id: node.getAttribute('id'),\n    description: node.getAttribute('description'),\n    entryType: node.getAttribute('entryType'),\n    mediaType: node.getAttribute('mediaType'),\n    type: node.getAttribute('type'),\n    extensions: node.getAttribute('extensions')\n  });\n}","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nimport urlParams from './url_params';\nimport signatureBuilder from './signature_builder';\nimport XmlParser from './xml_parser';\nimport UiConfig from './ui_config';\nimport uiConfigFromNode from './ui_config_from_node';\nimport mBus from './message_bus';\nimport k5Options from './k5_options';\n\nfunction UiconfService() {\n  this.xmlParser = new XmlParser();\n}\n\nUiconfService.prototype.load = function (sessionSettings) {\n  const data = sessionSettings.getSession();\n  data.kalsig = signatureBuilder(data);\n  this.xhr = new XMLHttpRequest();\n  this.xhr.open('GET', k5Options.uiconfUrl + urlParams(data));\n  this.xhr.addEventListener('load', this.onXhrLoad.bind(this));\n  this.xhr.send(data);\n};\n\nUiconfService.prototype.createUiConfig = function (xml) {\n  this.config = uiConfigFromNode(xml);\n};\n\nUiconfService.prototype.onXhrLoad = function (event) {\n  this.xmlParser.parseXML(this.xhr.response);\n  const conf = this.xmlParser.find('result').find('ui_conf').find('confFile').first().text();\n\n  if (conf) {\n    this.xmlParser = new XmlParser();\n    this.xmlParser.parseXML(conf);\n    this.config = uiConfigFromNode(this.xmlParser);\n    mBus.dispatchEvent('UiConf.complete', this.config, this);\n  } else {\n    mBus.dispatchEvent('UiConf.error', this.xhr.response, this);\n  }\n};\n\nexport default UiconfService;","/*\n * Copyright (C) 2019 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nimport Uploader from './uploader';\nimport SessionManager from './session_manager';\nimport KalturaSession from './kaltura_session';\nimport mBus from './message_bus';\nimport Messenger from './messenger';\nimport EntryService from './entry_service';\nimport UiconfService from './uiconf_service';\nimport k5Options from './k5_options';\n\nfunction K5Uploader(options) {\n  // set up instance as an event dispatcher\n  Messenger.decorate(this);\n  k5Options.setOptions(options);\n  this.buildDependencies();\n  this.addListeners();\n  this.session.setSession(options.kaltura_session);\n  this.loadUiConf();\n}\n\nK5Uploader.prototype.destroy = function () {\n  mBus.destroy();\n  this.session = void 0;\n  this.entryService = void 0;\n  this.uiconfService = void 0;\n};\n\nK5Uploader.prototype.buildDependencies = function () {\n  this.session = new KalturaSession();\n  this.entryService = new EntryService();\n  this.uiconfService = new UiconfService();\n};\n\nK5Uploader.prototype.addListeners = function () {\n  mBus.addEventListener('UiConf.error', this.onUiConfError.bind(this));\n  mBus.addEventListener('UiConf.complete', this.onUiConfComplete.bind(this));\n  mBus.addEventListener('Uploader.error', this.onUploadError.bind(this));\n  mBus.addEventListener('Uploader.success', this.onUploadSuccess.bind(this));\n  mBus.addEventListener('Uploader.progress', this.onProgress.bind(this));\n  mBus.addEventListener('Entry.success', this.onEntrySuccess.bind(this));\n  mBus.addEventListener('Entry.fail', this.onEntryFail.bind(this));\n};\n\nK5Uploader.prototype.onSessionLoaded = function (data) {\n  this.session = data;\n  this.loadUiConf();\n};\n\nK5Uploader.prototype.loadUiConf = function () {\n  this.uiconfService.load(this.session);\n};\n\nK5Uploader.prototype.onUiConfComplete = function (result) {\n  this.uiconfig = result;\n  this.dispatchEvent('K5.ready', {}, this);\n};\n\nK5Uploader.prototype.uploadFile = function (file) {\n  this.file = file;\n\n  if (!file) {\n    return;\n  }\n\n  if (this.uiconfig.acceptableFile(file, k5Options.allowedMediaTypes) || ['webm', 'video/webm', 'audio/webm'].includes(file.type)) {\n    this.uploader = new Uploader();\n    this.uploader.send(this.session, file);\n  } else {\n    const details = {\n      maxFileSize: this.uiconfig.maxFileSize,\n      file,\n      allowedMediaTypes: k5Options.allowedMediaTypes\n    };\n    this.dispatchEvent('K5.fileError', details, this);\n  }\n};\n\nK5Uploader.prototype.onUploadSuccess = function (result) {\n  // combine all needed data and add an entry to kaltura\n  const allParams = [this.session.asEntryParams(), result.asEntryParams(), k5Options.asEntryParams()];\n  this.entryService.addEntry(allParams);\n}; // Delegate to publicly available K5 events\n\n\nK5Uploader.prototype.onProgress = function (e) {\n  this.dispatchEvent('K5.progress', e, this);\n};\n\nK5Uploader.prototype.onUploadError = function (result) {\n  this.dispatchEvent('K5.error', result, this);\n};\n\nK5Uploader.prototype.onEntrySuccess = function (data) {\n  this.dispatchEvent('K5.complete', data, this);\n};\n\nK5Uploader.prototype.onEntryFail = function (data) {\n  this.dispatchEvent('K5.error', data, this);\n};\n\nK5Uploader.prototype.onUiConfError = function (result) {\n  this.dispatchEvent('K5.uiconfError', result, this);\n};\n\nexport default K5Uploader;"],"sourceRoot":""}