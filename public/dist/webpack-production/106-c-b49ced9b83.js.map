{"version":3,"sources":["webpack:///./public/javascripts/translations/lib.text_helper.js","webpack:///./app/coffeescripts/str/TextHelper.coffee","webpack:///./public/javascripts/dummyI18nResource.js?61ff","webpack:///./public/javascripts/translations/mediaCommentThumbnail.js","webpack:///./public/javascripts/dummyI18nResource.js?5a17","webpack:///./app/coffeescripts/jquery/mediaCommentThumbnail.js","webpack:///./public/javascripts/jquery.templateData.js","webpack:///./app/coffeescripts/object/unflatten.js","webpack:///./app/coffeescripts/util/deparam.js"],"names":["mergeI18nTranslations","JSON","parse","scoped","AUTO_LINKIFY_REGEX","th","quoteClump","lines","htmlEscape","t","raw","join","formatMessage","message","links","placeholderBlocks","replace","match","i","push","link","processedLines","quoteBlock","RegExp","shift","line","length","delimit","number","isNaN","String","sign","abs","Math","result","integer","floor","mod","truncateText","string","options","max","ellipsis","wordSeparator","trim","truncateAt","pos","indexOf","substring","plainText","MEDIA_COMMENT_THUMBNAIL_SIZES","normal","width","height","small","createMediaCommentThumbnail","elem","size","keepOriginalText","INST","kalturaSettings","console","log","idAttr","url","$link","$","a","document","createElement","href","attr","error","deparam","search","no_preview","dimensions","id","data","find","text","parent","authorName","createdAt","altText","I18n","name","domain","resource_domain","backgroundUrl","partner_id","$thumbnail","$p","closest","$a","clone","empty","removeClass","$holder","appendTo","after","prop","addClass","append","css","backgroundImage","padding","fn","mediaCommentThumbnail","this","each","_","defer","fillTemplateData","iterator","andSelf","$el","contentChange","item","except","inArray","dataValues","toString","$found_all","avoid","$found","htmlValues","html","hasClass","tagName","toUpperCase","val","str","e","hrefValues","oldHref","oldRel","oldName","$obj","hasOwnProperty","newHref","replaceTags","encodeURIComponent","orig","triggerHandler","defaults","getTemplateData","textValues","_this","forEach","$item","charCodeAt","$elem","getTemplateValue","value","opts","extend","unflatten","obj","reduce","newObj","key","keys","split","lastKey","test","concat","cur","isArray","coerceTypes","true","false","null","params","coerce","currentQueryString","window","location","arguments","param","decodeURIComponent"],"mappings":"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","file":"106-c-b49ced9b83.js","sourcesContent":["// this file was auto-generated by rake i18n:generate_js.\n// you probably shouldn't edit it directly\nimport mergeI18nTranslations from 'mergeI18nTranslations';\n\n// we use JSON.parse here instead of just loading it as a javascript object literal\n// because according to https://v8.dev/blog/cost-of-javascript-2019#json that is faster\nmergeI18nTranslations(JSON.parse(\"{\\\"ar\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"إظهار النص المقتبس\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"cy\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"dangos testun wedi’i ddyfynnu\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"da\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"vis tekst i gåseøjne\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"da-x-k12\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"vis tekst i gåseøjne\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"de\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"zitierten Text zeigen\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"el\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"προβολή κειμένου που παρατίθεται\\\"}}},\\\"en-AU\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"show quoted text\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"en-CA\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"show quoted text\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"en-GB\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"show quoted text\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"es\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"mostrar texto citado\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"fa\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"نمایش متن نقل شده\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"fi\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"näytä lainattu teksti\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"fr\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"afficher le texte entre guillemets\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"fr-CA\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"afficher le texte entre guillemets\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"he\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"מציג ציטוט\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"ht\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"afiche tèks site\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"hu\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"idézett szöveg megjelenítése\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"hy\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"ցույց տալ մեջբերվող տեքստը\\\",\\\"word_separator\\\":\\\"-\\\"}}},\\\"is\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"Sýna ívitnaðan texta\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"it\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"mostra testo citato\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"ja\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"引用したテキストを表示\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"ko\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"인용된 텍스트 표시\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"mi\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"whakaatu kuputuhi faahiti\\\",\\\"word_separator\\\":\\\"-\\\"}}},\\\"nb\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"vis den merkede teksten\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"nb-x-k12\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"vis den merkede teksten\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"nl\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"geciteerde tekst tonen\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"nn\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"vis sitert tekst\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"pl\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"pokaż cytowany fragment tekstu\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"pt\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"exibir texto citado\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"pt-BR\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"exibir texto citado\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"ru\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"показать цитированный текст\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"sl\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"prikaži citirano besedilo\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"sv\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"visa citerad text\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"sv-x-k12\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"visa citerad text\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"tr\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"alıntılanan metni göster\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"uk\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"Показати цитований текст\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"zh-Hans\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"显示引用的文本\\\",\\\"word_separator\\\":\\\" \\\"}}},\\\"zh-Hant\\\":{\\\"lib\\\":{\\\"text_helper\\\":{\\\"ellipsis\\\":\\\"...\\\",\\\"quoted_text_toggle\\\":\\\"顯示引用的文字\\\",\\\"word_separator\\\":\\\" \\\"}}}}\"));\n","#\n# Copyright (C) 2012 - present Instructure, Inc.\n#\n# This file is part of Canvas.\n#\n# Canvas is free software: you can redistribute it and/or modify it under\n# the terms of the GNU Affero General Public License as published by the Free\n# Software Foundation, version 3 of the License.\n#\n# Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n# A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n# details.\n#\n# You should have received a copy of the GNU Affero General Public License along\n# with this program. If not, see <http://www.gnu.org/licenses/>.\n#\n\nimport $ from 'jquery'\nimport I18n from 'i18n!lib.text_helper'\nimport htmlEscape from 'str/htmlEscape'\n\nAUTO_LINKIFY_PLACEHOLDER = \"LINK-PLACEHOLDER\"\nAUTO_LINKIFY_REGEX = ///\n  \\b\n  (                                            # Capture 1: entire matched URL\n    (?:\n      https?://                                # http or https protocol\n      |                                        # or\n      www\\d{0,3}[.]                            # \"www.\", \"www1.\", \"www2.\" … \"www999.\"\n      |                                        # or\n      [a-z0-9.\\-]+[.][a-z]{2,4}/               # looks like domain name followed by a slash\n    )\n\n    (?:\n      [^\\s()<>]+                               # Run of non-space, non-()<>\n      |                                        # or\n      \\([^\\s()<>]*\\)                           # balanced parens, single level\n    )+\n\n    (?:\n      \\([^\\s()<>]*\\)                           # balanced parens, single level\n      |                                        # or\n      [^\\s`!()\\[\\]{};:'\".,<>?«»“”‘’]           # End with: not a space or one of these punct chars\n    )\n  ) | (\n    LINK-PLACEHOLDER\n  )\n///gi\n\nexport default th =\n  quoteClump: (lines) ->\n    \"<div class='quoted_text_holder'>\n      <a href='#' class='show_quoted_text_link'>#{htmlEscape I18n.t(\"quoted_text_toggle\", \"show quoted text\")}</a>\n      <div class='quoted_text' style='display: none;'>\n        #{$.raw lines.join \"\\n\"}\n      </div>\n    </div>\"\n\n  formatMessage: (message) ->\n    # replace any links with placeholders so we don't escape them\n    links = []\n    placeholderBlocks = []\n    message = message.replace AUTO_LINKIFY_REGEX, (match, i) ->\n      placeholderBlocks.push(if match == AUTO_LINKIFY_PLACEHOLDER\n          AUTO_LINKIFY_PLACEHOLDER\n        else\n          link = match\n          link = \"http://\" + link unless link[0..6] == 'http://' or link[0..7] == 'https://'\n          links.push link\n          \"<a href='#{htmlEscape(link)}'>#{htmlEscape(match)}</a>\"\n      )\n      AUTO_LINKIFY_PLACEHOLDER\n\n    # now escape html\n    message = htmlEscape message\n\n    # now put the links back in\n    message = message.replace new RegExp(AUTO_LINKIFY_PLACEHOLDER, 'g'), (match, i) ->\n      placeholderBlocks.shift()\n\n    # replace newlines\n    message = message.replace /\\n/g, '<br />\\n'\n\n    # generate quoting clumps\n    processedLines = []\n    quoteBlock = []\n    for line in message.split(\"\\n\")\n      if line.match /^(&gt;|>)/\n        quoteBlock.push line\n      else\n        processedLines.push th.quoteClump(quoteBlock) if quoteBlock.length\n        quoteBlock = []\n        processedLines.push line\n    processedLines.push th.quoteClump(quoteBlock) if quoteBlock.length\n    message = processedLines.join \"\\n\"\n\n  delimit: (number) ->\n    # only process real numbers\n    return String(number) if isNaN number\n\n    # capture sign and then start working with the absolute value. don't\n    # process infinities.\n    sign = if number < 0 then '-' else ''\n    abs = Math.abs number\n    return String(number) if abs is Infinity\n\n    # break out the integer portion and initialize the result to just the\n    # decimal (if any)\n    integer = Math.floor abs\n    result = if abs == integer then '' else String(abs).replace(/^\\d+\\./, '.')\n\n    # for each comma'd chunk, prepend to the result and remove from integer\n    while integer >= 1000\n      mod = String(integer).replace(/\\d+(\\d\\d\\d)$/, ',$1')\n      integer = Math.floor integer / 1000\n      result = mod + result\n\n    # integer is now either in [1, 999], or equal to 0 iff number in (-1, 1).\n    # prepend it with the sign\n    sign + String(integer) + result\n\n  truncateText: (string, options = {}) ->\n    max = options.max ? 30\n    ellipsis = I18n.t('ellipsis', '...')\n    wordSeparator = I18n.t('word_separator', ' ')\n\n    string = (string ? \"\").replace(/\\s+/g, wordSeparator).trim()\n    return string if not string or string.length <= max\n\n    truncateAt = 0\n    while true\n      pos = string.indexOf(wordSeparator, truncateAt + 1)\n      break if pos < 0 || pos > max - ellipsis.length\n      truncateAt = pos\n    truncateAt or= max - ellipsis.length # first word > max, so we cut it\n\n    string.substring(0, truncateAt) + ellipsis\n\n  plainText: (message) ->\n    # remove all html tags from the message returning only the text\n    message.replace(/(<([^>]+)>)/ig, '');\n","\n    import I18n from 'i18nObj';\n    \n      import 'translations/lib.text_helper';\n      import 'translations/_core';\n    \n    import 'translations/_core_en';\n\n    export default I18n.scoped('lib.text_helper');\n  ","// this file was auto-generated by rake i18n:generate_js.\n// you probably shouldn't edit it directly\nimport mergeI18nTranslations from 'mergeI18nTranslations';\n\n// we use JSON.parse here instead of just loading it as a javascript object literal\n// because according to https://v8.dev/blog/cost-of-javascript-2019#json that is faster\nmergeI18nTranslations(JSON.parse(\"{\\\"ar\\\":{\\\"play_media_comment_35257210\\\":\\\"تشغيل تعليق الوسائط.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"تشغيل تعليق الوسائط بواسطة %{name} من %{createdAt}.\\\"},\\\"cy\\\":{\\\"play_media_comment_35257210\\\":\\\"Chwarae sylw ar gyfryngau.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Chwarae sylw ar gyfryngau gan %{name} o %{createdAt}.\\\"},\\\"da\\\":{\\\"play_media_comment_35257210\\\":\\\"Afspil medie kommentar.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Afspil mediekommentar af %{name} fra %{createdAt}.\\\"},\\\"da-x-k12\\\":{\\\"play_media_comment_35257210\\\":\\\"Afspil medie kommentar.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Afspil mediekommentar af %{name} fra %{createdAt}.\\\"},\\\"de\\\":{\\\"play_media_comment_35257210\\\":\\\"Medienkommentar wiedergeben\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Medienkommentar durch %{name} von %{createdAt} wiedergeben.\\\"},\\\"en-AU\\\":{\\\"play_media_comment_35257210\\\":\\\"Play media comment.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Play media comment by %{name} from %{createdAt}.\\\"},\\\"en-CA\\\":{\\\"play_media_comment_35257210\\\":\\\"Play media comment.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Play media comment by %{name} from %{createdAt}.\\\"},\\\"en-GB\\\":{\\\"play_media_comment_35257210\\\":\\\"Play media comment.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Play media comment by %{name} from %{createdAt}.\\\"},\\\"es\\\":{\\\"play_media_comment_35257210\\\":\\\"Reproducir comentario de multimedia.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Reproducir comentario de multimedia de %{name} desde %{createdAt}.\\\"},\\\"fi\\\":{\\\"play_media_comment_35257210\\\":\\\"Toista mediakommentti.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Toista mediakommenttia %{name} kohteesta %{createdAt}.\\\"},\\\"fr\\\":{\\\"play_media_comment_35257210\\\":\\\"Lancer le commentaire sur média.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Lancer le commentaire sur média par %{name} à partir de %{createdAt}.\\\"},\\\"fr-CA\\\":{\\\"play_media_comment_35257210\\\":\\\"Lire le commentaire du support\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Lire le commentaire du support par %{name} du %{createdAt}.\\\"},\\\"ht\\\":{\\\"play_media_comment_35257210\\\":\\\"Jwe kòmantè medya.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Jwe kòmantè medya pa %{name} de %{createdAt}.\\\"},\\\"is\\\":{\\\"play_media_comment_35257210\\\":\\\"Spila miðilsathugasemd.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Spila miðilsathugasemd eftir %{name} frá %{createdAt}.\\\"},\\\"it\\\":{\\\"play_media_comment_35257210\\\":\\\"Commento sulla riproduzione del contenuto multimediale.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Commento sulla riproduzione del contenuto multimediale da parte di %{name} da %{createdAt}.\\\"},\\\"ja\\\":{\\\"play_media_comment_35257210\\\":\\\"メディア コメントの再生。\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"%{name}まで%{createdAt}からのメディアのコメントを再生します。\\\"},\\\"mi\\\":{\\\"play_media_comment_35257210\\\":\\\"Mahia ngā korero pāpāho\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Mahia ngā korero pāpāho ma %{name} mai te %{createdAt}.\\\"},\\\"nb\\\":{\\\"play_media_comment_35257210\\\":\\\"Spill mediainnhold\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Spill mediainnhold av %{name} fra %{createdAt}.\\\"},\\\"nb-x-k12\\\":{\\\"play_media_comment_35257210\\\":\\\"Spill mediainnhold\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Spill mediainnhold av %{name} fra %{createdAt}.\\\"},\\\"nl\\\":{\\\"play_media_comment_35257210\\\":\\\"Media-opmerking afspelen\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Speel media-opmerking door %{name} van %{createdAt} af.\\\"},\\\"nn\\\":{\\\"play_media_comment_35257210\\\":\\\"Spel av medieinnhald.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Spel av mediekommentar frå %{name} den %{createdAt}.\\\"},\\\"pl\\\":{\\\"play_media_comment_35257210\\\":\\\"Odtwórz komentarz multimedialny.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Odtwórz komentarz multimedialny %{name} z %{createdAt}.\\\"},\\\"pt\\\":{\\\"play_media_comment_35257210\\\":\\\"Reproduzir comentário de mídia.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Reproduzir comentários de mídia %{name} de %{createdAt}.\\\"},\\\"pt-BR\\\":{\\\"play_media_comment_35257210\\\":\\\"Reproduzir comentário em mídia.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Reproduzir comentário em mídia por %{name} de %{createdAt}.\\\"},\\\"ru\\\":{\\\"play_media_comment_35257210\\\":\\\"Воспроизведение мультимедийного комментария.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Воспроизвести мультимедийный комментарии %{name} из %{createdAt}.\\\"},\\\"sl\\\":{\\\"play_media_comment_35257210\\\":\\\"Predvajaj komentar v obliki medija.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Predvajaj komentar v obliki medija %{name}, ki je bil ustvarjen ob/dne %{createdAt}.\\\"},\\\"sv\\\":{\\\"play_media_comment_35257210\\\":\\\"Spela upp mediekommentar.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Spela upp mediekommentar av %{name} från %{createdAt}.\\\"},\\\"sv-x-k12\\\":{\\\"play_media_comment_35257210\\\":\\\"Spela upp mediekommentar.\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"Spela upp mediekommentar av %{name} från %{createdAt}.\\\"},\\\"zh-Hans\\\":{\\\"play_media_comment_35257210\\\":\\\"播放媒体评论。\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"播放%{name}的来自%{createdAt}的媒体评论。\\\"},\\\"zh-Hant\\\":{\\\"play_media_comment_35257210\\\":\\\"播放媒體評論。\\\",\\\"play_media_comment_by_name_from_createdat_515b3b\\\":\\\"播放%{name}於%{createdAt}創建的媒體評論。\\\"}}\"));\n","\n    import I18n from 'i18nObj';\n    \n      import 'translations/mediaCommentThumbnail';\n      import 'translations/_core';\n    \n    import 'translations/_core_en';\n\n    export default I18n.scoped('mediaCommentThumbnail');\n  ","//\n// Copyright (C) 2011 - present Instructure, Inc.\n//\n// This file is part of Canvas.\n//\n// Canvas is free software: you can redistribute it and/or modify it under\n// the terms of the GNU Affero General Public License as published by the Free\n// Software Foundation, version 3 of the License.\n//\n// Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n// WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n// A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n// details.\n//\n// You should have received a copy of the GNU Affero General Public License along\n// with this program. If not, see <http://www.gnu.org/licenses/>.\n\nimport I18n from 'i18n!mediaCommentThumbnail'\nimport _ from 'underscore'\nimport htmlEscape from 'str/htmlEscape'\nimport $ from 'jquery'\nimport deparam from '../util/deparam'\n\nconst MEDIA_COMMENT_THUMBNAIL_SIZES = {\n  normal: {width: 140, height: 100},\n  small: {width: 70, height: 50}\n}\n\nfunction createMediaCommentThumbnail(elem, size, keepOriginalText) {\n  if (!INST.kalturaSettings) return console.log('Kaltura has not been enabled for this account')\n  let idAttr, url\n  const $link = $(elem)\n\n  try {\n    const a = document.createElement('a')\n    a.href = $link.attr('href')\n    url = a\n  } catch (error) {}\n\n  if (url && deparam(url.search).no_preview) return\n\n  const dimensions = MEDIA_COMMENT_THUMBNAIL_SIZES[size] || MEDIA_COMMENT_THUMBNAIL_SIZES.normal\n  const id =\n    $link.data('media_comment_id') ||\n    $.trim($link.find('.media_comment_id:first').text()) ||\n    ((idAttr = $link.attr('id')) && idAttr.match(/^media_comment_/) && idAttr.substring(14)) ||\n    $.trim(\n      $link\n        .parent()\n        .find('.media_comment_id:first')\n        .text()\n    )\n\n  const authorName = $link.data('author')\n  const createdAt = $link.data('created_at')\n  let altText\n\n  if (authorName && createdAt) {\n    altText = I18n.t('Play media comment by %{name} from %{createdAt}.', {\n      name: authorName,\n      createdAt\n    })\n  } else {\n    altText = I18n.t('Play media comment.')\n  }\n\n  if (id) {\n    const domain = `https://${INST.kalturaSettings.resource_domain}`\n\n    const backgroundUrl =\n      `${domain}/p/${INST.kalturaSettings.partner_id}/thumbnail/entry_id/${id}/width/` +\n      `${dimensions.width}/height/${dimensions.height}/bgcolor/000000/type/2/vid_sec/5`\n\n    const $thumbnail = $(\n      `<span\n        style='background-image: url(${htmlEscape(backgroundUrl)});'\n        class='media_comment_thumbnail media_comment_thumbnail-${htmlEscape(size)}'\n      >\n        <span class='media_comment_thumbnail_play_button'>\n          <span class='screenreader-only'>\n            ${htmlEscape(altText)}\n          </span>\n        </span>\n      </span>`\n    )\n\n    const $p = $link.closest('p')\n    if (!$p.attr('title')) {\n      $p.attr('title', htmlEscape(altText))\n    }\n\n    let $a = $link\n    if (keepOriginalText) {\n      $a = $link\n        .clone()\n        .empty()\n        .removeClass('instructure_file_link')\n      const $holder = $link.parent('.instructure_file_link_holder')\n      if ($holder.length) {\n        $a.appendTo($holder)\n      } else {\n        $link.after($a)\n      }\n    } else {\n      $link.empty()\n    }\n\n    $a.data('download', $a.attr('href'))\n      .prop('href', '#')\n      .addClass('instructure_inline_media_comment')\n      .append($thumbnail)\n      .css({backgroundImage: '', padding: 0})\n  }\n}\n\n// public API\nexport default $.fn.mediaCommentThumbnail = function(size = 'normal', keepOriginalText) {\n  return this.each(function() {\n    // defer each thumbnail generation till the next time through the event loop to not kill browser rendering,\n    // has the effect of saying \"only work on thumbnailing these while the browser is not doing something else\"\n    _.defer(createMediaCommentThumbnail, this, size, keepOriginalText)\n  })\n}\n","/*\n * Copyright (C) 2011 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery'\nimport htmlEscape from './str/htmlEscape'\nimport './jquery.instructure_misc_helpers' /* replaceTags */\n\n// Fills the selected object(s) with data values as specified.  Plaintext values should be specified in the\n//  data: data used to fill template.\n//  id: set the id attribute of the template object\n//  textValues: a list of strings, which values should be plaintext\n//  htmlValues: a list of strings, which values should be html\n//  hrefValues: List of string.  Searches for all anchor tags in the template\n//    and globally replaces \"{{ value }}\" with data[value].  Useful for adding\n//    new elements asynchronously, when you don't know what their URL will be\n//    until they're created.\n$.fn.fillTemplateData = function(options) {\n  if (this.length && options) {\n    if (options.iterator) {\n      //  todo: replace .andSelf with .addBack when JQuery is upgraded.\n      this.find('*')\n        .andSelf()\n        .each(function() {\n          const $el = $(this)\n          $.each(['name', 'id', 'class'], (i, attr) => {\n            if ($el.attr(attr)) {\n              $el.attr(attr, $el.attr(attr).replace(/-iterator-/, options.iterator))\n            }\n          })\n        })\n    }\n    if (options.id) {\n      this.attr('id', options.id)\n    }\n    let contentChange = false\n    if (options.data) {\n      for (var item in options.data) {\n        if (options.except && $.inArray(item, options.except) != -1) {\n          continue\n        }\n        if (options.data[item] && options.dataValues && $.inArray(item, options.dataValues) != -1) {\n          this.data(item, options.data[item].toString())\n        }\n        const $found_all = this.find('.' + item)\n        var avoid = options.avoid || ''\n        $found_all.each(function() {\n          const $found = $(this)\n          if ($found.length > 0 && $found.closest(avoid).length === 0) {\n            if (typeof options.data[item] === 'undefined' || options.data[item] === null) {\n              options.data[item] = ''\n            }\n            if (options.htmlValues && $.inArray(item, options.htmlValues) != -1) {\n              $found.html($.raw(options.data[item].toString()))\n              if ($found.hasClass('user_content')) {\n                contentChange = true\n                $found.removeClass('enhanced')\n                $found.data('unenhanced_content_html', options.data[item].toString())\n              }\n            } else if ($found[0].tagName.toUpperCase() == 'INPUT') {\n              $found.val(options.data[item])\n            } else {\n              try {\n                const str = options.data[item].toString()\n                $found.html(htmlEscape(str))\n              } catch (e) {}\n            }\n          }\n        })\n      }\n    }\n    if (options.hrefValues && options.data) {\n      this.find('a,span[rel]').each(function() {\n        let $obj = $(this),\n          oldHref,\n          oldRel,\n          oldName\n        for (const i in options.hrefValues) {\n          if (!options.hrefValues.hasOwnProperty(i)) {\n            continue\n          }\n          const name = options.hrefValues[i]\n          if ((oldHref = $obj.attr('href'))) {\n            const newHref = $.replaceTags(oldHref, name, encodeURIComponent(options.data[name]))\n            const orig = $obj.text() === $obj.html() ? $obj.text() : null\n            if (oldHref !== newHref) {\n              $obj.attr('href', newHref)\n              if (orig) {\n                $obj.text(orig)\n              }\n            }\n          }\n          if ((oldRel = $obj.attr('rel'))) {\n            $obj.attr('rel', $.replaceTags(oldRel, name, options.data[name]))\n          }\n          if ((oldName = $obj.attr('name'))) {\n            $obj.attr('name', $.replaceTags(oldName, name, options.data[name]))\n          }\n        }\n      })\n    }\n    if (contentChange) {\n      $(document).triggerHandler('user_content_change')\n    }\n  }\n  return this\n}\n\n$.fn.fillTemplateData.defaults = {htmlValues: null, hrefValues: null}\n\n// Reverse version of fillTemplateData.  Lets you pull out the string versions of values held in divs, spans, etc.\n// Based on the usage of class names within an object to specify an object's sub-parts.\n$.fn.getTemplateData = function(options) {\n  if (!this.length || !options) {\n    return {}\n  }\n  var result = {},\n    item,\n    val\n  if (options.textValues) {\n    const _this = this\n    options.textValues.forEach(item => {\n      const $item = _this.find('.' + item.replace(/\\[/g, '\\\\[').replace(/\\]/g, '\\\\]') + ':first')\n      val = $.trim($item.text())\n      if ($item.html() === '&nbsp;') {\n        val = ''\n      }\n      if (val.length === 1 && val.charCodeAt(0) === 160) {\n        val = ''\n      }\n      result[item] = val\n    })\n  }\n  if (options.dataValues) {\n    for (item in options.dataValues) {\n      var val = this.data(options.dataValues[item])\n      if (val) {\n        result[options.dataValues[item]] = val\n      }\n    }\n  }\n  if (options.htmlValues) {\n    for (item in options.htmlValues) {\n      const $elem = this.find(\n        '.' + options.htmlValues[item].replace(/\\[/g, '\\\\[').replace(/\\]/g, '\\\\]') + ':first'\n      )\n      val = null\n      if ($elem.hasClass('user_content') && $elem.data('unenhanced_content_html')) {\n        val = $elem.data('unenhanced_content_html')\n      } else {\n        val = $.trim($elem.html())\n      }\n      result[options.htmlValues[item]] = val\n    }\n  }\n  return result\n}\n\n$.fn.getTemplateValue = function(value, options) {\n  const opts = $.extend({}, options, {textValues: [value]})\n  return this.getTemplateData(opts)[value]\n}\n","//\n// Copyright (C) 2012 - present Instructure, Inc.\n//\n// This file is part of Canvas.\n//\n// Canvas is free software: you can redistribute it and/or modify it under\n// the terms of the GNU Affero General Public License as published by the Free\n// Software Foundation, version 3 of the License.\n//\n// Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n// WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n// A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n// details.\n//\n// You should have received a copy of the GNU Affero General Public License along\n// with this program. If not, see <http://www.gnu.org/licenses/>.\n\nimport _ from 'underscore'\n\n// turns {'foo[bar]': 1} into {foo: {bar: 1}}\nexport default function unflatten(obj) {\n  return _(obj).reduce((newObj, val, key) => {\n    let keys = key.split('][')\n    let lastKey = keys.length - 1\n\n    // If the first keys part contains [ and the last ends with ], then []\n    // are correctly balanced.\n    if (/\\[/.test(keys[0]) && /\\]$/.test(keys[lastKey])) {\n      // Remove the trailing ] from the last keys part.\n      keys[lastKey] = keys[lastKey].replace(/\\]$/, '')\n\n      // Split first keys part into two parts on the [ and add them back onto\n      // the beginning of the keys array.\n      keys = keys\n        .shift()\n        .split('[')\n        .concat(keys)\n      lastKey = keys.length - 1\n    } else {\n      // Basic 'foo' style key.\n      lastKey = 0\n    }\n\n    if (lastKey) {\n      // Complex key, build deep object structure based on a few rules:\n      // * The 'cur' pointer starts at the object top-level.\n      // * [] = array push (n is set to array length), [n] = array if n is\n      //   numeric, otherwise object.\n      // * If at the last keys part, set the value.\n      // * For each keys part, if the current level is undefined create an\n      //   object or array based on the type of the next keys part.\n      // * Move the 'cur' pointer to the next level.\n      // * Rinse & repeat.\n      let i = 0\n      let cur = newObj\n      while (i <= lastKey) {\n        key = keys[i] === '' ? cur.length : keys[i]\n\n        cur = cur[key] =\n          i < lastKey ? cur[key] || (keys[i + 1] && isNaN(keys[i + 1]) ? {} : []) : val\n        i++\n      }\n    } else {\n      // Simple key, even simpler rules, since only scalars and shallow\n      // arrays are allowed.\n\n      if (_.isArray(newObj[key])) {\n        // val is already an array, so push on the next value.\n        newObj[key].push(val)\n      } else if (newObj[key] != null) {\n        // val isn't an array, but since a second value has been specified,\n        // convert val into an array.\n        newObj[key] = [newObj[key], val]\n      } else {\n        // val is a scalar.\n        newObj[key] = val\n      }\n    }\n\n    return newObj\n  }, {})\n}\n","//\n// Copyright (C) 2012 - present Instructure, Inc.\n//\n// This file is part of Canvas.\n//\n// Canvas is free software: you can redistribute it and/or modify it under\n// the terms of the GNU Affero General Public License as published by the Free\n// Software Foundation, version 3 of the License.\n//\n// Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n// WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n// A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n// details.\n//\n// You should have received a copy of the GNU Affero General Public License along\n// with this program. If not, see <http://www.gnu.org/licenses/>.\n\n// an extraction of the deparam method from Ben Alman's jQuery BBQ\n// http://benalman.com/projects/jquery-bbq-plugin/\n\nimport unflatten from '../object/unflatten'\n\nconst coerceTypes = {\n  true: true,\n  false: false,\n  null: null\n}\n\nexport default function deparam(params, coerce) {\n  // shortcut for just deparam'ing the current querystring\n  if (!params || typeof params === 'boolean') {\n    const currentQueryString = window.location.search\n    if (!currentQueryString) return {}\n    return deparam(currentQueryString, ...arguments)\n  }\n\n  const obj = {}\n  params\n    .replace(/\\+/g, ' ')\n    .split('&')\n    .forEach(param => {\n      let [key, val] = param.split('=')\n      key = decodeURIComponent(key)\n      val = decodeURIComponent(val)\n\n      // coerce values.\n      if (coerce) {\n        val =\n          val && !isNaN(val)\n            ? +val // number\n            : val === 'undefined'\n            ? undefined // undefined\n            : coerceTypes[val] !== undefined\n            ? coerceTypes[val] // true, false, null\n            : val // string\n      }\n\n      obj[key] = val\n    })\n\n  return unflatten(obj)\n}\n"],"sourceRoot":""}