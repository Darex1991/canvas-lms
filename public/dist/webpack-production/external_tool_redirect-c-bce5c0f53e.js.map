{"version":3,"sources":["webpack:///./app/coffeescripts/external_tools/RedirectReturnContainer.js","webpack:///./app/jsx/bundles/external_tool_redirect.js"],"names":["RedirectReturnContainer","_contentReady","event","data","return_type","this","createMigration","url","redirectToSuccessUrl","_contentCancel","location","href","cancelUrl","successUrl","file_url","migration_type","settings","migrationUrl","ENV","course_id","$","ajaxJSON","handleError","attachLtiEvents","window","on","flashError","message","prototype","redirect_return_success_url","redirect_return_cancel_url","document","ready","external_tool_redirect"],"mappings":";;;AAmBe,MAAMA,EAAwB,mBAM3CC,cAAgB,CAACC,EAAOC,IAClBA,GAA6B,SAArBA,EAAKC,YACRC,KAAKC,gBAAgBH,EAAKI,KAE1BF,KAAKG,uBAV2B,KAc3CC,eAAiB,CAACP,EAAOC,KACvBO,SAASC,KAAON,KAAKO,WAfoB,KAkB3CJ,qBAAuB,KACrBE,SAASC,KAAON,KAAKQ,YAnBoB,KAsB3CP,gBAAkBQ,IAChB,MAAMX,EAAO,CACXY,eAAgB,4BAChBC,SAAU,CACRF,aAIEG,EAAe,mBAAH,OAAsBC,IAAIC,UAA1B;AAClB,OAAOC,IAAEC,SAASJ,EAAc,OAAQd,EAAME,KAAKG,qBAAsBH,KAAKiB,cA9BhFC,kBACEH,IAAEI,QAAQC,GAAG,uBAAwBpB,KAAKJ,eAC1CmB,IAAEI,QAAQC,GAAG,wBAAyBpB,KAAKI,gBA+B7Ca,YAAYnB,GACV,OAAOiB,IAAEM,WAAWvB,EAAKwB,UAG7B3B,EAAwB4B,UAAUf,WAAaK,IAAIW,4BACnD7B,EAAwB4B,UAAUhB,UAAYM,IAAIY,2BCrClDV,IAAEW,UAAUC,MAAM,KAChBR,OAAOS,uBAAyB,CAACD,YACf,IAAIhC,GACZuB","file":"external_tool_redirect-c-bce5c0f53e.js","sourcesContent":["//\n// Copyright (C) 2014 - present Instructure, Inc.\n//\n// This file is part of Canvas.\n//\n// Canvas is free software: you can redistribute it and/or modify it under\n// the terms of the GNU Affero General Public License as published by the Free\n// Software Foundation, version 3 of the License.\n//\n// Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n// WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n// A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n// details.\n//\n// You should have received a copy of the GNU Affero General Public License along\n// with this program. If not, see <http://www.gnu.org/licenses/>.\n\nimport $ from 'jquery'\n\nexport default class RedirectReturnContainer {\n  attachLtiEvents() {\n    $(window).on('externalContentReady', this._contentReady)\n    $(window).on('externalContentCancel', this._contentCancel)\n  }\n\n  _contentReady = (event, data) => {\n    if (data && data.return_type === 'file') {\n      return this.createMigration(data.url)\n    } else {\n      return this.redirectToSuccessUrl()\n    }\n  }\n\n  _contentCancel = (event, data) => {\n    location.href = this.cancelUrl\n  }\n\n  redirectToSuccessUrl = () => {\n    location.href = this.successUrl\n  }\n\n  createMigration = file_url => {\n    const data = {\n      migration_type: 'canvas_cartridge_importer',\n      settings: {\n        file_url\n      }\n    }\n\n    const migrationUrl = `/api/v1/courses/${ENV.course_id}/content_migrations`\n    return $.ajaxJSON(migrationUrl, 'POST', data, this.redirectToSuccessUrl, this.handleError)\n  }\n\n  handleError(data) {\n    return $.flashError(data.message)\n  }\n}\nRedirectReturnContainer.prototype.successUrl = ENV.redirect_return_success_url\nRedirectReturnContainer.prototype.cancelUrl = ENV.redirect_return_cancel_url\n","/*\n * Copyright (C) 2014 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery'\nimport RedirectReturnContainer from 'compiled/external_tools/RedirectReturnContainer'\n\n$(document).ready(() => {\n  window.external_tool_redirect = {ready() {}}\n  const container = new RedirectReturnContainer()\n  container.attachLtiEvents()\n})\n"],"sourceRoot":""}